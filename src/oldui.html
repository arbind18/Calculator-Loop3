<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Calculator Loop - 300+ Free Online Calculators | EMI, SIP, BMI, GST, Age & Tax Calculator</title>
    
    <!-- Performance Optimization -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    <meta name="description" content="Free online calculator tools for 2025! Calculate EMI, SIP returns, BMI, GST, income tax, loan payments, retirement planning & 300+ more. Fast, accurate & mobile-friendly calculators. No signup required.">
    <meta name="keywords" content="online calculator, free calculator 2025, EMI calculator India, SIP calculator, GST calculator India, BMI calculator, age calculator, percentage calculator, loan calculator, home loan EMI, investment calculator, income tax calculator 2025, mortgage calculator, compound interest calculator, calorie calculator, retirement calculator, unit converter, math calculator, financial calculator, health calculator, date calculator, scientific calculator online, salary calculator">
    <meta name="author" content="Calculator Loop">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    <meta name="bingbot" content="index, follow">
    <link rel="canonical" href="https://calculatorloop.com/">
    <link rel="alternate" href="https://calculatorloop.com/" hreflang="en">
    <link rel="alternate" href="https://calculatorloop.com/hi/" hreflang="hi">
    <link rel="sitemap" type="application/xml" href="https://calculatorloop.com/sitemap.xml">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    <meta name="rating" content="General">
    <meta name="distribution" content="Global">
    <meta name="coverage" content="Worldwide">
    <meta name="target_country" content="IN">
    <meta name="target_country" content="US">
    <meta name="target_country" content="GB">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="format-detection" content="telephone=no">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Calculator Loop">
    <meta property="og:title" content="Calculator Loop - 300+ Free Online Calculators | EMI, SIP, BMI, Tax Calculator">
    <meta property="og:description" content="Free online calculators for 2025! Calculate EMI, SIP returns, BMI, GST, income tax & more. Fast, accurate & mobile-friendly. 300+ calculator tools for financial planning, health metrics & math calculations.">
    <meta property="og:url" content="https://calculatorloop.com/">
    <meta property="og:locale" content="en_US">
    <meta property="og:updated_time" content="2025-11-11T00:00:00+00:00">
    <meta property="og:image" content="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1200' height='630' viewBox='0 0 1200 630'%3E%3Cdefs%3E%3ClinearGradient id='grad1' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%230A0E27;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%231A1F3A;stop-opacity:1' /%3E%3C/linearGradient%3E%3ClinearGradient id='grad2' x1='0%25' y1='0%25' x2='100%25' y2='0%25'%3E%3Cstop offset='0%25' style='stop-color:%2300D4FF;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%238B5CF6;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='1200' height='630' fill='url(%23grad1)'/%3E%3Ccircle cx='900' cy='150' r='200' fill='%238B5CF6' opacity='0.1'/%3E%3Ccircle cx='300' cy='500' r='150' fill='%2300D4FF' opacity='0.1'/%3E%3Ctext x='600' y='250' font-family='Arial,sans-serif' font-size='72' font-weight='bold' text-anchor='middle' fill='url(%23grad2)'%3ECalculator Loop%3C/text%3E%3Ctext x='600' y='320' font-family='Arial,sans-serif' font-size='32' text-anchor='middle' fill='%2394A3B8'%3E300+ Free Online Calculators%3C/text%3E%3Ctext x='600' y='400' font-family='Arial,sans-serif' font-size='24' text-anchor='middle' fill='%2364748B'%3EFinancial â€¢ Health â€¢ Math â€¢ Date & Time%3C/text%3E%3Crect x='420' y='450' width='360' height='80' rx='12' fill='url(%23grad2)'/%3E%3Ctext x='600' y='500' font-family='Arial,sans-serif' font-size='28' font-weight='bold' text-anchor='middle' fill='white'%3EExplore Now%3C/text%3E%3C/svg%3E">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Calculator Loop - 300+ Free Online Calculators for Financial, Health, Math, and more">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@calculatorloop">
    <meta name="twitter:title" content="Calculator Loop - 300+ Free Online Calculators | EMI, SIP, BMI, Tax">
    <meta name="twitter:description" content="Free online calculators for 2025! Calculate EMI, SIP returns, BMI, GST, income tax & more. Fast, accurate & mobile-friendly. 300+ tools available.">
    <meta name="twitter:image" content="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1200' height='675' viewBox='0 0 1200 675'%3E%3Cdefs%3E%3ClinearGradient id='tgrad1' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%230A0E27;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%231A1F3A;stop-opacity:1' /%3E%3C/linearGradient%3E%3ClinearGradient id='tgrad2' x1='0%25' y1='0%25' x2='100%25' y2='0%25'%3E%3Cstop offset='0%25' style='stop-color:%2300D4FF;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%238B5CF6;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='1200' height='675' fill='url(%23tgrad1)'/%3E%3Ccircle cx='950' cy='180' r='220' fill='%238B5CF6' opacity='0.12'/%3E%3Ccircle cx='250' cy='520' r='170' fill='%2300D4FF' opacity='0.12'/%3E%3Cg transform='translate(150,120)'%3E%3Crect width='120' height='120' rx='20' fill='%2300D4FF' opacity='0.2'/%3E%3Ctext x='60' y='75' font-family='Arial,sans-serif' font-size='48' font-weight='bold' text-anchor='middle' fill='%2300D4FF'%3EðŸ§®%3C/text%3E%3C/g%3E%3Cg transform='translate(930,380)'%3E%3Crect width='100' height='100' rx='16' fill='%238B5CF6' opacity='0.2'/%3E%3Ctext x='50' y='65' font-family='Arial,sans-serif' font-size='40' font-weight='bold' text-anchor='middle' fill='%238B5CF6'%3EðŸ’°%3C/text%3E%3C/g%3E%3Ctext x='600' y='280' font-family='Arial,sans-serif' font-size='80' font-weight='bold' text-anchor='middle' fill='url(%23tgrad2)'%3ECalculator Loop%3C/text%3E%3Ctext x='600' y='360' font-family='Arial,sans-serif' font-size='36' text-anchor='middle' fill='%2394A3B8'%3EYour All-in-One Calculator Suite%3C/text%3E%3Ctext x='600' y='440' font-family='Arial,sans-serif' font-size='28' text-anchor='middle' fill='%2364748B'%3Eâœ“ Financial Planning  âœ“ Health Metrics  âœ“ Math Tools%3C/text%3E%3Crect x='430' y='490' width='340' height='75' rx='12' fill='url(%23tgrad2)'/%3E%3Ctext x='600' y='540' font-family='Arial,sans-serif' font-size='26' font-weight='bold' text-anchor='middle' fill='white'%3EStart Calculating%3C/text%3E%3C/svg%3E">
    <meta name="twitter:image:alt" content="Calculator Loop - 300+ Free Online Calculators for EMI, SIP, BMI, Tax & More">
    <meta name="twitter:creator" content="@calculatorloop">
    <meta name="twitter:label1" content="Tools Available">
    <meta name="twitter:data1" content="300+ Calculators">
    <meta name="twitter:label2" content="Price">
    <meta name="twitter:data2" content="Free">
    
    <!-- Favicon & App Icons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='fgrad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%2300D4FF' /%3E%3Cstop offset='100%25' style='stop-color:%238B5CF6' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='100' height='100' rx='20' fill='url(%23fgrad)'/%3E%3Ctext x='50' y='70' font-family='Arial,sans-serif' font-size='60' font-weight='bold' text-anchor='middle' fill='white'%3EC%3C/text%3E%3C/svg%3E">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'%3E%3Cdefs%3E%3ClinearGradient id='agrad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%2300D4FF' /%3E%3Cstop offset='100%25' style='stop-color:%238B5CF6' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='180' height='180' rx='40' fill='url(%23agrad)'/%3E%3Ctext x='90' y='125' font-family='Arial,sans-serif' font-size='100' font-weight='bold' text-anchor='middle' fill='white'%3EC%3C/text%3E%3C/svg%3E">
    
    <!-- Additional Social Meta Tags -->
    <meta property="article:author" content="Calculator Loop">
    <meta property="article:publisher" content="https://facebook.com/calculatorloop">
    <meta property="article:published_time" content="2024-01-01T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-11-11T00:00:00+00:00">
    <meta name="theme-color" content="#00D4FF">
    <meta name="msapplication-TileColor" content="#00D4FF">
    <meta name="msapplication-TileImage" content="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 144 144'%3E%3Cdefs%3E%3ClinearGradient id='mgrad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%2300D4FF' /%3E%3Cstop offset='100%25' style='stop-color:%238B5CF6' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='144' height='144' fill='url(%23mgrad)'/%3E%3Ctext x='72' y='100' font-family='Arial,sans-serif' font-size='80' font-weight='bold' text-anchor='middle' fill='white'%3EC%3C/text%3E%3C/svg%3E">
    
    <!-- Geo Tags for Local SEO -->
    <meta name="geo.region" content="IN">
    <meta name="geo.placename" content="India">
    <meta name="target" content="all">
    
    <!-- Additional SEO Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Calculator Loop">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Calculator Loop">
    
    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    
    <!-- Schema.org markup for Google -->
    
    <!-- WebSite Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Calculator Loop",
      "alternateName": "Calculator Loop - All-in-One Calculator Suite",
      "url": "https://calculatorloop.com/",
      "description": "300+ Free Online Calculator Tools for Financial Planning, Health Metrics, Math Calculations, and More",
      "inLanguage": "en-US",
      "potentialAction": {
        "@type": "SearchAction",
        "target": {
          "@type": "EntryPoint",
          "urlTemplate": "https://calculatorloop.com/?q={search_term_string}"
        },
        "query-input": "required name=search_term_string"
      }
    }
    </script>
    
    <!-- WebApplication Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Calculator Loop",
      "applicationCategory": "UtilitiesApplication",
      "operatingSystem": "All",
      "browserRequirements": "Requires JavaScript. Modern browser recommended.",
      "url": "https://calculatorloop.com/",
      "description": "Comprehensive online calculator suite with 300+ calculators for financial planning, health metrics, mathematical operations, date-time calculations, and more.",
      "datePublished": "2024-01-01",
      "dateModified": "2025-11-11",
      "author": {
        "@type": "Organization",
        "name": "Calculator Loop"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Calculator Loop",
        "logo": {
          "@type": "ImageObject",
          "url": "https://calculatorloop.com/logo.png"
        }
      },
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD",
        "availability": "https://schema.org/InStock"
      },
      "featureList": [
        "EMI Calculator",
        "SIP Calculator",
        "BMI Calculator",
        "Age Calculator",
        "Percentage Calculator",
        "Loan Calculator",
        "Investment Calculator",
        "Tax Calculator",
        "GST Calculator",
        "Retirement Calculator",
        "Mortgage Calculator",
        "Compound Interest Calculator",
        "Simple Interest Calculator",
        "Calorie Calculator",
        "GPA Calculator",
        "Tip Calculator",
        "Currency Converter",
        "Unit Converter",
        "Discount Calculator",
        "Date Difference Calculator",
        "Body Fat Calculator",
        "Ideal Weight Calculator",
        "Scientific Calculator",
        "Area Calculator",
        "Volume Calculator",
        "Distance Calculator",
        "Password Generator"
      ],
      "softwareVersion": "1.0",
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.8",
        "ratingCount": "2547",
        "bestRating": "5",
        "worstRating": "1"
      }
    }
    </script>
    
    <!-- Organization Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Calculator Loop",
      "url": "https://calculatorloop.com/",
      "logo": "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='fgrad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%2300D4FF' /%3E%3Cstop offset='100%25' style='stop-color:%238B5CF6' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='100' height='100' rx='20' fill='url(%23fgrad)'/%3E%3Ctext x='50' y='70' font-family='Arial,sans-serif' font-size='60' font-weight='bold' text-anchor='middle' fill='white'%3EC%3C/text%3E%3C/svg%3E",
      "description": "Calculator Loop provides 300+ free online calculators for everyone. From financial planning to health metrics, we make complex calculations simple.",
      "sameAs": [
        "https://twitter.com/calculatorloop",
        "https://facebook.com/calculatorloop",
        "https://linkedin.com/company/calculatorloop"
      ],
      "contactPoint": {
        "@type": "ContactPoint",
        "contactType": "Customer Support",
        "availableLanguage": "English"
      }
    }
    </script>
    
    <!-- BreadcrumbList Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://calculatorloop.com/"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Calculators",
          "item": "https://calculatorloop.com/#calculators"
        }
      ]
    }
    </script>
    
    <!-- ItemList Schema for Calculator Categories -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "ItemList",
      "name": "Calculator Categories",
      "description": "Browse calculators by category",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Financial Calculators",
          "description": "EMI, SIP, Loan, Investment, Tax, GST, Mortgage calculators"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Health & Fitness Calculators",
          "description": "BMI, Calorie, BMR, Body Fat, Ideal Weight calculators"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "Math Calculators",
          "description": "Percentage, Interest, Scientific, Area, Volume calculators"
        },
        {
          "@type": "ListItem",
          "position": 4,
          "name": "Date & Time Calculators",
          "description": "Age, Date Difference, Time Zone calculators"
        },
        {
          "@type": "ListItem",
          "position": 5,
          "name": "Construction Calculators",
          "description": "Concrete, Material, Area estimation calculators"
        },
        {
          "@type": "ListItem",
          "position": 6,
          "name": "Physics Calculators",
          "description": "Force, Energy, Speed, Distance calculators"
        },
        {
          "@type": "ListItem",
          "position": 7,
          "name": "Everyday Calculators",
          "description": "Tip, Discount, Unit Converter, Currency Converter"
        },
        {
          "@type": "ListItem",
          "position": 8,
          "name": "Education Calculators",
          "description": "GPA, Grade, CGPA calculators"
        },
        {
          "@type": "ListItem",
          "position": 9,
          "name": "Technology Calculators",
          "description": "Password Generator, Data Size, Network calculators"
        },
        {
          "@type": "ListItem",
          "position": 10,
          "name": "Scientific Calculators",
          "description": "Advanced scientific and engineering calculators"
        }
      ]
    }
    </script>
    
    <!-- FAQPage Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What calculators are available on Calculator Loop?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Calculator Loop offers 300+ free online calculators including EMI, SIP, GST, BMI, Age, Percentage, Loan, Investment, Tax, Mortgage, Compound Interest, Simple Interest, Calorie, Retirement, Unit Converter, and many more calculators across 10 different categories."
          }
        },
        {
          "@type": "Question",
          "name": "Are the calculators free to use?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, all calculators on Calculator Loop are completely free to use. No registration, subscription, or payment required. Just open the calculator you need and start calculating instantly."
          }
        },
        {
          "@type": "Question",
          "name": "Do I need to create an account?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "No account is required to use any of our calculators. However, you can optionally log in to save your calculation history and preferences for a personalized experience."
          }
        },
        {
          "@type": "Question",
          "name": "Are the calculation results accurate?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, all our calculators use industry-standard formulas and are thoroughly tested for accuracy. We regularly update our calculators to ensure they provide reliable results for financial planning, health metrics, and other calculations."
          }
        },
        {
          "@type": "Question",
          "name": "Can I use Calculator Loop on mobile devices?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Absolutely! Calculator Loop is fully responsive and optimized for mobile devices, tablets, and desktops. You can access all calculators on any device with a modern web browser."
          }
        },
        {
          "@type": "Question",
          "name": "How do I find a specific calculator?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "You can use the search bar at the top of the page to quickly find any calculator. You can also browse calculators by category using the category tabs or navigation menu."
          }
        }
      ]
    }
    </script>
    
    <!-- HowTo Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "HowTo",
      "name": "How to Use Calculator Loop",
      "description": "Learn how to use Calculator Loop to perform quick and accurate calculations",
      "step": [
        {
          "@type": "HowToStep",
          "position": 1,
          "name": "Select a Calculator",
          "text": "Browse through 300+ calculators by category or use the search bar to find the calculator you need."
        },
        {
          "@type": "HowToStep",
          "position": 2,
          "name": "Enter Your Values",
          "text": "Input the required values and parameters into the calculator fields."
        },
        {
          "@type": "HowToStep",
          "position": 3,
          "name": "Get Instant Results",
          "text": "Click calculate to get instant, accurate results. No waiting, no sign-up required."
        },
        {
          "@type": "HowToStep",
          "position": 4,
          "name": "Save or Share",
          "text": "Optionally save your calculation history or share results with others."
        }
      ]
    }
    </script>
    
    <!-- SoftwareApplication Schema for SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Calculator Loop",
      "applicationCategory": "BusinessApplication",
      "applicationSubCategory": "Calculator",
      "operatingSystem": "Web Browser, Android, iOS, Windows, MacOS",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.8",
        "ratingCount": "2547",
        "bestRating": "5",
        "worstRating": "1"
      },
      "screenshot": "https://calculatorloop.com/screenshot.png",
      "softwareVersion": "2.0",
      "releaseNotes": "Enhanced UI, 300+ calculators, mobile optimization, dark mode support",
      "keywords": "calculator, EMI calculator, SIP calculator, BMI calculator, tax calculator, loan calculator"
    }
    </script>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/json;charset=utf-8,%7B%22name%22%3A%22Calculator%20Loop%22%2C%22short_name%22%3A%22CalcLoop%22%2C%22description%22%3A%22300%2B%20Free%20Online%20Calculators%22%2C%22start_url%22%3A%22%2F%22%2C%22display%22%3A%22standalone%22%2C%22background_color%22%3A%22%230A0E27%22%2C%22theme_color%22%3A%22%2300D4FF%22%2C%22orientation%22%3A%22portrait-primary%22%2C%22icons%22%3A%5B%7B%22src%22%3A%22data%3Aimage%2Fsvg%2Bxml%2C%253Csvg%2520xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%2520viewBox%3D%270%25200%2520192%2520192%27%253E%253Cdefs%253E%253ClinearGradient%2520id%3D%27g1%27%2520x1%3D%270%2525%27%2520y1%3D%270%2525%27%2520x2%3D%27100%2525%27%2520y2%3D%27100%2525%27%253E%253Cstop%2520offset%3D%270%2525%27%2520style%3D%27stop-color%3A%252300D4FF%27%2520%2F%253E%253Cstop%2520offset%3D%27100%2525%27%2520style%3D%27stop-color%3A%25238B5CF6%27%2520%2F%253E%253C%2FlinearGradient%253E%253C%2Fdefs%253E%253Crect%2520width%3D%27192%27%2520height%3D%27192%27%2520rx%3D%2742%27%2520fill%3D%27url(%2523g1)%27%2F%253E%253Ctext%2520x%3D%2796%27%2520y%3D%27135%27%2520font-family%3D%27Arial%2Csans-serif%27%2520font-size%3D%27120%27%2520font-weight%3D%27bold%27%2520text-anchor%3D%27middle%27%2520fill%3D%27white%27%253EC%253C%2Ftext%253E%253C%2Fsvg%253E%22%2C%22sizes%22%3A%22192x192%22%2C%22type%22%3A%22image%2Fsvg%2Bxml%22%2C%22purpose%22%3A%22any%20maskable%22%7D%2C%7B%22src%22%3A%22data%3Aimage%2Fsvg%2Bxml%2C%253Csvg%2520xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%2520viewBox%3D%270%25200%2520512%2520512%27%253E%253Cdefs%253E%253ClinearGradient%2520id%3D%27g2%27%2520x1%3D%270%2525%27%2520y1%3D%270%2525%27%2520x2%3D%27100%2525%27%2520y2%3D%27100%2525%27%253E%253Cstop%2520offset%3D%270%2525%27%2520style%3D%27stop-color%3A%252300D4FF%27%2520%2F%253E%253Cstop%2520offset%3D%27100%2525%27%2520style%3D%27stop-color%3A%25238B5CF6%27%2520%2F%253E%253C%2FlinearGradient%253E%253C%2Fdefs%253E%253Crect%2520width%3D%27512%27%2520height%3D%27512%27%2520rx%3D%27112%27%2520fill%3D%27url(%2523g2)%27%2F%253E%253Ctext%2520x%3D%27256%27%2520y%3D%27360%27%2520font-family%3D%27Arial%2Csans-serif%27%2520font-size%3D%27320%27%2520font-weight%3D%27bold%27%2520text-anchor%3D%27middle%27%2520fill%3D%27white%27%253EC%253C%2Ftext%253E%253C%2Fsvg%253E%22%2C%22sizes%22%3A%22512x512%22%2C%22type%22%3A%22image%2Fsvg%2Bxml%22%2C%22purpose%22%3A%22any%20maskable%22%7D%5D%2C%22categories%22%3A%5B%22utilities%22%2C%22finance%22%2C%22health%22%5D%7D">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@400;500;600&family=Manrope:wght@700;800&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    
    <!-- Icons - Async Load -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" media="print" onload="this.media='all'">
    
    <!-- Styles -->
    <style>
  /* Calculator Loop - Modern Calculator UI Styles */
  
        /* Performance Optimizations */
        * {
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
          text-rendering: optimizeLegibility;
        }
        
        html {
          scroll-behavior: smooth;
        }
        
        body {
          overflow-x: hidden;
        }
        
        img, video {
          content-visibility: auto;
        }
        
        .tool-card, .popular-card, .category-card {
          content-visibility: auto;
          contain-intrinsic-size: 0 300px;
        }
        
        /* Hardware acceleration for smooth animations */
        .tool-card, .popular-card, .category-card, .nav-link, button {
          -webkit-transform: translateZ(0);
          transform: translateZ(0);
          -webkit-backface-visibility: hidden;
          backface-visibility: hidden;
          -webkit-perspective: 1000;
          perspective: 1000;
        }

        /* CSS Custom Properties */
        :root {
          /* Colors - Light Mode */
          --bg-primary: #FFFFFF;
          --bg-secondary: #F8FAFC;
          --bg-tertiary: #F1F5F9;
          --text-primary: #1A1F3A;
          --text-secondary: #64748B;
          --text-muted: #94A3B8;
          
          /* Accent Colors */
          --accent-blue: #00D4FF;
          --accent-purple: #8B5CF6;
          --accent-green: #00FF88;
          --accent-pink: #FF006E;
          --accent-cyan: #22D3EE;
          
          /* Gradients */
          --gradient-ai: linear-gradient(135deg, #00D4FF 0%, #8B5CF6 100%);
          --gradient-neon: linear-gradient(135deg, #00FF88 0%, #22D3EE 100%);
          --gradient-dark: linear-gradient(135deg, #0A0E27 0%, #1A1F3A 100%);
          
          /* Shadows */
          --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.05);
          --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.1);
          --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.15);
          --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.2);
          
          /* Glassmorphism */
          --glass-bg: rgba(255, 255, 255, 0.1);
          --glass-border: rgba(255, 255, 255, 0.2);
          --glass-blur: blur(20px);
          
          /* Spacing */
          --space-xs: 4px;
          --space-sm: 8px;
          --space-md: 16px;
          --space-lg: 24px;
          --space-xl: 32px;
          --space-2xl: 48px;
          --space-3xl: 64px;
          
          /* Typography */
          --font-primary: 'Poppins', sans-serif;
          --font-secondary: 'Inter', sans-serif;
          --font-accent: 'Manrope', sans-serif;
          
          /* Transitions */
          --transition-fast: 200ms ease-in-out;
          --transition-normal: 300ms ease-in-out;
          --transition-slow: 500ms ease-in-out;
          --transition-theme: 0ms; /* Instant theme change - no delay */
        }

        /* Dark Mode */
        [data-theme="dark"] {
          --bg-primary: #0A0E27;
          --bg-secondary: #1A1F3A;
          --bg-tertiary: #252B4A;
          --text-primary: #FFFFFF;
          --text-secondary: #94A3B8;
          --text-muted: #64748B;
          
          --glass-bg: rgba(0, 0, 0, 0.2);
          --glass-border: rgba(255, 255, 255, 0.1);
        }

        /* Reset and Base Styles */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
          font-family: var(--font-primary);
          background: var(--bg-primary);
          color: var(--text-primary);
          line-height: 1.6;
          transition: background-color var(--transition-theme), color var(--transition-theme);
          overflow-x: hidden;
        }

        /* Utility Classes */
        .gradient-text { background: var(--gradient-ai); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .glass-effect { background: var(--glass-bg); backdrop-filter: var(--glass-blur); border: 1px solid var(--glass-border); }

        /* Navigation */
        .navbar { position: fixed; top: 0; left: 0; right: 0; z-index: 1000; padding: var(--space-md) 0; background: var(--glass-bg); backdrop-filter: var(--glass-blur); border-bottom: 1px solid var(--glass-border); transition: background var(--transition-theme), border-color var(--transition-theme); }
        .nav-container { max-width: 100%; margin: 0 auto; padding: 0 var(--space-xl); display: flex; align-items: center; justify-content: space-between; gap: var(--space-lg); }
        .nav-logo { display: flex; flex-direction: column; align-items: flex-start; }
        .logo-text { font-family: var(--font-accent); font-size: 2rem; font-weight: 800; background: var(--gradient-ai); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin: 0; }
        .logo-tagline { font-family: var(--font-secondary); font-size: 0.75rem; color: var(--text-secondary); margin-top: -4px; }
        .nav-menu { display: flex; gap: var(--space-xl); }
        .nav-search { flex: 0 1 400px; max-width: 400px; }
        .nav-link { font-family: var(--font-secondary); font-weight: 500; color: var(--text-secondary); text-decoration: none; padding: var(--space-sm) var(--space-md); border-radius: 8px; transition: all var(--transition-fast); position: relative; }
        .nav-link:hover, .nav-link.active { color: var(--accent-blue); background: var(--glass-bg); }
        .nav-controls { display: flex; align-items: center; gap: var(--space-md); flex-shrink: 0; }
        .mobile-search-toggle {
            display: none;
            width: 44px;
            height: 44px;
            border: none;
            border-radius: 12px;
            background: var(--glass-bg);
            color: var(--text-secondary);
            cursor: pointer;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
            backdrop-filter: var(--glass-blur);
            border: 1px solid var(--glass-border);
            flex-shrink: 0;
        }
        .mobile-search-toggle:hover {
            color: var(--accent-blue);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        .theme-toggle { width: 44px; height: 44px; border: none; border-radius: 12px; background: var(--glass-bg); color: var(--text-secondary); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all var(--transition-fast); backdrop-filter: var(--glass-blur); border: 1px solid var(--glass-border); flex-shrink: 0; }
        .theme-toggle:hover { color: var(--accent-blue); transform: translateY(-2px); box-shadow: var(--shadow-md); }
    .login-btn { background: linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)); border: 1px solid var(--glass-border); color: var(--text-primary); padding: 10px 16px; min-height: 44px; border-radius: 10px; font-family: var(--font-secondary); font-weight: 700; cursor: pointer; transition: all var(--transition-fast); display: inline-flex; align-items: center; gap: 8px; white-space: nowrap; flex-shrink: 0; }
    .login-btn:hover { transform: translateY(-2px); color: var(--accent-blue); box-shadow: var(--shadow-sm); }
        .mobile-menu-toggle { display: none; flex-direction: column; gap: 5px; background: none; border: none; cursor: pointer; padding: 10px; min-width: 44px; min-height: 44px; flex-shrink: 0; align-items: center; justify-content: center; }
        .mobile-menu-toggle span { width: 26px; height: 3px; background: var(--text-primary); transition: all var(--transition-fast); border-radius: 2px; }

        /* Navigation: Categories dropdown */
        .nav-categories { position: relative; display: flex; align-items: center; }
        .nav-categories-btn { background: var(--glass-bg); border: 1px solid var(--glass-border); color: var(--text-secondary); padding: 8px 12px; border-radius: 8px; cursor: pointer; font-family: var(--font-secondary); font-weight: 600; display: inline-flex; align-items: center; gap: 8px; transition: all var(--transition-fast); }
        .nav-categories-btn:hover { transform: translateY(-2px); color: var(--accent-blue); }
        .category-badge { background: var(--accent-pink); color: white; font-size: 0.75rem; padding: 2px 8px; border-radius: 999px; margin-left: 6px; font-weight: 700; }
        .nav-category-dropdown { position: absolute; top: calc(100% + 8px); left: 0; min-width: 260px; max-height: 450px; overflow-y: auto; background: var(--bg-primary); border: 1px solid var(--glass-border); border-radius: 12px; box-shadow: var(--shadow-lg); padding: 8px; display: none; flex-direction: column; gap: 6px; z-index: 1100; }
        .nav-category-dropdown.open { display: flex; }
        .nav-category-dropdown::-webkit-scrollbar { width: 6px; }
        .nav-category-dropdown::-webkit-scrollbar-track { background: var(--bg-secondary); border-radius: 3px; }
        .nav-category-dropdown::-webkit-scrollbar-thumb { background: var(--glass-border); border-radius: 3px; }
        .nav-category-dropdown::-webkit-scrollbar-thumb:hover { background: var(--accent-blue); }
        .nav-category-dropdown .dropdown-item { display: flex; align-items: center; gap: 10px; padding: 8px 10px; color: var(--text-primary); text-decoration: none; border-radius: 8px; transition: background-color var(--transition-fast), transform var(--transition-fast); }
        .nav-category-dropdown .dropdown-item:hover { background: var(--glass-bg); transform: translateX(4px); color: var(--accent-blue); }
        .nav-category-dropdown .dropdown-item i { color: var(--accent-blue); width: 20px; text-align: center; }

        /* Floating Search */
        .floating-search { position: fixed; top: 120px; left: 50%; transform: translateX(-50%); z-index: 999; width: 100%; max-width: 600px; padding: 0 var(--space-lg); display: none; }
        .search-container { position: relative; background: var(--glass-bg); backdrop-filter: var(--glass-blur); border: 1px solid var(--glass-border); border-radius: 12px; padding: var(--space-sm) var(--space-md); display: flex; align-items: center; gap: var(--space-sm); box-shadow: var(--shadow-sm); transition: transform var(--transition-normal), box-shadow var(--transition-normal), border-color var(--transition-normal), background var(--transition-theme); }
        .search-container:focus-within { box-shadow: var(--shadow-md); border-color: var(--accent-blue); }
        .search-icon { color: var(--text-secondary); font-size: 1rem; }
        .search-input { flex: 1; border: none; background: none; font-family: var(--font-secondary); font-size: 0.9rem; color: var(--text-primary); outline: none; }
        .search-input::placeholder { color: var(--text-muted); }
        .search-action {
            background: var(--gradient-ai);
            border: none;
            color: white;
            cursor: pointer;
            padding: 10px 16px;
            min-height: 44px;
            min-width: 44px;
            border-radius: 8px;
            transition: all var(--transition-fast);
            margin-right: var(--space-sm);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .search-action:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }
        .search-clear { 
            background: none; 
            border: none; 
            color: var(--text-secondary); 
            cursor: pointer; 
            padding: 10px; 
            min-width: 44px;
            min-height: 44px;
            border-radius: 8px; 
            transition: all var(--transition-fast); 
            opacity: 0; 
            visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .search-clear.visible { opacity: 1; visibility: visible; }
        .search-clear:hover { color: var(--accent-pink); background: var(--glass-bg); }
        .search-suggestions { position: absolute; top: 100%; left: 0; right: 0; background: var(--bg-primary); border: 1px solid var(--glass-border); border-radius: 12px; margin-top: var(--space-sm); max-height: 300px; overflow-y: auto; box-shadow: var(--shadow-lg); opacity: 0; visibility: hidden; transform: translateY(-10px); transition: all var(--transition-fast); }
        .search-suggestions.visible { opacity: 1; visibility: visible; transform: translateY(0); }

        /* Main Content & Sections */
        .main-content { margin-top: 100px; }
        .hero { padding: var(--space-3xl) 0; background: radial-gradient(ellipse at center, rgba(0, 212, 255, 0.1) 0%, transparent 70%); position: relative; overflow: hidden; }
        .hero::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(139,92,246,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>'); opacity: 0.5; }
        .hero-container { max-width: 100%; margin: 0 auto; padding: 0 var(--space-xl); display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-3xl); align-items: center; position: relative; z-index: 1; }
        .hero-content { display: flex; flex-direction: column; gap: var(--space-xl); }
        .hero-title { font-size: 3.5rem; font-weight: 700; line-height: 1.2; margin: 0; }
        .hero-description { font-size: 1.25rem; color: var(--text-secondary); line-height: 1.6; margin: 0; }
        .hero-cta-button { background: var(--gradient-ai); color: white; border: none; padding: var(--space-md) var(--space-xl); border-radius: 12px; font-family: var(--font-secondary); font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: var(--space-sm); transition: all var(--transition-fast); margin-top: var(--space-md); text-decoration: none; align-self: flex-start; }
        .hero-cta-button:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); }
        .hero-visual { position: relative; height: 400px; display: flex; align-items: center; justify-content: center; }
        .floating-cards { position: relative; width: 100%; height: 100%; }
        .feature-card { position: absolute; background: var(--glass-bg); backdrop-filter: var(--glass-blur); border: 1px solid var(--glass-border); border-radius: 16px; padding: var(--space-lg); display: flex; flex-direction: column; align-items: center; gap: var(--space-sm); box-shadow: var(--shadow-lg); transition: transform var(--transition-normal), box-shadow var(--transition-normal), background var(--transition-theme), border-color var(--transition-theme); animation: float 6s ease-in-out infinite; }
        .feature-card i { font-size: 2rem; background: var(--gradient-ai); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .feature-card span { font-family: var(--font-secondary); font-weight: 600; color: var(--text-primary); font-size: 0.9rem; text-align: center; white-space: nowrap; }
        .card-1 { top: 20%; left: 10%; animation-delay: 0s; }
        .card-2 { top: 50%; right: 20%; animation-delay: 2s; }
        .card-3 { bottom: 20%; left: 30%; animation-delay: 4s; }
        @keyframes float { 0%, 100% { transform: translateY(0px) rotate(0deg); } 33% { transform: translateY(-20px) rotate(1deg); } 66% { transform: translateY(10px) rotate(-1deg); } }
        
        /* Hide feature cards on mobile */
        @media (max-width: 768px) {
          .floating-cards, .feature-card { display: none; }
        }
        .tools-section { 
            padding: var(--space-4xl) 0; 
            background: var(--bg-primary);
            position: relative;
        }
        .tools-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 200px;
            background: radial-gradient(ellipse at top, rgba(0, 212, 255, 0.05) 0%, transparent 70%);
            pointer-events: none;
        }
        .tools-container { 
            max-width: 1400px; 
            margin: 0 auto; 
            padding: 0 var(--space-xl); 
            position: relative;
            z-index: 1;
        }
        .section-header { 
            text-align: center; 
            margin-bottom: var(--space-4xl);
            padding: 0 var(--space-lg);
        }
        .section-title { 
            font-size: 2.75rem; 
            font-weight: 800; 
            margin: 0 0 var(--space-md) 0;
            letter-spacing: -0.03em;
            line-height: 1.2;
        }
        .section-description { 
            font-size: 1.15rem; 
            color: var(--text-secondary); 
            margin: 0;
            max-width: 900px;
            margin: 0 auto;
            line-height: 1.7;
        }

        /* Category Tabs */
        .category-tabs { 
            display: flex; 
            flex-wrap: wrap; 
            gap: var(--space-md); 
            margin-bottom: var(--space-3xl); 
            justify-content: center;
            padding: var(--space-md);
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06);
        }
  .tab-button { 
    background: transparent; 
    border: 2px solid transparent; 
    border-radius: 14px; 
    padding: 14px var(--space-xl); 
    min-height: 48px; 
    font-family: var(--font-secondary); 
    font-weight: 700; 
    font-size: 0.95rem;
    color: var(--text-secondary); 
    cursor: pointer; 
    display: flex; 
    align-items: center; 
    gap: var(--space-sm); 
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
    white-space: nowrap;
    position: relative;
  }
        .tab-button:hover { 
            color: var(--accent-blue); 
            background: rgba(0, 212, 255, 0.08);
            transform: translateY(-2px); 
        }
        .tab-button.active { 
            background: var(--gradient-ai); 
            color: white; 
            border-color: transparent; 
            box-shadow: 0 8px 24px rgba(0, 212, 255, 0.4);
            transform: translateY(-2px);
        }
        .tab-button i { font-size: 1.1rem; }

        /* Tools Grid & Cards */
        .tools-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr)); 
            gap: var(--space-xl);
            margin-top: var(--space-2xl);
        }
        .tool-card { 
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            border: 2px solid transparent;
            border-radius: 20px; 
            padding: var(--space-xl); 
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.4s ease, border-color 0.3s ease, background 0.3s ease; 
            cursor: pointer; 
            position: relative; 
            overflow: hidden; 
            display: flex; 
            flex-direction: column;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
            backdrop-filter: blur(10px);
            will-change: transform;
            transform: translateZ(0);
        }
        .tool-card::before { 
            content: ''; 
            position: absolute; 
            top: 0; 
            left: 0; 
            right: 0; 
            height: 4px; 
            background: var(--gradient-ai); 
            transform: scaleX(0); 
            transition: transform 0.4s ease;
            border-radius: 20px 20px 0 0;
        }
        .tool-card::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 20px;
            padding: 2px;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: exclude;
            opacity: 0;
            transition: opacity 0.4s ease;
        }
        .tool-card:hover { 
            transform: translateY(-12px) scale(1.02); 
            box-shadow: 0 20px 40px rgba(0, 212, 255, 0.2), 0 0 60px rgba(139, 92, 246, 0.1);
            background: linear-gradient(135deg, var(--bg-primary) 0%, rgba(0, 212, 255, 0.05) 100%);
        }
        .tool-card:hover::before { transform: scaleX(1); }
        .tool-card:hover::after { opacity: 1; }
        .tool-header { 
            display: flex; 
            align-items: center; 
            gap: var(--space-md); 
            margin-bottom: var(--space-lg);
        }
        .tool-icon { 
            width: 56px; 
            height: 56px; 
            border-radius: 16px; 
            background: var(--gradient-ai); 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: white; 
            font-size: 1.75rem; 
            flex-shrink: 0;
            box-shadow: 0 8px 24px rgba(0, 212, 255, 0.3);
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        .tool-card:hover .tool-icon {
            transform: scale(1.1) rotate(-5deg);
        }
        .tool-content { flex-grow: 1; }
        .tool-title { 
            font-size: 1.35rem; 
            font-weight: 700; 
            margin: 0 0 var(--space-sm) 0; 
            color: var(--text-primary);
            letter-spacing: -0.02em;
            line-height: 1.3;
        }
        .tool-description { 
            color: var(--text-secondary); 
            line-height: 1.6; 
            margin: 0 0 var(--space-xl) 0;
            font-size: 0.95rem;
        }
        .tool-action { 
            background: var(--gradient-ai); 
            color: white; 
            border: none; 
            padding: 14px var(--space-lg); 
            min-height: 48px; 
            border-radius: 12px; 
            font-family: var(--font-secondary); 
            font-weight: 700; 
            font-size: 0.95rem;
            cursor: pointer; 
            transition: all 0.3s ease; 
            width: 100%; 
            margin-top: auto;
            box-shadow: 0 4px 16px rgba(0, 212, 255, 0.3);
            position: relative;
            overflow: hidden;
        }
        .tool-action::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        .tool-action:hover::before {
            width: 300px;
            height: 300px;
        }
        .tool-action:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 8px 24px rgba(0, 212, 255, 0.5);
        }

        /* Footer */
        .footer { background: var(--bg-tertiary); padding: var(--space-2xl) 0 var(--space-lg) 0; border-top: 1px solid var(--glass-border); }
        .footer-container { max-width: 100%; margin: 0 auto; padding: 0 var(--space-xl); }
        .footer-content { display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-lg); }
        .footer-brand { display: flex; flex-direction: column; gap: var(--space-sm); }
        .footer-logo { font-family: var(--font-accent); font-size: 1.5rem; font-weight: 800; background: var(--gradient-ai); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin: 0; }
        .footer-tagline { color: var(--text-secondary); margin: 0; }
        .footer-links { display: flex; align-items: center; gap: var(--space-md); }
        .footer-link { color: var(--text-secondary); text-decoration: none; font-family: var(--font-secondary); transition: color var(--transition-fast); }
        .footer-link:hover { color: var(--accent-blue); }
        .footer-separator { color: var(--text-muted); }
        .footer-bottom { text-align: center; padding-top: var(--space-lg); border-top: 1px solid var(--glass-border); }
        .footer-copyright { color: var(--text-muted); font-size: 0.875rem; margin: 0; }

        /* Responsive Design */
        @media (max-width: 1024px) {
          .hero-container { grid-template-columns: 1fr; gap: var(--space-2xl); text-align: center; }
          .hero-cta-button { align-self: center; }
          .hero-title { font-size: 3rem; }
          .tools-grid { grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); }
          .nav-search { flex: 0 1 300px; max-width: 300px; }
          .nav-menu { gap: var(--space-md); }
          
          /* Hide mobile CTA by default - show only on mobile */
          .mobile-cta-section { display: none; }
        }
        @media (max-width: 768px) {
          /* Optimize navbar for mobile */
          .navbar { padding: var(--space-sm) 0; }
          .nav-container { padding: 0 var(--space-md); }
          .nav-logo { flex: 1; }
          .logo-text { font-size: 1.5rem; }
          .logo-tagline { font-size: 0.65rem; }
          .nav-controls { gap: var(--space-sm); }
          .mobile-search-toggle { 
            display: flex !important; 
            width: 44px; 
            height: 44px; 
            border: none; 
            border-radius: 12px; 
            background: var(--glass-bg); 
            color: var(--text-secondary); 
            cursor: pointer; 
            align-items: center; 
            justify-content: center; 
            transition: all var(--transition-fast); 
            backdrop-filter: var(--glass-blur); 
            border: 1px solid var(--glass-border); 
          }
          .mobile-search-toggle:hover {
            color: var(--accent-blue);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
          }
          .login-btn { padding: 10px 14px; min-height: 44px; font-size: 0.85rem; }
          .theme-toggle { width: 44px; height: 44px; }
          
          .nav-menu { display: none; position: fixed; top: 65px; left: 0; right: 0; background: var(--bg-primary); border-top: 1px solid var(--glass-border); flex-direction: column; padding: var(--space-lg); gap: var(--space-lg); opacity: 0; visibility: hidden; transition: all var(--transition-normal); box-shadow: var(--shadow-lg); }
          .nav-menu.active { opacity: 1; visibility: visible; }
          .mobile-menu-toggle { display: flex; }
          .mobile-menu-toggle.active span:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
          .mobile-menu-toggle.active span:nth-child(2) { opacity: 0; }
          .mobile-menu-toggle.active span:nth-child(3) { transform: rotate(-45deg) translate(7px, -6px); }
          
          /* Mobile Search Container Optimization */
          .mobile-search-container { padding: 10px 12px !important; gap: 10px !important; }
          .mobile-search-back-btn { width: 42px !important; height: 42px !important; }
          
          /* ===== MOBILE CLEAN FIRST EXPERIENCE ===== */
          
          /* Show Hero Section */
          .hero { 
            display: block !important; 
            padding: 20px 0 30px 0 !important;
          }
          
          /* Show Popular Section */
          .popular-section { 
            padding: 30px 16px !important; 
            overflow: hidden; 
            display: block !important;
            background: var(--bg-primary);
          }
          
          .section-header { 
            text-align: center; 
            margin-bottom: 24px; 
          }
          
          .section-title { 
            font-size: 1.4rem !important; 
            line-height: 1.3 !important; 
            word-wrap: break-word; 
            margin-bottom: 8px;
          }
          
          .section-description { 
            font-size: 0.88rem !important; 
            line-height: 1.6 !important; 
            color: var(--text-secondary);
          }
          
          .popular-grid { 
            display: grid !important;
            grid-template-columns: 1fr !important; 
            gap: 14px !important; 
            margin: 0 auto;
            max-width: 100%;
          }
          
          .popular-card { 
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            padding: 20px !important; 
            min-height: auto !important;
            opacity: 1 !important;
            transform: none !important;
          }
          
          .popular-card-icon {
            width: 60px !important;
            height: 60px !important;
            font-size: 2rem !important;
            margin-bottom: 12px;
          }
          
          .popular-card-title { 
            font-size: 1.05rem !important; 
            word-wrap: break-word; 
            line-height: 1.3 !important; 
            text-align: center;
            margin-bottom: 4px;
          }
          
          .popular-card-subtitle {
            font-size: 0.85rem !important;
            color: var(--text-secondary);
            text-align: center;
          }
          
          /* Hide Full Calculator Grid - Only show via menu */
          .tools-section { 
            display: none !important; 
          }
          
          /* Mobile CTA Section */
          .mobile-cta-section {
            display: block !important;
            padding: 28px 20px !important;
            text-align: center;
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(139, 92, 246, 0.1));
            border-radius: 16px;
            margin: 0 16px 24px 16px !important;
          }
          
          .mobile-cta-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 12px;
            background: linear-gradient(135deg, #00D4FF, #8B5CF6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
          }
          
          .mobile-cta-description {
            font-size: 0.95rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.5;
          }
          
          .mobile-explore-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 14px 28px;
            background: linear-gradient(135deg, #00D4FF, #8B5CF6);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 4px 16px rgba(0, 212, 255, 0.3);
            transition: all 0.3s ease;
          }
          
          .mobile-explore-btn:active {
            transform: scale(0.95);
          }
          
          /* Hide nav search and floating search on mobile to avoid overlap */
          .nav-search { display: none; }
          .floating-search { display: none; }
          
          /* Mobile Search Modal */
          .mobile-search-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            z-index: 2000;
            display: none;
            flex-direction: column;
            padding: var(--space-lg);
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
          }
          .mobile-search-modal.active {
            display: flex;
            opacity: 1;
            transform: translateY(0);
          }
          .mobile-search-header {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
          }
          .mobile-search-close {
            width: 44px;
            height: 44px;
            border: none;
            border-radius: 12px;
            background: var(--glass-bg);
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all var(--transition-fast);
          }
          .mobile-search-close:hover {
            background: var(--accent-pink);
            color: white;
          }
          .mobile-search-input-container {
            flex: 1;
            position: relative;
          }
          .mobile-search-input-container .search-container {
            width: 100%;
          }
          .mobile-search-modal .search-suggestions {
            position: static;
            margin-top: var(--space-md);
            max-height: calc(100vh - 140px);
            opacity: 1;
            visibility: visible;
            transform: none;
            border-radius: 12px;
            overflow-y: auto;
          }
          .mobile-search-modal .search-suggestion-item {
            padding: var(--space-md);
            display: flex;
            align-items: center;
            gap: var(--space-md);
            border-bottom: 1px solid var(--glass-border);
            cursor: pointer;
            transition: all 0.2s ease;
          }
          .mobile-search-modal .search-suggestion-item:hover {
            background: var(--glass-bg);
          }
          .mobile-search-modal .search-suggestion-item i {
            font-size: 1.5rem;
            color: var(--accent-blue);
            width: 40px;
            text-align: center;
          }
          .mobile-search-modal .suggestion-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
          }
          .mobile-search-modal .suggestion-category {
            font-size: 0.85rem;
            color: var(--text-secondary);
          }
          
          /* Optimize hero section for mobile */
          .main-content { margin-top: 65px; }
          .hero { 
            padding: var(--space-lg) 0 var(--space-md) 0; 
            background: radial-gradient(ellipse at top, rgba(0, 212, 255, 0.08) 0%, transparent 60%);
          }
          .hero::before { opacity: 0.3; }
          .hero-container { 
            padding: var(--space-md); 
            gap: var(--space-md);
            max-width: 100%;
          }
          .hero-content {
            gap: var(--space-sm);
            max-width: 100%;
          }
          .hero-title { 
            font-size: 1.6rem; 
            line-height: 1.3;
            text-align: center;
          }
          .hero-description { 
            font-size: 0.88rem;
            text-align: center;
            line-height: 1.6;
            padding: 0 var(--space-sm);
            color: var(--text-secondary);
          }
          .hero-cta-button { 
            padding: 14px 24px; 
            font-size: 0.95rem;
            align-self: center;
            display: inline-flex;
            width: fit-content;
          }
          .hero-visual { height: 300px; display: none; }
          
          /* Better gradient text on mobile */
          .gradient-text {
            display: inline-block;
            line-height: 1.3;
          }
          
          /* Popular section always visible on mobile */
          .popular-section {
            display: block !important;
            padding: var(--space-xl) 0;
          }
          .popular-section .section-title {
            font-size: 1.75rem;
          }
          .popular-section .section-description {
            font-size: 0.95rem;
            padding: 0 var(--space-sm);
          }
          .popular-section .popular-grid {
            grid-template-columns: 1fr;
            gap: var(--space-md);
            padding: 0 var(--space-md);
          }
          
          /* Optimize tools section */
          .tools-section { padding: var(--space-xl) 0; }
          .section-title { font-size: 1.75rem; }
          .section-description { font-size: 0.95rem; }
          .category-tabs { overflow-x: auto; justify-content: flex-start; padding-bottom: var(--space-sm); -ms-overflow-style: none; scrollbar-width: none; }
          .category-tabs::-webkit-scrollbar { display: none; }
          .tools-grid { grid-template-columns: 1fr; gap: var(--space-md); }
          
          /* Optimize tool cards */
          .tool-card { padding: var(--space-md); }
          .tool-title { font-size: 1.1rem; }
          .tool-description { font-size: 0.9rem; }
          
          /* Footer optimization */
          .footer { padding: var(--space-xl) 0 var(--space-md) 0; }
          .footer-content { flex-direction: column; gap: var(--space-lg); text-align: center; }
          .footer-links { flex-wrap: wrap; justify-content: center; }
        }

        /* Mobile: hide category tabs by default and show when activated from the mobile menu */
        @media (max-width: 768px) {
          /* Mobile Navigation Back Button */
          .mobile-nav-back {
            position: fixed;
            top: var(--space-lg);
            left: var(--space-lg);
            padding: var(--space-sm) var(--space-lg);
            background: var(--bg-primary);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            color: var(--text-secondary);
            font-family: var(--font-secondary);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            z-index: 1200;
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-fast);
          }

          .mobile-nav-back.visible {
            opacity: 1;
            visibility: visible;
          }

          .mobile-nav-back:hover {
            background: var(--bg-secondary);
            color: var(--accent-blue);
            transform: translateX(-4px);
          }

          /* Hidden by default on small screens */
          /* Mobile menu slides in from right */
          .category-tabs {
            position: fixed;
            top: 0;
            right: -320px; /* Start offscreen, slightly wider for content */
            width: 320px;
            height: 100vh;
            background: var(--bg-primary);
            border-left: 1px solid var(--glass-border);
            padding: var(--space-lg) var(--space-md) var(--space-md);
            display: flex;
            flex-direction: column;
            gap: var(--space-lg);
            z-index: 1100;
            transition: right var(--transition-normal);
            box-shadow: var(--shadow-lg);
            overflow-y: auto;
          }
          
          /* Mobile menu sections */
          .mobile-menu-categories {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
          }
          
          .mobile-menu-tools {
            display: none;
            flex-direction: column;
            gap: var(--space-md);
          }
          
          .mobile-menu-tools.visible {
            display: flex;
          }
          
          .category-tabs.mobile-active {
            right: 0; /* Slide in */
          }
          
          /* Full-width buttons in mobile menu */
          .tab-button {
            width: 100%;
            display: flex;
            justify-content: flex-start;
            padding: 14px var(--space-lg);
            min-height: 48px;
            border-radius: 8px;
            text-align: left;
            background: var(--bg-primary);
            border: 1px solid var(--glass-border);
            color: var(--text-secondary);
            font-weight: 700;
            transition: all var(--transition-fast);
          }
          
          /* Active and hover states for mobile menu buttons */
          .tab-button:hover {
            background: var(--glass-bg);
            border-color: var(--accent-blue);
            transform: translateX(4px);
          }
          
          .tab-button.active {
            background: var(--gradient-ai);
            color: white;
            border: none;
            transform: translateX(4px);
          }
          
          /* Add overlay when menu is open */
          .mobile-menu-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1050;
            opacity: 0;
            transition: opacity var(--transition-normal);
          }
          
          .mobile-menu-overlay.active {
            display: block;
            opacity: 1;
          }

          /* Mobile menu styles */
          .mobile-menu-close {
            display: none;
            position: fixed;
            top: var(--space-md);
            right: var(--space-md);
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            background: var(--glass-bg);
            color: var(--text-secondary);
            font-size: 1.2rem;
            z-index: 1200;
            cursor: pointer;
            transition: all var(--transition-normal);
          }
          
          .mobile-menu-close:hover {
            background: var(--accent-pink);
            color: white;
            transform: rotate(90deg);
          }
          
          .category-tabs.mobile-active + .mobile-menu-close {
            display: flex;
            align-items: center;
            justify-content: center;
          }

          /* Mobile tool cards */
          .mobile-menu-tools .tool-card {
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: var(--space-md);
            transition: all var(--transition-fast);
          }

          .mobile-menu-tools .tool-card:hover {
            transform: translateX(4px);
            border-color: var(--accent-blue);
          }

          .mobile-menu-tools .tool-header {
            gap: var(--space-sm);
          }

          .mobile-menu-tools .tool-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
          }

          .mobile-menu-tools .tool-title {
            font-size: 1rem;
            margin: 0;
          }

          .mobile-menu-tools .tool-description {
            font-size: 0.875rem;
            margin: var(--space-sm) 0 0;
          }
        }
        @media (max-width: 480px) {
          /* Extra optimization for small phones */
          .navbar { padding: 8px 0; }
          .nav-container { padding: 0 var(--space-sm); }
          .logo-text { font-size: 1.25rem; }
          .logo-tagline { font-size: 0.6rem; display: none; }
          .login-btn { padding: 10px 14px; min-height: 44px; font-size: 0.8rem; gap: 6px; }
          .login-btn i { font-size: 0.9rem; }
          .theme-toggle { width: 44px; height: 44px; font-size: 1rem; }
          
          /* Keep search hidden on small phones */
          .floating-search { display: none; }
          
          .main-content { margin-top: 60px; }
          .hero { 
            padding: var(--space-md) 0 var(--space-xl) 0;
            background: radial-gradient(ellipse at top, rgba(0, 212, 255, 0.06) 0%, transparent 50%);
          }
          .hero::before { display: none; }
          .hero-container { 
            padding: var(--space-sm);
          }
          .hero-content { gap: var(--space-sm); }
          .hero-title { 
            font-size: 1.6rem;
            line-height: 1.2;
            padding: 0;
          }
          .hero-description { 
            font-size: 0.9rem;
            line-height: 1.5;
            padding: 0;
          }
          .hero-cta-button { 
            padding: 10px var(--space-md); 
            font-size: 0.9rem;
          }
          
          .tools-container { padding: 0 var(--space-sm); }
          .section-header { margin-bottom: var(--space-xl); }
          .section-title { font-size: 1.6rem; }
          .section-description { font-size: 0.9rem; }
          
          .footer-container { padding: 0 var(--space-sm); }
          .footer-logo { font-size: 1.25rem; }
        }

        /* Scroll to Top Button */
        .scroll-to-top { position: fixed; bottom: 30px; right: 30px; z-index: 1000; width: 50px; height: 50px; border: none; border-radius: 50%; background: var(--gradient-ai); color: white; cursor: pointer; display: none; align-items: center; justify-content: center; box-shadow: var(--shadow-lg); transition: all var(--transition-fast); font-size: 1.25rem; }
        .scroll-to-top:hover { transform: translateY(-4px); box-shadow: var(--shadow-xl); }

        /* Mobile Categories Menu */
        .mobile-categories-menu {
            position: fixed;
            top: 0;
            right: -100%;
            width: 100%;
            max-width: 450px;
            height: 100vh;
            background: var(--bg-primary);
            border-left: 1px solid var(--glass-border);
            z-index: 1150;
            transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: -8px 0 32px rgba(0, 0, 0, 0.3);
        }
        .mobile-categories-menu.active {
            right: 0;
        }
        .mobile-categories-menu::-webkit-scrollbar {
            width: 6px;
        }
        .mobile-categories-menu::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }
        .mobile-categories-menu::-webkit-scrollbar-thumb {
            background: var(--accent-blue);
            border-radius: 3px;
        }
        
        /* Full screen on very small devices */
        @media (max-width: 480px) {
            .mobile-categories-menu {
                max-width: 100%;
                border-left: none;
            }
        }

        .mobile-search-box {
            flex-grow: 1;
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 18px;
            background: var(--bg-primary);
            border: 2px solid var(--glass-border);
            border-radius: 14px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        .mobile-search-box:focus-within {
            border-color: var(--accent-blue);
            box-shadow: 0 4px 16px rgba(0, 212, 255, 0.25);
            background: var(--bg-primary);
            transform: translateY(-2px);
        }
        .mobile-search-icon {
            color: var(--accent-blue);
            font-size: 1.2rem;
            flex-shrink: 0;
            transition: transform 0.3s ease;
        }
        .mobile-search-box:focus-within .mobile-search-icon {
            transform: scale(1.15) rotate(15deg);
        }
        .mobile-search-input {
            flex: 1;
            border: none;
            background: none;
            color: var(--text-primary);
            font-family: var(--font-secondary);
            font-size: 1rem;
            font-weight: 500;
            outline: none;
        }
        .mobile-search-input::placeholder {
            color: var(--text-muted);
            font-weight: 400;
        }
        .mobile-search-clear {
            background: rgba(255, 106, 110, 0.1);
            border: none;
            color: #FF6A6E;
            cursor: pointer;
            font-size: 1rem;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            flex-shrink: 0;
        }
        .mobile-search-clear:hover {
            background: rgba(255, 106, 110, 0.2);
            color: #FF6A6E;
            transform: scale(1.15) rotate(90deg);
        }
        .mobile-search-clear:active {
            transform: scale(0.95) rotate(90deg);
        }
        .mobile-menu-back-btn {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(139, 92, 246, 0.1));
            border: 2px solid var(--glass-border);
            color: var(--text-primary);
            font-family: var(--font-secondary);
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 14px 20px;
            min-height: 50px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        .mobile-menu-back-btn:hover {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.2), rgba(139, 92, 246, 0.2));
            color: var(--accent-blue);
            transform: translateX(-6px) scale(1.02);
            border-color: var(--accent-blue);
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.3);
        }
        .mobile-menu-back-btn:active {
            transform: translateX(-4px) scale(0.98);
        }
        .mobile-menu-back-btn i {
            font-size: 1.1rem;
            transition: transform 0.3s ease;
        }
        .mobile-menu-back-btn:hover i {
            transform: translateX(-3px);
        }
        .mobile-login-btn {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            color: var(--text-primary);
            width: 40px;
            height: 40px;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
            flex-shrink: 0;
        }
        .mobile-login-btn:hover {
            color: var(--accent-blue);
            transform: scale(1.05);
        }
        .mobile-login-btn[data-logged="true"] {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-cyan));
            color: white;
            border-color: transparent;
        }
        .mobile-menu-content {
            padding: var(--space-xl) var(--space-lg);
            display: flex;
            flex-direction: column;
            gap: 16px;
            overflow-y: auto;
            flex: 1;
            padding-bottom: 40px;
            background: linear-gradient(180deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }
        /* Mobile Bottom Navigation */
        .mobile-bottom-nav {
            position: sticky;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-primary);
            border-top: 1px solid var(--glass-border);
            padding: var(--space-md);
            display: flex;
            justify-content: center;
            gap: var(--space-md);
            box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
            z-index: 10;
        }
        .mobile-nav-item {
            flex: 1;
            max-width: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: var(--space-md);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            color: var(--text-primary);
            font-family: var(--font-secondary);
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        .mobile-nav-item:hover {
            transform: translateY(-2px);
            background: var(--bg-secondary);
            color: var(--accent-blue);
        }
        .mobile-nav-item i {
            font-size: 1.5rem;
            transition: all var(--transition-fast);
        }
        .mobile-nav-item:active {
            transform: translateY(0) scale(0.95);
        }
        .mobile-nav-item.active {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.15), rgba(139, 92, 246, 0.15));
            color: var(--accent-blue);
            border-color: var(--accent-blue);
        }
        .mobile-nav-item.active i {
            transform: scale(1.1);
        }
        .mobile-nav-item span {
            font-size: 0.75rem;
            font-weight: 600;
            text-align: center;
        }
        .mobile-nav-item[data-logged="true"] {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-cyan));
            color: white;
            border-color: transparent;
        }
        .mobile-nav-item[data-logged="true"]:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.3);
        }
        @media (max-width: 768px) {
            .mobile-bottom-nav {
                display: flex;
            }
        }
        @media (min-width: 769px) {
            .mobile-bottom-nav {
                display: none;
            }
            .mobile-cta-section {
                display: none !important;
            }
            .tools-section {
                display: block !important;
            }
            
            /* Desktop Popular Section Override */
            .popular-section {
                padding: var(--space-3xl) 0 var(--space-4xl) 0 !important;
                background: linear-gradient(180deg, var(--bg-primary) 0%, var(--bg-secondary) 50%, var(--bg-primary) 100%) !important;
            }
            
            .popular-section .section-header {
                text-align: center;
                margin-bottom: var(--space-3xl) !important;
            }
            
            .popular-section .section-title {
                font-size: 2.5rem !important;
                line-height: 1.2 !important;
            }
            
            .popular-section .section-description {
                font-size: 1.1rem !important;
                line-height: 1.6 !important;
            }
            
            .popular-grid {
                display: grid !important;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)) !important;
                gap: var(--space-xl) !important;
                max-width: 1400px !important;
                margin: 0 auto !important;
                padding: 0 var(--space-lg) !important;
            }
            
            .popular-card {
                padding: var(--space-xl) var(--space-lg) !important;
            }
            
            .popular-card-icon {
                width: 70px !important;
                height: 70px !important;
                font-size: 2.2rem !important;
            }
            
            .popular-card-title {
                font-size: 1.1rem !important;
            }
            
            .popular-card-subtitle {
                font-size: 0.9rem !important;
            }
        }
        .mobile-category-btn {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 18px 20px;
            min-height: 64px;
            border: none;
            border-radius: 14px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-family: var(--font-secondary);
            font-weight: 700;
            font-size: 1.05rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: left;
            white-space: nowrap;
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            opacity: 0;
            transform: translateX(-30px);
            animation: slideInFromLeft 0.5s ease-out forwards;
        }
        
        /* Stagger animation for each button */
        .mobile-category-btn:nth-child(1) { animation-delay: 0.05s; }
        .mobile-category-btn:nth-child(2) { animation-delay: 0.1s; }
        .mobile-category-btn:nth-child(3) { animation-delay: 0.15s; }
        .mobile-category-btn:nth-child(4) { animation-delay: 0.2s; }
        .mobile-category-btn:nth-child(5) { animation-delay: 0.25s; }
        .mobile-category-btn:nth-child(6) { animation-delay: 0.3s; }
        .mobile-category-btn:nth-child(7) { animation-delay: 0.35s; }
        .mobile-category-btn:nth-child(8) { animation-delay: 0.4s; }
        .mobile-category-btn:nth-child(9) { animation-delay: 0.45s; }
        .mobile-category-btn:nth-child(10) { animation-delay: 0.5s; }
        
        @keyframes slideInFromLeft {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .mobile-category-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .mobile-category-btn:hover::before {
            left: 100%;
        }
        
        .mobile-category-btn:active {
            transform: scale(0.97);
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
        }
        
        .mobile-category-btn:hover {
            transform: translateX(8px) scale(1.02);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
        }
        
        .mobile-category-btn i {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 1.2rem;
            flex-shrink: 0;
            transition: transform 0.3s ease;
        }
        
        .mobile-category-btn:hover i {
            transform: scale(1.15) rotate(5deg);
        }
        
        .category-name {
            flex: 1;
            text-align: left;
        }
        
        .category-arrow {
            margin-left: auto;
            font-size: 1rem;
            opacity: 0.7;
            transition: all 0.3s ease;
        }
        
        .mobile-category-btn:hover .category-arrow {
            opacity: 1;
            transform: translateX(4px);
        }
        
        /* Category-specific button colors for mobile - Enhanced Gradients */
        .mobile-category-btn[data-category="all"] { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        .mobile-category-btn[data-category="financial"] { 
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); 
            color: white; 
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        .mobile-category-btn[data-category="health"] { 
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); 
            color: white; 
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        .mobile-category-btn[data-category="math"] { 
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); 
            color: #1a1f3a; 
            border: 2px solid rgba(26, 31, 58, 0.1);
            font-weight: 800;
        }
        .mobile-category-btn[data-category="datetime"] { 
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); 
            color: #1a1f3a; 
            border: 2px solid rgba(26, 31, 58, 0.1);
        }
        .mobile-category-btn[data-category="construction"] { 
            background: linear-gradient(135deg, #ff9a56 0%, #ff6a88 100%); 
            color: white; 
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        .mobile-category-btn[data-category="physics"] { 
            background: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%); 
            color: #1a1f3a; 
            border: 2px solid rgba(26, 31, 58, 0.1);
        }
        .mobile-category-btn[data-category="everyday"] { 
            background: linear-gradient(135deg, #fddb92 0%, #d1fdff 100%); 
            color: #1a1f3a; 
            border: 2px solid rgba(26, 31, 58, 0.1);
        }
        .mobile-category-btn[data-category="education"] { 
            background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%); 
            color: #1a1f3a; 
            border: 2px solid rgba(26, 31, 58, 0.1);
        }
        .mobile-category-btn[data-category="technology"] { 
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); 
            color: #1a1f3a; 
            border: 2px solid rgba(26, 31, 58, 0.1);
        }
        .mobile-category-btn[data-category="scientific"] { 
            background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%); 
            color: #1a1f3a; 
            border: 2px solid rgba(26, 31, 58, 0.1);
        }
        .mobile-category-btn[data-category="business"] { 
            background: linear-gradient(135deg, #f7971e 0%, #ffd200 100%); 
            color: #1a1f3a; 
            border: 2px solid rgba(26, 31, 58, 0.1);
            font-weight: 800;
        }
        .mobile-category-btn[data-category="electricity"] { 
            background: linear-gradient(135deg, #f12711 0%, #f5af19 100%); 
            color: white; 
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        .mobile-category-btn[data-category="travel"] { 
            background: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%); 
            color: white; 
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        .mobile-category-btn[data-category="taxation"] { 
            background: linear-gradient(135deg, #ee0979 0%, #ff6a00 100%); 
            color: white; 
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        /* Mobile Tools List Styles */
        .mobile-menu-tools-header {
            padding: var(--space-lg) var(--space-md);
            border-bottom: 1px solid var(--glass-border);
        }
        .mobile-tools-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            padding: var(--space-md);
        }
        
        /* Subcategory Styles */
        .subcategory-section {
            margin-bottom: var(--space-xl);
        }
        .subcategory-header {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            padding: var(--space-lg);
            min-height: 76px;
            background: var(--bg-secondary);
            border-radius: 12px;
            margin-bottom: var(--space-md);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid transparent;
            user-select: none;
        }
        .subcategory-header:hover {
            background: var(--glass-bg);
            border-color: var(--accent-blue);
            transform: translateX(6px);
            box-shadow: var(--shadow-md);
        }
        .subcategory-header:focus-visible {
            outline: 3px solid var(--accent-blue);
            outline-offset: 2px;
            box-shadow: 0 0 0 4px rgba(0, 212, 255, 0.2);
        }
        .subcategory-header.expanded {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.12), rgba(139, 92, 246, 0.12));
            border-color: var(--accent-blue);
        }
        .subcategory-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            background: var(--gradient-ai);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        .subcategory-title {
            font-family: var(--font-secondary);
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
            flex-grow: 1;
        }
        .subcategory-toggle {
            color: var(--text-secondary);
            font-size: 1.3rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: var(--glass-bg);
        }
        .subcategory-header.expanded .subcategory-toggle {
            transform: rotate(180deg);
            color: var(--accent-blue);
            background: rgba(0, 212, 255, 0.2);
        }
        .subcategory-header:hover .subcategory-toggle {
            background: rgba(0, 212, 255, 0.15);
            transform: scale(1.1);
        }
        .subcategory-header.expanded:hover .subcategory-toggle {
            transform: rotate(180deg) scale(1.1);
        }
        .subcategory-calculators {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: var(--space-lg);
            max-height: 5000px;
            opacity: 1;
            margin-top: var(--space-md);
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1),
                        opacity 0.3s ease-out,
                        margin-top 0.3s ease-out;
        }
        .subcategory-calculators.collapsed {
            max-height: 0;
            opacity: 0;
            margin-top: 0;
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1),
                        opacity 0.2s ease-in,
                        margin-top 0.2s ease-in;
        }
        
        @media (max-width: 768px) {
            .subcategory-calculators {
                grid-template-columns: 1fr;
            }
        }
        .mobile-tool-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 16px;
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all var(--transition-fast);
            text-decoration: none;
            color: var(--text-primary);
        }
        .mobile-tool-item:hover {
            transform: translateX(8px);
            background: var(--glass-bg);
            border-color: var(--accent-blue);
        }
        .mobile-tool-icon {
            width: 44px;
            height: 44px;
            border-radius: 10px;
            background: var(--gradient-ai);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            flex-shrink: 0;
        }
        .mobile-tool-info {
            flex-grow: 1;
        }
        .mobile-tool-title {
            font-family: var(--font-secondary);
            font-size: 1rem;
            font-weight: 600;
            margin: 0 0 4px 0;
            color: var(--text-primary);
        }
        .mobile-tool-description {
            font-family: var(--font-secondary);
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin: 0;
            line-height: 1.3;
        }

        /* Mobile Subcategory Sections */
        .mobile-subcategories-container {
            padding: var(--space-md);
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
        }
        .mobile-subcategory-section {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(0, 212, 255, 0.03) 100%);
            border: 2px solid var(--glass-border);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 12px;
        }
        .mobile-subcategory-section:hover {
            border-color: rgba(0, 212, 255, 0.3);
            box-shadow: 0 8px 24px rgba(0, 212, 255, 0.15);
            transform: translateY(-2px);
        }
        .mobile-subcategory-header {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 18px 20px;
            min-height: 72px;
            cursor: pointer;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.05), rgba(139, 92, 246, 0.05));
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            position: relative;
            overflow: hidden;
        }
        .mobile-subcategory-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 212, 255, 0.1), transparent);
            transition: left 0.6s ease;
        }
        .mobile-subcategory-header:hover::before {
            left: 100%;
        }
        .mobile-subcategory-header:hover {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.12), rgba(139, 92, 246, 0.12));
            transform: translateX(6px);
        }
        .mobile-subcategory-header:active {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.18), rgba(139, 92, 246, 0.18));
            transform: scale(0.97);
        }
        .mobile-subcategory-header:focus-visible {
            outline: 3px solid var(--accent-blue);
            outline-offset: 3px;
            box-shadow: 0 0 0 6px rgba(0, 212, 255, 0.25);
        }
        .mobile-subcategory-header.expanded {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.2), rgba(139, 92, 246, 0.2));
            border-bottom: 3px solid var(--accent-blue);
            box-shadow: 0 4px 16px rgba(0, 212, 255, 0.25);
        }
        .mobile-subcategory-icon {
            width: 50px;
            height: 50px;
            border-radius: 14px;
            background: linear-gradient(135deg, #00D4FF 0%, #8B5CF6 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.35rem;
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.3);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        .mobile-subcategory-header:hover .mobile-subcategory-icon {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 6px 20px rgba(0, 212, 255, 0.4);
        }
        
        /* Unique icons for Financial subcategories */
        .mobile-subcategory-header:has(.mobile-subcategory-info h4:contains("Banking")) .mobile-subcategory-icon,
        .mobile-subcategory-section:nth-child(1) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #667EEA 0%, #764BA2 100%);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        .mobile-subcategory-section:nth-child(2) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #F093FB 0%, #F5576C 100%);
            box-shadow: 0 4px 12px rgba(245, 87, 108, 0.4);
        }
        .mobile-subcategory-section:nth-child(3) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #4FACFE 0%, #00F2FE 100%);
            box-shadow: 0 4px 12px rgba(79, 172, 254, 0.4);
        }
        .mobile-subcategory-section:nth-child(4) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #43E97B 0%, #38F9D7 100%);
            box-shadow: 0 4px 12px rgba(67, 233, 123, 0.4);
        }
        .mobile-subcategory-section:nth-child(5) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #FA8BFF 0%, #2BD2FF 100%);
            box-shadow: 0 4px 12px rgba(250, 139, 255, 0.4);
        }
        .mobile-subcategory-section:nth-child(6) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #FFD26F 0%, #3677FF 100%);
            box-shadow: 0 4px 12px rgba(255, 210, 111, 0.4);
        }
        .mobile-subcategory-section:nth-child(7) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #A8EDEA 0%, #FED6E3 100%);
            box-shadow: 0 4px 12px rgba(168, 237, 234, 0.4);
        }
        .mobile-subcategory-section:nth-child(8) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #FF9A56 0%, #FF6B95 100%);
            box-shadow: 0 4px 12px rgba(255, 154, 86, 0.4);
        }
        .mobile-subcategory-section:nth-child(9) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #21D4FD 0%, #B721FF 100%);
            box-shadow: 0 4px 12px rgba(33, 212, 253, 0.4);
        }
        .mobile-subcategory-section:nth-child(10) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #08AEEA 0%, #2AF598 100%);
            box-shadow: 0 4px 12px rgba(8, 174, 234, 0.4);
        }
        
        .mobile-subcategory-header:hover .mobile-subcategory-section:nth-child(1) .mobile-subcategory-icon { box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6); }
        .mobile-subcategory-header:hover .mobile-subcategory-section:nth-child(2) .mobile-subcategory-icon { box-shadow: 0 6px 20px rgba(245, 87, 108, 0.6); }
        .mobile-subcategory-header:hover .mobile-subcategory-section:nth-child(3) .mobile-subcategory-icon { box-shadow: 0 6px 20px rgba(79, 172, 254, 0.6); }
        .mobile-subcategory-header:hover .mobile-subcategory-section:nth-child(4) .mobile-subcategory-icon { box-shadow: 0 6px 20px rgba(67, 233, 123, 0.6); }
        .mobile-subcategory-header:hover .mobile-subcategory-section:nth-child(5) .mobile-subcategory-icon { box-shadow: 0 6px 20px rgba(250, 139, 255, 0.6); }
        .mobile-subcategory-header:hover .mobile-subcategory-section:nth-child(6) .mobile-subcategory-icon { box-shadow: 0 6px 20px rgba(255, 210, 111, 0.6); }
        .mobile-subcategory-header:hover .mobile-subcategory-section:nth-child(7) .mobile-subcategory-icon { box-shadow: 0 6px 20px rgba(168, 237, 234, 0.6); }
        .mobile-subcategory-header:hover .mobile-subcategory-section:nth-child(8) .mobile-subcategory-icon { box-shadow: 0 6px 20px rgba(255, 154, 86, 0.6); }
        .mobile-subcategory-header:hover .mobile-subcategory-section:nth-child(9) .mobile-subcategory-icon { box-shadow: 0 6px 20px rgba(33, 212, 253, 0.6); }
        .mobile-subcategory-header:hover .mobile-subcategory-section:nth-child(10) .mobile-subcategory-icon { box-shadow: 0 6px 20px rgba(8, 174, 234, 0.6); }
        
        /* ========== Health & Fitness Category Specific Icons ========== */
        /* When health category is active, apply these gradients to subcategories */
        [data-category="health"] .mobile-subcategory-section:nth-child(1) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
        }
        [data-category="health"] .mobile-subcategory-section:nth-child(2) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #48C774 0%, #7ED56F 100%);
            box-shadow: 0 4px 12px rgba(72, 199, 116, 0.4);
        }
        [data-category="health"] .mobile-subcategory-section:nth-child(3) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #FF9A56 0%, #FFCC70 100%);
            box-shadow: 0 4px 12px rgba(255, 154, 86, 0.4);
        }
        [data-category="health"] .mobile-subcategory-section:nth-child(4) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #FF6A88 0%, #FF99AC 100%);
            box-shadow: 0 4px 12px rgba(255, 106, 136, 0.4);
        }
        [data-category="health"] .mobile-subcategory-section:nth-child(5) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #FFB7C5 0%, #FF91A4 100%);
            box-shadow: 0 4px 12px rgba(255, 183, 197, 0.4);
        }
        [data-category="health"] .mobile-subcategory-section:nth-child(6) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #6A89CC 0%, #4A69BD 100%);
            box-shadow: 0 4px 12px rgba(106, 137, 204, 0.4);
        }
        [data-category="health"] .mobile-subcategory-section:nth-child(7) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #A29BFE 0%, #6C5CE7 100%);
            box-shadow: 0 4px 12px rgba(162, 155, 254, 0.4);
        }
        [data-category="health"] .mobile-subcategory-section:nth-child(8) .mobile-subcategory-icon {
            background: linear-gradient(135deg, #FD79A8 0%, #E84393 100%);
            box-shadow: 0 4px 12px rgba(253, 121, 168, 0.4);
        }
        
        [data-category="health"] .mobile-subcategory-header:hover .mobile-subcategory-icon {
            transform: scale(1.1) rotate(5deg);
        }
        [data-category="health"] .mobile-subcategory-section:nth-child(1):hover .mobile-subcategory-icon {
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.6);
        }
        [data-category="health"] .mobile-subcategory-section:nth-child(2):hover .mobile-subcategory-icon {
            box-shadow: 0 6px 20px rgba(72, 199, 116, 0.6);
        }
        [data-category="health"] .mobile-subcategory-section:nth-child(3):hover .mobile-subcategory-icon {
            box-shadow: 0 6px 20px rgba(255, 154, 86, 0.6);
        }
        [data-category="health"] .mobile-subcategory-section:nth-child(4):hover .mobile-subcategory-icon {
            box-shadow: 0 6px 20px rgba(255, 106, 136, 0.6);
        }
        [data-category="health"] .mobile-subcategory-section:nth-child(5):hover .mobile-subcategory-icon {
            box-shadow: 0 6px 20px rgba(255, 183, 197, 0.6);
        }
        [data-category="health"] .mobile-subcategory-section:nth-child(6):hover .mobile-subcategory-icon {
            box-shadow: 0 6px 20px rgba(106, 137, 204, 0.6);
        }
        [data-category="health"] .mobile-subcategory-section:nth-child(7):hover .mobile-subcategory-icon {
            box-shadow: 0 6px 20px rgba(162, 155, 254, 0.6);
        }
        [data-category="health"] .mobile-subcategory-section:nth-child(8):hover .mobile-subcategory-icon {
            box-shadow: 0 6px 20px rgba(253, 121, 168, 0.6);
        }
        .mobile-subcategory-info {
            flex-grow: 1;
        }
        .mobile-subcategory-info h4 {
            font-family: var(--font-secondary);
            font-size: 1.05rem;
            font-weight: 700;
            margin: 0 0 4px 0;
            color: var(--text-primary);
            letter-spacing: 0.3px;
        }
        .mobile-subcategory-count {
            font-size: 0.8rem;
            color: var(--accent-blue);
            font-weight: 600;
            background: rgba(0, 212, 255, 0.1);
            padding: 2px 8px;
            border-radius: 10px;
            display: inline-block;
        }
        .mobile-subcategory-toggle {
            color: var(--text-secondary);
            font-size: 1.2rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            flex-shrink: 0;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(139, 92, 246, 0.1));
            border: 2px solid rgba(0, 212, 255, 0.2);
        }
        .mobile-subcategory-header.expanded .mobile-subcategory-toggle {
            transform: rotate(180deg) scale(1.1);
            color: var(--accent-blue);
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.25), rgba(139, 92, 246, 0.25));
            border-color: var(--accent-blue);
        }
        .mobile-subcategory-header:hover .mobile-subcategory-toggle {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.2), rgba(139, 92, 246, 0.2));
            transform: scale(1.15);
        }
        .mobile-subcategory-tools {
            max-height: 3000px;
            opacity: 1;
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1), 
                        opacity 0.4s ease-out,
                        padding 0.4s ease-out;
            padding: 20px 18px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.02), rgba(139, 92, 246, 0.02));
        }
        .mobile-subcategory-tools.collapsed {
            max-height: 0;
            opacity: 0;
            padding-top: 0;
            padding-bottom: 0;
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1),
                        opacity 0.2s ease-in,
                        padding 0.2s ease-in;
        }
        .mobile-subcategory-tools .mobile-tool-item {
            margin: 0;
            background: var(--bg-primary);
            border: 2px solid var(--glass-border);
            border-radius: 14px;
            padding: 16px 18px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            animation: slideInFromBottom 0.4s ease-out backwards;
        }
        .mobile-subcategory-tools .mobile-tool-item:nth-child(1) { animation-delay: 0.05s; }
        .mobile-subcategory-tools .mobile-tool-item:nth-child(2) { animation-delay: 0.1s; }
        .mobile-subcategory-tools .mobile-tool-item:nth-child(3) { animation-delay: 0.15s; }
        .mobile-subcategory-tools .mobile-tool-item:nth-child(4) { animation-delay: 0.2s; }
        .mobile-subcategory-tools .mobile-tool-item:nth-child(5) { animation-delay: 0.25s; }
        .mobile-subcategory-tools .mobile-tool-item:nth-child(6) { animation-delay: 0.3s; }
        .mobile-subcategory-tools .mobile-tool-item:nth-child(7) { animation-delay: 0.35s; }
        .mobile-subcategory-tools .mobile-tool-item:nth-child(8) { animation-delay: 0.4s; }
        .mobile-subcategory-tools .mobile-tool-item:hover {
            transform: translateX(8px) scale(1.02);
            border-color: var(--accent-blue);
            box-shadow: 0 8px 24px rgba(0, 212, 255, 0.2);
        }
        .mobile-subcategory-tools .mobile-tool-item:active {
            transform: scale(0.98);
        }
        @keyframes slideInFromBottom {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Search Suggestions Styling */
        .suggestion-item { padding: var(--space-md); display: flex; align-items: center; gap: var(--space-md); cursor: pointer; transition: all var(--transition-fast); border-bottom: 1px solid var(--glass-border); }
        .suggestion-item:last-child { border-bottom: none; }
        .suggestion-item:hover { background: var(--glass-bg); }
        .suggestion-item i { color: var(--accent-blue); width: 20px; text-align: center; }
        .suggestion-item span { color: var(--text-primary); font-family: var(--font-secondary); font-weight: 500; }

        /* No Results State */
        .no-results { grid-column: 1 / -1; text-align: center; padding: var(--space-3xl); color: var(--text-secondary); }
        .no-results i { font-size: 4rem; color: var(--text-muted); margin-bottom: var(--space-lg); }
        .no-results h3 { font-size: 1.5rem; margin: 0 0 var(--space-md) 0; color: var(--text-primary); }
        .no-results p { margin: 0; font-size: 1rem; }
        
        /* Tool Card Animation States */
        .tool-card { opacity: 0; transform: translateY(20px); transition: opacity var(--transition-normal), transform var(--transition-normal), background var(--transition-theme), border-color var(--transition-theme); }
        .tool-card.visible { opacity: 1; transform: translateY(0); }
        
        /* Category-specific Tool Card Accents */
        .tool-card[data-category="financial"] .tool-icon { background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-cyan) 100%); }
        .tool-card[data-category="health"] .tool-icon { background: linear-gradient(135deg, var(--accent-pink) 0%, var(--accent-purple) 100%); }
        .tool-card[data-category="math"] .tool-icon { background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-cyan) 100%); }
  .tool-card[data-category="business"] .tool-icon { background: linear-gradient(135deg, #FF7A59 0%, #FFB86B 100%); }
        
        /* Category Button Backgrounds (desktop + mobile) â€” target by data-category so colors stay correct even if button order changes */
        #categoryTabs .tab-button[data-category="all"],
        #mobileCategoryTabs .tab-button[data-category="all"] {
          background: linear-gradient(to right, #7367F0, #CE9FFC);
        }

        #categoryTabs .tab-button[data-category="financial"],
        #mobileCategoryTabs .tab-button[data-category="financial"] {
          background: linear-gradient(to right, #FF3366, #FF6B6B);
        }

        #categoryTabs .tab-button[data-category="health"],
        #mobileCategoryTabs .tab-button[data-category="health"] {
          background: linear-gradient(to right, #28C76F, #81FBB8);
        }

        #categoryTabs .tab-button[data-category="math"],
        #mobileCategoryTabs .tab-button[data-category="math"] {
          background: linear-gradient(to right, #8B5CF6, #D946EF);
        }

        #categoryTabs .tab-button[data-category="datetime"],
        #mobileCategoryTabs .tab-button[data-category="datetime"] {
          background: linear-gradient(to right, #a8edea, #fed6e3);
        }

        #categoryTabs .tab-button[data-category="construction"],
        #mobileCategoryTabs .tab-button[data-category="construction"] {
          background: linear-gradient(to right, #4E4F6A, #7A6F52);
        }

        #categoryTabs .tab-button[data-category="physics"],
        #mobileCategoryTabs .tab-button[data-category="physics"] {
          background: linear-gradient(to right, #FF6B6B, #FFA07A);
        }

        #categoryTabs .tab-button[data-category="everyday"],
        #mobileCategoryTabs .tab-button[data-category="everyday"] {
          background: linear-gradient(to right, #00C6FF, #0072FF);
        }

        #categoryTabs .tab-button[data-category="education"],
        #mobileCategoryTabs .tab-button[data-category="education"] {
          background: linear-gradient(to right, #06B6D4, #10B981);
        }

        #categoryTabs .tab-button[data-category="technology"],
        #mobileCategoryTabs .tab-button[data-category="technology"] {
          background: linear-gradient(to right, #FFD166, #FFB703);
          color: #0a0a0a;
        }

        #categoryTabs .tab-button[data-category="scientific"],
        #mobileCategoryTabs .tab-button[data-category="scientific"] {
          background: linear-gradient(to right, #667eea, #764ba2);
        }
        
        #categoryTabs .tab-button[data-category="business"],
        #mobileCategoryTabs .tab-button[data-category="business"] {
          background: linear-gradient(to right, #f7971e, #ffd200);
          color: #1a1f3a;
        }
        
        /* --- NEW STYLES: Calculator Modal --- */
        .modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(10, 14, 39, 0.7);
          backdrop-filter: blur(8px);
          z-index: 2000;
          display: flex;
          align-items: center;
          justify-content: center;
          opacity: 0;
          visibility: hidden;
          transition: opacity var(--transition-normal), visibility var(--transition-normal);
        }
        .modal-overlay.visible {
          opacity: 1;
          visibility: visible;
        }
        .modal-content {
          background: var(--bg-secondary);
          padding: var(--space-xl);
          border-radius: 16px;
          width: 90%;
          max-width: 500px;
          max-height: 90vh;
          overflow-y: auto;
          box-shadow: var(--shadow-xl);
          transform: scale(0.95);
          transition: transform var(--transition-normal);
        }
        .modal-overlay.visible .modal-content {
          transform: scale(1);
        }
        .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: var(--space-lg);
          padding-bottom: var(--space-md);
          border-bottom: 1px solid var(--bg-tertiary);
        }
        .modal-title {
          font-family: var(--font-accent);
          font-size: 1.75rem;
          font-weight: 700;
          background: var(--gradient-ai);
          background-clip: text;
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          color: transparent;
        }
        .modal-close-btn {
          background: var(--bg-tertiary);
          border: none;
          color: var(--text-secondary);
          width: 44px;
          height: 44px;
          border-radius: 50%;
          font-size: 1.25rem;
          cursor: pointer;
          transition: all var(--transition-fast);
          display: flex;
          align-items: center;
          justify-content: center;
        }
        .modal-close-btn:hover {
          background: var(--accent-pink);
          color: white;
          transform: rotate(90deg);
        }
        .calculator-form .form-group {
          margin-bottom: var(--space-lg);
        }
        .calculator-form label {
          display: block;
          font-family: var(--font-secondary);
          font-weight: 600;
          color: var(--text-secondary);
          margin-bottom: var(--space-sm);
        }
        .calculator-form input, .calculator-form select {
          width: 100%;
          padding: var(--space-md);
          border: 1px solid var(--bg-tertiary);
          background: var(--bg-primary);
          border-radius: 8px;
          color: var(--text-primary);
          font-size: 1rem;
          transition: border-color var(--transition-fast);
        }
        .calculator-form input:focus, .calculator-form select:focus {
          outline: none;
          border-color: var(--accent-blue);
        }
        .calculator-result-area {
          margin-top: var(--space-xl);
          padding: var(--space-lg);
          background: var(--bg-tertiary);
          border-radius: 12px;
          text-align: center;
        }
        .result-title {
          font-family: var(--font-secondary);
          color: var(--text-muted);
          font-size: 0.875rem;
          text-transform: uppercase;
          letter-spacing: 1px;
        }
        .result-value {
          font-family: var(--font-accent);
          font-size: 2.5rem;
          font-weight: 800;
          margin: var(--space-sm) 0;
          color: var(--text-primary);
          word-wrap: break-word;
        }
        .result-interpretation {
          color: var(--text-secondary);
          font-size: 1rem;
          line-height: 1.5;
        }
        
        /* === Loading Animations === */
        
        /* Modal Loading Animation */
        .modal-overlay {
          animation: fadeIn 0.3s ease-out;
        }
        
        .modal-content {
          animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }
        
        @keyframes fadeIn {
          from {
            opacity: 0;
            backdrop-filter: blur(0px);
          }
          to {
            opacity: 1;
            backdrop-filter: blur(8px);
          }
        }
        
        @keyframes slideUp {
          from {
            transform: translateY(30px) scale(0.95);
            opacity: 0;
          }
          to {
            transform: translateY(0) scale(1);
            opacity: 1;
          }
        }
        
        /* Skeleton Loading for Calculator Content */
        .skeleton-loader {
          background: linear-gradient(
            90deg,
            var(--bg-tertiary) 25%,
            var(--bg-secondary) 50%,
            var(--bg-tertiary) 75%
          );
          background-size: 200% 100%;
          animation: shimmer 1.5s infinite;
          border-radius: 8px;
          height: 20px;
          margin-bottom: 16px;
        }
        
        .skeleton-loader.input {
          height: 48px;
          margin-bottom: 24px;
        }
        
        .skeleton-loader.result {
          height: 120px;
          margin-top: 32px;
        }
        
        @keyframes shimmer {
          0% {
            background-position: -200% 0;
          }
          100% {
            background-position: 200% 0;
          }
        }
        
        /* Calculating Spinner */
        .calculating-spinner {
          display: inline-flex;
          align-items: center;
          gap: 8px;
          color: var(--accent-blue);
          font-size: 0.875rem;
          font-weight: 600;
          animation: pulse 1.5s infinite;
        }
        
        .calculating-spinner::before {
          content: '';
          display: inline-block;
          width: 16px;
          height: 16px;
          border: 2px solid var(--accent-blue);
          border-top-color: transparent;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
        }
        
        @keyframes spin {
          to {
            transform: rotate(360deg);
          }
        }
        
        @keyframes pulse {
          0%, 100% {
            opacity: 1;
          }
          50% {
            opacity: 0.5;
          }
        }
        
        /* Calculator Cards Stagger Animation */
        .tool-card {
          animation: fadeInUp 0.5s ease-out backwards;
        }
        
        .tool-card:nth-child(1) { animation-delay: 0.05s; }
        .tool-card:nth-child(2) { animation-delay: 0.1s; }
        .tool-card:nth-child(3) { animation-delay: 0.15s; }
        .tool-card:nth-child(4) { animation-delay: 0.2s; }
        .tool-card:nth-child(5) { animation-delay: 0.25s; }
        .tool-card:nth-child(6) { animation-delay: 0.3s; }
        .tool-card:nth-child(7) { animation-delay: 0.35s; }
        .tool-card:nth-child(8) { animation-delay: 0.4s; }
        .tool-card:nth-child(9) { animation-delay: 0.45s; }
        .tool-card:nth-child(10) { animation-delay: 0.5s; }
        .tool-card:nth-child(11) { animation-delay: 0.55s; }
        .tool-card:nth-child(12) { animation-delay: 0.6s; }
        
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        
        /* Category Tab Transitions */
        .category-tabs {
          transition: all 0.3s ease-out;
        }
        
        .tab-button {
          transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }
        
        .tab-button:active {
          transform: scale(0.95);
        }
        
        /* Tools Grid Fade Transition */
        .tools-grid {
          animation: fadeIn 0.4s ease-out;
        }
        
        /* Page Load Animation */
        @keyframes pageLoad {
          from {
            opacity: 0;
            transform: translateY(10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        
        .navbar {
          animation: pageLoad 0.5s ease-out;
        }
        
        .hero-section {
          animation: pageLoad 0.6s ease-out 0.1s backwards;
        }
        
        .floating-search {
          animation: pageLoad 0.7s ease-out 0.2s backwards;
        }
        
        /* Loading State for Result Values */
        .result-value.loading {
          position: relative;
          color: transparent;
          background: linear-gradient(
            90deg,
            var(--bg-tertiary) 25%,
            var(--accent-blue) 50%,
            var(--bg-tertiary) 75%
          );
          background-size: 200% 100%;
          background-clip: text;
          -webkit-background-clip: text;
          animation: shimmer 1.5s infinite;
        }
        
        /* Smooth Transitions for All Interactive Elements */
        button, a, input, select {
          transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }
        
        /* Reduce motion for users who prefer it */
        @media (prefers-reduced-motion: reduce) {
          *,
          *::before,
          *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
          }
        }
        
        /* === Accessibility Improvements === */
        
        /* Skip to content link - visible on focus for keyboard users */
        .skip-to-content {
          position: absolute;
          top: -50px;
          left: 20px;
          z-index: 10000;
          background: var(--accent-blue);
          color: white;
          padding: 12px 24px;
          border-radius: 8px;
          text-decoration: none;
          font-weight: 700;
          font-family: var(--font-secondary);
          box-shadow: var(--shadow-xl);
          transition: top 0.3s ease-out;
        }
        
        .skip-to-content:focus {
          top: 20px;
          outline: 3px solid var(--accent-pink);
          outline-offset: 2px;
        }
        
        /* Enhanced focus indicators for keyboard navigation */
        button:focus-visible,
        a:focus-visible,
        input:focus-visible,
        select:focus-visible,
        .tab-button:focus-visible,
        .tool-card:focus-visible {
          outline: 3px solid var(--accent-blue);
          outline-offset: 2px;
          box-shadow: 0 0 0 4px rgba(0, 212, 255, 0.2);
        }
        
        /* Remove default focus outline when not using keyboard */
        button:focus:not(:focus-visible),
        a:focus:not(:focus-visible),
        input:focus:not(:focus-visible) {
          outline: none;
        }
        
        /* Make interactive elements keyboard accessible */
        .tool-card {
          cursor: pointer;
          position: relative;
        }
        
        .tool-card:focus {
          z-index: 1;
        }
        
        /* Screen reader only text */
        .sr-only {
          position: absolute;
          width: 1px;
          height: 1px;
          padding: 0;
          margin: -1px;
          overflow: hidden;
          clip: rect(0, 0, 0, 0);
          white-space: nowrap;
          border: 0;
        }
        
        /* Ensure decorative icons are hidden from screen readers */
        i[aria-hidden="true"] {
          pointer-events: none;
        }
        
        /* High contrast mode support */
        @media (prefers-contrast: high) {
          button, 
          a, 
          .tool-card {
            border: 2px solid currentColor;
          }
        }

        /* ========== Welcome Tour Styles ========== */
        .welcome-tour-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.4s ease;
            padding: 20px;
        }
        
        .welcome-tour-modal {
            background: linear-gradient(135deg, var(--bg-primary), var(--bg-secondary));
            border: 2px solid var(--glass-border);
            border-radius: 24px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 212, 255, 0.3);
            animation: slideUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .welcome-tour-header {
            padding: 30px;
            text-align: center;
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(139, 92, 246, 0.1));
            border-bottom: 2px solid var(--glass-border);
        }
        
        .welcome-tour-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            background: linear-gradient(135deg, #00D4FF, #8B5CF6);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            animation: bounce 1s infinite;
        }
        
        .welcome-tour-header h2 {
            color: var(--text-primary);
            font-size: 1.8rem;
            margin: 0 0 10px 0;
            font-weight: 700;
        }
        
        .welcome-tour-header p {
            color: var(--text-secondary);
            font-size: 1rem;
            margin: 0;
        }
        
        .welcome-tour-content {
            padding: 30px;
        }
        
        .tour-step {
            display: none;
            animation: fadeInSlide 0.4s ease;
        }
        
        .tour-step.active {
            display: block;
        }
        
        .tour-step-number {
            display: inline-block;
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #00D4FF, #8B5CF6);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 36px;
            font-weight: 700;
            margin-bottom: 15px;
        }
        
        .tour-step h3 {
            color: var(--text-primary);
            font-size: 1.4rem;
            margin: 0 0 15px 0;
            font-weight: 700;
        }
        
        .tour-step p {
            color: var(--text-secondary);
            font-size: 1rem;
            line-height: 1.6;
            margin: 0 0 20px 0;
        }
        
        .tour-feature-list {
            list-style: none;
            padding: 0;
            margin: 20px 0;
        }
        
        .tour-feature-list li {
            padding: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--text-primary);
            background: var(--bg-secondary);
            border-radius: 8px;
            margin-bottom: 8px;
        }
        
        .tour-feature-list li i {
            color: var(--accent-blue);
            font-size: 1.2rem;
            width: 24px;
        }
        
        .tour-progress {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin: 25px 0;
        }
        
        .tour-progress-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--glass-border);
            transition: all 0.3s ease;
        }
        
        .tour-progress-dot.active {
            background: linear-gradient(135deg, #00D4FF, #8B5CF6);
            width: 30px;
            border-radius: 5px;
        }
        
        .welcome-tour-footer {
            padding: 20px 30px;
            background: var(--bg-secondary);
            border-top: 1px solid var(--glass-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
        }
        
        .tour-btn {
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tour-btn-skip {
            background: transparent;
            color: var(--text-secondary);
            border: 2px solid var(--glass-border);
        }
        
        .tour-btn-skip:hover {
            background: var(--glass-bg);
            border-color: var(--accent-blue);
            color: var(--text-primary);
        }
        
        .tour-btn-next {
            background: linear-gradient(135deg, #00D4FF, #8B5CF6);
            color: white;
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.3);
        }
        
        .tour-btn-next:hover {
            box-shadow: 0 6px 20px rgba(0, 212, 255, 0.5);
            transform: translateY(-2px);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInSlide {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* ========== Toast Notification System ========== */
        .toast-container {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 12px;
            pointer-events: none;
        }
        
        .toast {
            background: var(--bg-primary);
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            padding: 16px 24px;
            min-width: 280px;
            max-width: 400px;
            box-shadow: var(--shadow-xl);
            display: flex;
            align-items: center;
            gap: 12px;
            opacity: 0;
            transform: translateX(400px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: auto;
            backdrop-filter: blur(20px);
        }
        
        .toast.show {
            opacity: 1;
            transform: translateX(0);
        }
        
        .toast-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        
        .toast-message {
            flex: 1;
            color: var(--text-primary);
            font-family: var(--font-secondary);
            font-weight: 500;
            font-size: 0.95rem;
            line-height: 1.4;
        }
        
        .toast-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 4px;
            border-radius: 50%;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            flex-shrink: 0;
        }
        
        .toast-close:hover {
            background: var(--glass-bg);
            color: var(--text-primary);
            transform: rotate(90deg);
        }
        
        /* Toast Types */
        .toast.toast-success {
            border-color: #00FF88;
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1), rgba(34, 211, 238, 0.05));
        }
        .toast.toast-success .toast-icon { color: #00FF88; }
        
        .toast.toast-error {
            border-color: #FF006E;
            background: linear-gradient(135deg, rgba(255, 0, 110, 0.1), rgba(255, 106, 136, 0.05));
        }
        .toast.toast-error .toast-icon { color: #FF006E; }
        
        .toast.toast-warning {
            border-color: #FFB703;
            background: linear-gradient(135deg, rgba(255, 183, 3, 0.1), rgba(255, 154, 86, 0.05));
        }
        .toast.toast-warning .toast-icon { color: #FFB703; }
        
        .toast.toast-info {
            border-color: var(--accent-blue);
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(139, 92, 246, 0.05));
        }
        .toast.toast-info .toast-icon { color: var(--accent-blue); }
        
        @media (max-width: 768px) {
            .toast-container {
                top: 80px;
                right: 16px;
                left: 16px;
            }
            .toast {
                min-width: auto;
                max-width: 100%;
            }
        }

        /* ========== Tooltip Styles ========== */
        .tooltip-wrapper {
            position: relative;
            display: inline-block;
            cursor: help;
        }
        
        .tooltip-icon {
            color: var(--accent-blue);
            font-size: 0.9rem;
            margin-left: 5px;
            transition: all 0.3s ease;
        }
        
        .tooltip-icon:hover {
            color: var(--accent-purple);
            transform: scale(1.2);
        }
        
        .tooltip-content {
            position: absolute;
            bottom: calc(100% + 10px);
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, var(--bg-primary), var(--bg-secondary));
            border: 2px solid var(--accent-blue);
            border-radius: 12px;
            padding: 12px 16px;
            min-width: 200px;
            max-width: 280px;
            box-shadow: 0 8px 24px rgba(0, 212, 255, 0.3);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
            pointer-events: none;
        }
        
        .tooltip-content::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: var(--accent-blue);
        }
        
        .tooltip-wrapper:hover .tooltip-content {
            opacity: 1;
            visibility: visible;
            bottom: calc(100% + 15px);
        }
        
        .tooltip-content strong {
            color: var(--accent-blue);
            display: block;
            margin-bottom: 6px;
            font-size: 0.9rem;
        }
        
        .tooltip-content p {
            color: var(--text-secondary);
            font-size: 0.85rem;
            line-height: 1.4;
            margin: 0;
        }

        /* ========== Sample Data Button ========== */
        .try-example-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(139, 92, 246, 0.1));
            border: 2px solid rgba(0, 212, 255, 0.3);
            border-radius: 8px;
            color: var(--accent-blue);
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 10px;
        }
        
        .try-example-btn:hover {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.2), rgba(139, 92, 246, 0.2));
            border-color: var(--accent-blue);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.3);
        }

        /* ========== Enhanced Result Display ========== */
        .result-container {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-primary));
            border: 2px solid var(--glass-border);
            border-radius: 16px;
            padding: 24px;
            margin-top: 24px;
            animation: slideUp 0.5s ease;
        }
        
        .result-value-box {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(139, 92, 246, 0.1));
            border-radius: 12px;
            margin-bottom: 20px;
        }
        
        .result-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .result-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.95rem;
            margin-top: 12px;
        }
        
        .result-status.healthy {
            background: rgba(67, 233, 123, 0.2);
            color: #43E97B;
            border: 2px solid #43E97B;
        }
        
        .result-status.warning {
            background: rgba(255, 210, 111, 0.2);
            color: #FFD26F;
            border: 2px solid #FFD26F;
        }
        
        .result-status.danger {
            background: rgba(255, 107, 110, 0.2);
            color: #FF6B6E;
            border: 2px solid #FF6B6E;
        }
        
        .result-explanation {
            background: var(--bg-primary);
            border-left: 4px solid var(--accent-blue);
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
        }
        
        .result-explanation h4 {
            color: var(--text-primary);
            font-size: 1rem;
            margin: 0 0 8px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .result-explanation p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.6;
            margin: 0;
        }
        
        .result-tips {
            background: linear-gradient(135deg, rgba(255, 210, 111, 0.1), rgba(255, 154, 86, 0.1));
            border: 2px solid rgba(255, 210, 111, 0.3);
            border-radius: 12px;
            padding: 14px;
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }
        
        .result-tips i {
            color: #FFD26F;
            font-size: 1.2rem;
            flex-shrink: 0;
        }
        
        .result-tips-content h5 {
            color: var(--text-primary);
            font-size: 0.95rem;
            margin: 0 0 6px 0;
            font-weight: 600;
        }
        
        .result-tips-content p {
            color: var(--text-secondary);
            font-size: 0.85rem;
            line-height: 1.5;
            margin: 0;
        }

        /* ========== Input Validation Styles ========== */
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-label {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
            color: var(--text-primary);
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .input-field {
            width: 100%;
            padding: 14px 16px;
            background: var(--bg-secondary);
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 4px rgba(0, 212, 255, 0.15);
            transform: translateY(-2px);
        }
        
        .input-field.valid {
            border-color: #43E97B;
            background: rgba(67, 233, 123, 0.05);
        }
        
        .input-field.invalid {
            border-color: #FF6B6E;
            background: rgba(255, 107, 110, 0.05);
            animation: shake 0.3s ease;
        }
        
        .input-hint {
            display: block;
            margin-top: 6px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .input-error {
            display: none;
            margin-top: 8px;
            padding: 8px 12px;
            background: rgba(255, 107, 110, 0.1);
            border: 1px solid #FF6B6E;
            border-radius: 8px;
            color: #FF6B6E;
            font-size: 0.85rem;
        }
        
        .input-error.show {
            display: flex;
            align-items: center;
            gap: 8px;
            animation: fadeInSlide 0.3s ease;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* ========== Share/Save Action Buttons ========== */
        .result-actions {
            display: flex;
            gap: 12px;
            margin-top: 24px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            flex: 1;
            min-width: 140px;
            padding: 12px 20px;
            border-radius: 12px;
            border: none;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }
        
        .action-btn.download {
            background: linear-gradient(135deg, #43E97B, #38F9D7);
        }
        
        .action-btn.share {
            background: linear-gradient(135deg, #00D4FF, #8B5CF6);
        }
        
        .action-btn.save {
            background: linear-gradient(135deg, #FFD26F, #FF9A56);
        }
        
        .action-btn.print {
            background: linear-gradient(135deg, #667EEA, #764BA2);
        }
        
        /* Share Modal */
        .share-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            z-index: 10001;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }
        
        .share-modal {
            background: var(--bg-primary);
            border: 2px solid var(--glass-border);
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: slideUp 0.4s ease;
        }
        
        .share-modal h3 {
            color: var(--text-primary);
            margin: 0 0 20px 0;
            font-size: 1.3rem;
            text-align: center;
        }
        
        .share-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        
        .share-option {
            padding: 16px;
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--bg-secondary);
        }
        
        .share-option:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.2);
            border-color: var(--accent-blue);
        }
        
        .share-option i {
            font-size: 2rem;
            margin-bottom: 8px;
            display: block;
        }
        
        .share-option.whatsapp i { color: #25D366; }
        .share-option.facebook i { color: #1877F2; }
        .share-option.twitter i { color: #1DA1F2; }
        .share-option.linkedin i { color: #0A66C2; }
        
        .share-option span {
            font-size: 0.85rem;
            color: var(--text-secondary);
            font-weight: 600;
            display: block;
        }
        
        /* ========== Persistent Search Bar (Mobile) ========== */
        .mobile-search-header {
            position: sticky;
            top: 0;
            z-index: 100;
            background: var(--bg-primary);
            padding: 16px;
            border-bottom: 2px solid var(--glass-border);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .mobile-search-container {
            position: relative;
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.05) 0%, rgba(139, 92, 246, 0.05) 100%);
            border-bottom: 2px solid var(--glass-border);
        }
        
        .mobile-search-back-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, #667EEA, #764BA2);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            flex-shrink: 0;
        }
        
        .mobile-search-back-btn:active {
            transform: scale(0.92);
            box-shadow: 0 2px 6px rgba(102, 126, 234, 0.3);
        }
        
        .mobile-search-input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
            flex: 1;
        }
        
        .mobile-search-main-input {
            width: 100%;
            padding: 14px 48px 14px 48px;
            background: var(--bg-secondary);
            border: 2px solid var(--glass-border);
            border-radius: 16px;
            color: var(--text-primary);
            font-size: 1rem;
            font-family: var(--font-secondary);
            transition: all 0.3s ease;
        }
        
        .mobile-search-main-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 4px rgba(0, 212, 255, 0.15);
            background: var(--bg-primary);
        }
        
        .mobile-search-main-input::placeholder {
            color: var(--text-secondary);
        }
        
        .mobile-search-icon-left {
            position: absolute;
            left: 16px;
            color: var(--accent-blue);
            font-size: 1.2rem;
            pointer-events: none;
            transition: all 0.3s ease;
        }
        
        .mobile-search-main-input:focus + .mobile-search-icon-left {
            transform: scale(1.15) rotate(15deg);
        }
        
        .mobile-search-clear-btn {
            position: absolute;
            right: 12px;
            width: 32px;
            height: 32px;
            background: rgba(255, 107, 110, 0.1);
            color: #FF6A6E;
            border: none;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .mobile-search-clear-btn.show {
            display: flex;
        }
        
        .mobile-search-clear-btn:hover {
            background: rgba(255, 107, 110, 0.2);
            transform: scale(1.15) rotate(90deg);
        }
        
        .mobile-search-clear-btn:active {
            transform: scale(0.95) rotate(90deg);
        }
        
        /* Search Autocomplete Dropdown */
        .mobile-search-suggestions {
            position: absolute;
            top: calc(100% + 8px);
            left: 0;
            right: 0;
            background: var(--bg-primary);
            border: 2px solid var(--glass-border);
            border-radius: 16px;
            max-height: 300px;
            overflow-y: auto;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
            display: none;
            z-index: 1000;
        }
        
        .mobile-search-suggestions.show {
            display: block;
            animation: slideDown 0.3s ease;
        }
        
        .search-suggestion-item {
            padding: 14px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-bottom: 1px solid var(--glass-border);
        }
        
        .search-suggestion-item:last-child {
            border-bottom: none;
        }
        
        .search-suggestion-item:hover {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(139, 92, 246, 0.1));
            padding-left: 20px;
        }
        
        .search-suggestion-item:active {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.2), rgba(139, 92, 246, 0.2));
        }
        
        .search-suggestion-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            flex-shrink: 0;
        }
        
        .search-suggestion-icon.financial {
            background: linear-gradient(135deg, #667EEA, #764BA2);
        }
        
        .search-suggestion-icon.health {
            background: linear-gradient(135deg, #FF6B6B, #FF8E53);
        }
        
        .search-suggestion-icon.math {
            background: linear-gradient(135deg, #48C774, #7ED56F);
        }
        
        .search-suggestion-icon.datetime {
            background: linear-gradient(135deg, #FF9A56, #FFCC70);
        }
        
        .search-suggestion-info {
            flex: 1;
        }
        
        .search-suggestion-title {
            font-weight: 700;
            font-size: 0.95rem;
            color: var(--text-primary);
            margin: 0 0 4px 0;
        }
        
        .search-suggestion-desc {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin: 0;
        }
        
        .search-suggestion-arrow {
            color: var(--accent-blue);
            font-size: 1rem;
        }
        
        .search-no-results {
            padding: 24px;
            text-align: center;
            color: var(--text-secondary);
        }
        
        .search-no-results i {
            font-size: 2.5rem;
            color: var(--text-muted);
            margin-bottom: 12px;
            display: block;
        }
        
        .search-no-results p {
            margin: 0;
            font-size: 0.9rem;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ========== Popular Calculators Section ========== */
        .mobile-popular-section {
            padding: 20px 16px;
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.05), rgba(139, 92, 246, 0.05));
            border-bottom: 2px solid var(--glass-border);
        }
        
        .popular-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }
        
        .popular-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .popular-title i {
            color: #FF6B6B;
            font-size: 1.3rem;
            animation: pulse 2s infinite;
        }
        
        .popular-badge {
            background: linear-gradient(135deg, #FF6B6B, #FF8E53);
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .popular-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .popular-card {
            background: var(--bg-primary);
            border: 2px solid var(--glass-border);
            border-radius: 16px;
            padding: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            will-change: transform;
            transform: translateZ(0);
        }
        
        .popular-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 212, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }
        
        .popular-card:hover::before {
            left: 100%;
        }
        
        .popular-card:hover {
            transform: translateY(-6px) scale(1.02);
            border-color: var(--accent-blue);
            box-shadow: 0 8px 24px rgba(0, 212, 255, 0.3);
        }
        
        .popular-card:active {
            transform: translateY(-3px) scale(0.98);
        }
        
        .popular-card-icon {
            width: 56px;
            height: 56px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }
        
        .popular-card:hover .popular-card-icon {
            transform: scale(1.15) rotate(5deg);
        }
        
        /* Individual card gradients */
        .popular-card:nth-child(1) .popular-card-icon {
            background: linear-gradient(135deg, #667EEA, #764BA2);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .popular-card:nth-child(2) .popular-card-icon {
            background: linear-gradient(135deg, #FF6B6B, #FF8E53);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
        }
        
        .popular-card:nth-child(3) .popular-card-icon {
            background: linear-gradient(135deg, #48C774, #7ED56F);
            box-shadow: 0 4px 12px rgba(72, 199, 116, 0.4);
        }
        
        .popular-card:nth-child(4) .popular-card-icon {
            background: linear-gradient(135deg, #00D4FF, #8B5CF6);
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.4);
        }
        
        .popular-card:nth-child(5) .popular-card-icon {
            background: linear-gradient(135deg, #FFD26F, #FF9A56);
            box-shadow: 0 4px 12px rgba(255, 210, 111, 0.4);
        }
        
        .popular-card:nth-child(6) .popular-card-icon {
            background: linear-gradient(135deg, #A29BFE, #6C5CE7);
            box-shadow: 0 4px 12px rgba(162, 155, 254, 0.4);
        }
        
        .popular-card-title {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0 0 4px 0;
            line-height: 1.3;
        }
        
        .popular-card-subtitle {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin: 0;
        }
        
        .popular-card-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: linear-gradient(135deg, #FF6B6B, #FF8E53);
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.65rem;
            font-weight: 700;
        }
        
        .view-all-popular {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(139, 92, 246, 0.1));
            border: 2px solid rgba(0, 212, 255, 0.3);
            border-radius: 12px;
            color: var(--accent-blue);
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .view-all-popular:hover {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.2), rgba(139, 92, 246, 0.2));
            border-color: var(--accent-blue);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.3);
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.1);
                opacity: 0.8;
            }
        }

        /* ========== Desktop Recent Section ========== */
        .recent-section {
            padding: var(--space-2xl) 0 var(--space-xl) 0;
            background: linear-gradient(180deg, var(--bg-secondary) 0%, var(--bg-primary) 100%);
        }
        
        .recent-section .section-header {
            margin-bottom: var(--space-xl);
        }
        
        .recent-section .section-title i {
            animation: pulse 2s infinite;
        }
        
        .recent-grid {
            display: flex;
            gap: var(--space-md);
            overflow-x: auto;
            padding-bottom: var(--space-md);
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }
        
        .recent-grid::-webkit-scrollbar {
            height: 6px;
        }
        
        .recent-grid::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: 3px;
        }
        
        .recent-grid::-webkit-scrollbar-thumb {
            background: var(--accent-purple);
            border-radius: 3px;
        }
        
        .recent-grid::-webkit-scrollbar-thumb:hover {
            background: var(--accent-blue);
        }
        
        .recent-card {
            min-width: 200px;
            max-width: 200px;
            background: var(--bg-primary);
            border: 2px solid var(--glass-border);
            border-radius: 14px;
            padding: var(--space-lg);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            flex-shrink: 0;
        }
        
        .recent-card:hover {
            transform: translateY(-6px);
            border-color: var(--accent-purple);
            box-shadow: 0 8px 24px rgba(139, 92, 246, 0.3);
        }
        
        .recent-card-icon {
            width: 56px;
            height: 56px;
            border-radius: 14px;
            background: linear-gradient(135deg, #8B5CF6, #6C5CE7);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            margin-bottom: 12px;
            transition: all 0.3s ease;
        }
        
        .recent-card:hover .recent-card-icon {
            transform: scale(1.1) rotate(5deg);
        }
        
        .recent-card-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0 0 6px 0;
            line-height: 1.3;
        }
        
        .recent-card-time {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin: 0;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .recent-section {
                display: none; /* Hide on mobile, shown in navigation */
            }
        }

        /* ========== Desktop Popular Section ========== */
        .popular-section {
            padding: var(--space-3xl) 0 var(--space-4xl) 0;
            background: linear-gradient(180deg, var(--bg-primary) 0%, var(--bg-secondary) 50%, var(--bg-primary) 100%);
            position: relative;
            overflow: hidden;
            display: block;
            visibility: visible;
        }
        
        .popular-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent 0%, var(--accent-cyan) 50%, transparent 100%);
            opacity: 0.5;
        }
        
        .popular-section .section-header {
            margin-bottom: var(--space-3xl);
            padding: 0 var(--space-lg);
        }
        
        .popular-section .section-title {
            font-size: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-md);
            margin-bottom: var(--space-md);
        }
        
        .popular-section .section-title i {
            animation: pulse 2s infinite;
            filter: drop-shadow(0 0 20px rgba(255, 107, 107, 0.6));
        }
        
        .popular-section .section-description {
            font-size: 1.1rem;
            color: var(--text-secondary);
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .popular-section .popular-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--space-xl);
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 var(--space-lg);
        }
        
        .popular-section .popular-card {
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            border: 2px solid transparent;
            border-radius: 20px;
            padding: var(--space-xl) var(--space-lg);
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            animation: slideInFromLeft 0.5s ease-out forwards;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            backdrop-filter: blur(10px);
        }
        
        .popular-section .popular-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 212, 255, 0.15), transparent);
            transition: left 0.6s ease;
        }
        
        .popular-section .popular-card::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 20px;
            padding: 2px;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: exclude;
            opacity: 0;
            transition: opacity 0.4s ease;
        }
        
        .popular-section .popular-card:hover::before {
            left: 100%;
        }
        
        .popular-section .popular-card:hover::after {
            opacity: 1;
        }
        
        .popular-section .popular-card:hover {
            transform: translateY(-12px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 212, 255, 0.25), 0 0 60px rgba(139, 92, 246, 0.15);
            background: linear-gradient(135deg, var(--bg-primary) 0%, rgba(0, 212, 255, 0.05) 100%);
        }
        
        .popular-section .popular-card-icon {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            margin-bottom: var(--space-lg);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
        }
        
        .popular-section .popular-card:hover .popular-card-icon {
            transform: scale(1.15) rotate(-5deg);
            box-shadow: 0 12px 32px rgba(0, 212, 255, 0.3);
        }
        
        .popular-section .popular-card-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0 0 var(--space-sm) 0;
            line-height: 1.3;
            letter-spacing: -0.02em;
        }
        
        .popular-section .popular-card-subtitle {
            font-size: 0.95rem;
            color: var(--text-secondary);
            margin: 0 0 var(--space-md) 0;
            line-height: 1.5;
        }
        
        .popular-section .popular-card-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            background: linear-gradient(135deg, #FF6B6B, #FF8E53);
            color: white;
            padding: 4px 10px;
            border-radius: 10px;
            font-size: 0.75rem;
            font-weight: 700;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .popular-section {
                display: none; /* Hide on mobile, shown in navigation */
            }
        }

        /* ========== Recent Calculators Section ========== */
        .mobile-recent-section {
            padding: 16px;
            background: var(--bg-primary);
            border-bottom: 2px solid var(--glass-border);
        }
        
        .recent-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 14px;
        }
        
        .recent-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .recent-title i {
            color: var(--accent-purple);
            font-size: 1.1rem;
        }
        
        .recent-count {
            background: rgba(139, 92, 246, 0.15);
            color: var(--accent-purple);
            padding: 2px 8px;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 700;
        }
        
        .recent-items {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .recent-items::-webkit-scrollbar {
            display: none;
        }
        
        .recent-item {
            min-width: 140px;
            padding: 12px;
            background: var(--bg-secondary);
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            scroll-snap-align: start;
        }
        
        .recent-item:hover {
            border-color: var(--accent-purple);
            transform: translateY(-4px);
            box-shadow: 0 6px 16px rgba(139, 92, 246, 0.3);
        }
        
        .recent-item-icon {
            width: 44px;
            height: 44px;
            border-radius: 10px;
            background: linear-gradient(135deg, #A29BFE, #6C5CE7);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            margin-bottom: 8px;
        }
        
        .recent-item-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }
        
        .recent-item-time {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        /* ========== Collapsible Categories Section ========== */
        .mobile-categories-section {
            padding: 16px;
            background: var(--bg-primary);
        }
        
        .categories-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
            padding: 12px;
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.05), rgba(139, 92, 246, 0.05));
            border-radius: 12px;
        }
        
        .categories-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .categories-title i {
            color: var(--accent-blue);
        }
        
        .categories-toggle {
            background: none;
            border: none;
            color: var(--accent-blue);
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px;
        }
        
        .categories-toggle.collapsed {
            transform: rotate(180deg);
        }
        
        .categories-list {
            display: grid;
            gap: 10px;
            max-height: 2000px;
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease;
            opacity: 1;
        }
        
        .categories-list.collapsed {
            max-height: 0;
            opacity: 0;
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.2s ease;
        }
        
        .category-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.2), rgba(139, 92, 246, 0.2));
            color: var(--accent-blue);
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 700;
        }
        
        .mobile-category-btn {
            position: relative;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .welcome-tour-modal {
                max-width: 95%;
                margin: 10px;
            }
            
            .result-value {
                font-size: 2rem;
            }
            
            .result-actions {
                flex-direction: column;
            }
            
            .action-btn {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Welcome Tour Modal -->
    <div id="welcomeTour" class="welcome-tour-overlay" style="display: none;">
        <div class="welcome-tour-modal">
            <div class="welcome-tour-header">
                <div class="welcome-tour-icon">
                    ðŸ§®
                </div>
                <h2>Welcome to Calculator Loop! ðŸŽ‰</h2>
                <p>Your Ultimate Calculator Suite - Let's get you started!</p>
            </div>
            
            <div class="welcome-tour-content">
                <!-- Step 1 -->
                <div class="tour-step active" data-step="1">
                    <span class="tour-step-number">1</span>
                    <h3>300+ Powerful Calculators</h3>
                    <p>From financial planning to health tracking, we've got every calculator you need in one place!</p>
                    <ul class="tour-feature-list">
                        <li><i class="fas fa-chart-line"></i> Financial & Investment Tools</li>
                        <li><i class="fas fa-heartbeat"></i> Health & Fitness Calculators</li>
                        <li><i class="fas fa-calculator"></i> Math & Science Tools</li>
                        <li><i class="fas fa-clock"></i> Date & Time Utilities</li>
                    </ul>
                </div>
                
                <!-- Step 2 -->
                <div class="tour-step" data-step="2">
                    <span class="tour-step-number">2</span>
                    <h3>Easy Navigation ðŸ§­</h3>
                    <p>Find exactly what you need in seconds!</p>
                    <ul class="tour-feature-list">
                        <li><i class="fas fa-search"></i> <strong>Search Bar:</strong> Type what you're looking for</li>
                        <li><i class="fas fa-th-large"></i> <strong>Categories:</strong> Browse by category</li>
                        <li><i class="fas fa-star"></i> <strong>Popular:</strong> See most-used calculators</li>
                    </ul>
                </div>
                
                <!-- Step 3 -->
                <div class="tour-step" data-step="3">
                    <span class="tour-step-number">3</span>
                    <h3>Smart Features âœ¨</h3>
                    <p>We make calculations easy and understandable!</p>
                    <ul class="tour-feature-list">
                        <li><i class="fas fa-lightbulb"></i> <strong>Try Example:</strong> Pre-filled data for quick testing</li>
                        <li><i class="fas fa-info-circle"></i> <strong>Tooltips:</strong> Hover on ? icons for explanations</li>
                        <li><i class="fas fa-check-circle"></i> <strong>Smart Validation:</strong> Real-time error checking</li>
                        <li><i class="fas fa-share-alt"></i> <strong>Share Results:</strong> Download or share easily</li>
                    </ul>
                </div>
                
                <!-- Step 4 -->
                <div class="tour-step" data-step="4">
                    <span class="tour-step-number">4</span>
                    <h3>You're All Set! ðŸš€</h3>
                    <p>Ready to start calculating? Here are some quick tips:</p>
                    <ul class="tour-feature-list">
                        <li><i class="fas fa-mobile-alt"></i> Works perfectly on mobile & desktop</li>
                        <li><i class="fas fa-moon"></i> Dark/Light mode for comfortable viewing</li>
                        <li><i class="fas fa-bookmark"></i> Bookmark your favorites</li>
                        <li><i class="fas fa-history"></i> Recent calculations saved automatically</li>
                    </ul>
                </div>
                
                <div class="tour-progress">
                    <div class="tour-progress-dot active"></div>
                    <div class="tour-progress-dot"></div>
                    <div class="tour-progress-dot"></div>
                    <div class="tour-progress-dot"></div>
                </div>
            </div>
            
            <div class="welcome-tour-footer">
                <button class="tour-btn tour-btn-skip" onclick="skipTour()">
                    Skip Tour
                </button>
                <button class="tour-btn tour-btn-next" onclick="nextTourStep()">
                    Next <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar" role="navigation" aria-label="Main navigation">
        <div class="nav-container">
      <div class="nav-logo">
        <h1 class="logo-text">Calculator Loop</h1>
        <span class="logo-tagline">Your All-in-One Calculator Suite</span>
      </div>
            
            <div class="nav-menu" id="navMenu" role="menubar" aria-label="Main menu">
        <a href="#home" class="nav-link active" role="menuitem" aria-current="page">Home</a>
        <a href="#faq" class="nav-link" role="menuitem">FAQ</a>
        <a href="#blog" class="nav-link" role="menuitem">Blog</a>
        <a href="#analytics" class="nav-link" role="menuitem" onclick="showAnalyticsDashboard(); return false;">Analytics</a>
        <a href="#about" class="nav-link" role="menuitem">About</a>
        <a href="#contact" class="nav-link" role="menuitem">Contact</a>
            </div>

            <div class="nav-search" role="search" aria-label="Search calculators">
                <div class="search-container">
                    <i class="fas fa-search search-icon" aria-hidden="true"></i>
                    <input type="text" placeholder="Search calculators..." class="search-input" id="searchInput" role="searchbox" aria-label="Search for calculators" aria-autocomplete="list" aria-controls="searchSuggestions" aria-expanded="false">
                    <button class="search-action" id="searchAction" aria-label="Search">
                        <i class="fas fa-search" aria-hidden="true"></i>
                    </button>
                    <button class="search-clear" id="searchClear" aria-label="Clear search">
                        <i class="fas fa-times" aria-hidden="true"></i>
                    </button>
                </div>
                <div class="search-suggestions" id="searchSuggestions" role="listbox" aria-label="Search suggestions"></div>
            </div>
            
            <div class="nav-controls">
                <button class="mobile-search-toggle" id="mobileSearchToggle" aria-label="Toggle search">
                    <i class="fas fa-search" aria-hidden="true"></i>
                </button>
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode" aria-pressed="false">
                    <i class="fas fa-moon" aria-hidden="true"></i>
                </button>
                <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Open mobile menu" aria-expanded="false" aria-controls="mobileMenu">
                    <span aria-hidden="true"></span>
                    <span aria-hidden="true"></span>
                    <span aria-hidden="true"></span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Skip to content link for accessibility -->
    <a href="#calculators" class="skip-to-content" aria-label="Skip to main content">Skip to calculators</a>

    <!-- Mobile Search Modal -->
    <div class="mobile-search-modal" id="mobileSearchModal">
        <div class="mobile-search-header">
            <button class="mobile-search-close" id="mobileSearchClose" aria-label="Close search">
                <i class="fas fa-times"></i>
            </button>
            <div class="mobile-search-input-container">
                <div class="search-container">
                    <i class="fas fa-search search-icon" aria-hidden="true"></i>
                    <input type="text" placeholder="Search calculators..." class="search-input" id="mobileSearchInput" role="searchbox" aria-label="Search for calculators">
                    <button class="search-clear" id="mobileSearchClear" aria-label="Clear search">
                        <i class="fas fa-times" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
        </div>
        <div class="search-suggestions" id="mobileSearchSuggestions" role="listbox" aria-label="Search suggestions"></div>
    </div>

    <!-- Floating Search Bar -->
    <div class="floating-search" id="floatingSearch" role="search" aria-label="Search calculators">
        <div class="search-container">
            <i class="fas fa-search search-icon" aria-hidden="true"></i>
            <input type="text" placeholder="Search calculators... (Press / or Ctrl+K)" class="search-input" id="searchInput" role="searchbox" aria-label="Search for calculators" aria-autocomplete="list" aria-controls="searchSuggestions" aria-expanded="false">
            <button class="search-action" id="searchAction" aria-label="Search">
                <i class="fas fa-search" aria-hidden="true"></i>
            </button>
            <button class="search-clear" id="searchClear" aria-label="Clear search">
                <i class="fas fa-times" aria-hidden="true"></i>
            </button>
        </div>
        <div class="search-suggestions" id="searchSuggestions" role="listbox" aria-label="Search suggestions"></div>
    </div>

    <!-- Main Content -->
    <main class="main-content" role="main">
        <!-- Hero Section -->
        <section class="hero" id="home" itemscope itemtype="https://schema.org/WebPageElement">
            <div class="hero-container">
                <div class="hero-content">
                    <h1 class="hero-title" itemprop="headline">
                        <span class="gradient-text">Intelligent Calculators</span>
                        for Every Need
                    </h1>
                    <p class="hero-description" itemprop="description">
                        Calculate EMI, SIP returns, BMI, GST, income tax & more with 300+ free online calculators. Fast, accurate & mobile-friendly. Perfect for financial planning, health tracking, and mathematical calculations. No signup required - start calculating now!
                    </p>
                    <a href="#calculators" class="hero-cta-button">
                        <i class="fas fa-rocket"></i>
                        Explore Calculators
                    </a>
                </div>
                
                <div class="hero-visual">
                    <div class="floating-cards">
                        <div class="feature-card card-1">
                            <i class="fas fa-home"></i>
                            <span>Mortgage Calculator</span>
                        </div>
                        <div class="feature-card card-2">
                            <i class="fas fa-heartbeat"></i>
                            <span>BMI Calculator</span>
                        </div>
                        <div class="feature-card card-3">
                            <i class="fas fa-calculator"></i>
                            <span>Scientific Calculator</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Recent Calculators Section -->
        <section class="recent-section" id="recent" style="display: none;">
            <div class="tools-container">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-history" style="color: #8B5CF6; margin-right: 12px;"></i>
                        Recently Used
                    </h2>
                    <p class="section-description">
                        Quick access to your recent calculations
                    </p>
                </div>

                <!-- Recent Grid -->
                <div class="recent-grid" id="recentGrid">
                    <!-- Recent calculators will be dynamically populated here -->
                </div>
            </div>
        </section>

        <!-- Popular Calculators Section -->
        <section class="popular-section" id="popular" itemscope itemtype="https://schema.org/ItemList">
            <div class="tools-container">
                <div class="section-header">
                    <h2 class="section-title" itemprop="name">
                        <i class="fas fa-fire" style="color: #ff6b6b; margin-right: 12px;"></i>
                        <span class="gradient-text">Popular</span> Calculators
                    </h2>
                    <p class="section-description" itemprop="description">
                        Most used calculators in 2025 - EMI, SIP, BMI, GST, Tax & more. Quick access to essential financial, health & math calculators.
                    </p>
                </div>

                <!-- Popular Grid -->
                <div class="popular-grid" id="popularGrid">
                    <!-- Popular Calculator Cards -->
                    <div class="popular-card" onclick="handleToolClick('emi-calculator')">
                        <div class="popular-card-icon" style="background: linear-gradient(135deg, #667EEA, #764BA2);">
                            ðŸ’°
                        </div>
                        <h3 class="popular-card-title">EMI Calculator</h3>
                        <p class="popular-card-subtitle">Loan Payments</p>
                        <span class="popular-card-badge">#1</span>
                    </div>
                    
                    <div class="popular-card" onclick="handleToolClick('bmi-calculator')">
                        <div class="popular-card-icon" style="background: linear-gradient(135deg, #FF6B6B, #FF8E53);">
                            âš–ï¸
                        </div>
                        <h3 class="popular-card-title">BMI Calculator</h3>
                        <p class="popular-card-subtitle">Body Mass</p>
                        <span class="popular-card-badge">#2</span>
                    </div>
                    
                    <div class="popular-card" onclick="handleToolClick('age-calculator')">
                        <div class="popular-card-icon" style="background: linear-gradient(135deg, #48C774, #7ED56F);">
                            ðŸŽ‚
                        </div>
                        <h3 class="popular-card-title">Age Calculator</h3>
                        <p class="popular-card-subtitle">Calculate Age</p>
                        <span class="popular-card-badge">#3</span>
                    </div>
                    
                    <div class="popular-card" onclick="handleToolClick('percentage-calculator')">
                        <div class="popular-card-icon" style="background: linear-gradient(135deg, #00D4FF, #8B5CF6);">
                            ðŸ“Š
                        </div>
                        <h3 class="popular-card-title">Percentage</h3>
                        <p class="popular-card-subtitle">% Calculator</p>
                        <span class="popular-card-badge">#4</span>
                    </div>
                    
                    <div class="popular-card" onclick="handleToolClick('gst-calculator')">
                        <div class="popular-card-icon" style="background: linear-gradient(135deg, #FFD26F, #FF9A56);">
                            ðŸ§¾
                        </div>
                        <h3 class="popular-card-title">GST Calculator</h3>
                        <p class="popular-card-subtitle">Tax Calculate</p>
                        <span class="popular-card-badge">#5</span>
                    </div>
                    
                    <div class="popular-card" onclick="handleToolClick('loan-calculator')">
                        <div class="popular-card-icon" style="background: linear-gradient(135deg, #A29BFE, #6C5CE7);">
                            ðŸ¦
                        </div>
                        <h3 class="popular-card-title">Loan Calculator</h3>
                        <p class="popular-card-subtitle">Loan Details</p>
                        <span class="popular-card-badge">#6</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Mobile CTA Section - Shows only on mobile -->
        <section class="mobile-cta-section">
            <div class="mobile-cta-content">
                <h2 class="mobile-cta-title">ðŸ§® Find Your Calculator</h2>
                <p class="mobile-cta-description">
                    Browse 300+ calculators organized by category. Tap the menu icon to explore all options.
                </p>
                <button class="mobile-explore-btn" id="mobileExploreBtn" onclick="document.getElementById('mobileMenuToggle').click();">
                    <i class="fas fa-compass"></i>
                    <span>Explore Categories</span>
                </button>
            </div>
        </section>

        <!-- Calculators Section -->
        <section class="tools-section" id="calculators" itemscope itemtype="https://schema.org/WebPageElement">
            <div class="tools-container">
                <div class="section-header">
                    <h2 class="section-title" itemprop="name">
                        <span class="gradient-text">300+</span> Smart Calculators
                    </h2>
                    <p class="section-description" itemprop="description">
                        Free online calculator tools organized by category. Find EMI, SIP, loan, mortgage, BMI, calorie, tax, GST, percentage & 300+ more calculators for financial planning, health metrics, math calculations, date-time conversions & everyday use.
                    </p>
                </div>

                <!-- Category Tabs -->
                <div class="category-tabs" id="categoryTabs">
                    <button class="tab-button active" data-category="all">
                        <i class="fas fa-th-large"></i>
                        All Calculators
                    </button>
                    <button class="tab-button" data-category="financial">
                        <i class="fas fa-chart-line"></i>
                        Financial Calculators
                    </button>
                    <button class="tab-button" data-category="health">
                        <i class="fas fa-heartbeat"></i>
                        Health & Fitness Calculators
                    </button>
                    <button class="tab-button" data-category="math">
                        <i class="fas fa-calculator"></i>
                        ðŸ”¢ Math & Number Calculators
                    </button>
                    <button class="tab-button" data-category="datetime">
                        <i class="fas fa-clock"></i>
                        Date & Time Calculators
                    </button>
          <button class="tab-button" data-category="construction">
            <i class="fas fa-hard-hat"></i>
            Construction & Engineering Calculators
          </button>
          
          <button class="tab-button" data-category="business">
            <i class="fas fa-briefcase"></i>
            Business & Marketing Calculators
          </button>

          <button class="tab-button" data-category="everyday">
            <i class="fas fa-home"></i>
            Everyday Life Calculators
          </button>
          <button class="tab-button" data-category="education">
            <i class="fas fa-graduation-cap"></i>
            Education & Learning Calculators
          </button>
          <button class="tab-button" data-category="technology">
            <i class="fas fa-laptop-code"></i>
            Technology & Computer Calculators
          </button>
          <button class="tab-button" data-category="scientific">
            <i class="fas fa-flask"></i>
            Science (Physics, Chemistry & Astronomy)
          </button>
                </div>

                <!-- Tools Grid -->
                <div class="tools-grid" id="toolsGrid">
                    <!-- Calculators will be dynamically populated here -->
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer" role="contentinfo" itemscope itemtype="https://schema.org/WPFooter">
        <div class="footer-container">
            <div class="footer-content">
        <div class="footer-brand" itemscope itemtype="https://schema.org/Organization">
          <h3 class="footer-logo" itemprop="name">Calculator Loop</h3>
          <p class="footer-tagline" itemprop="description">Free Online Calculators for Financial Planning, Health Metrics & Math Calculations. 300+ Tools Available in 2025.</p>
          <meta itemprop="url" content="https://calculatorloop.com/">
        </div>
                
                <div class="footer-links">
                    <a href="#privacy" class="footer-link">Privacy Policy</a>
                    <span class="footer-separator">|</span>
                    <a href="#terms" class="footer-link">Terms of Service</a>
                    <span class="footer-separator">|</span>
                    <a href="#sitemap" class="footer-link">Sitemap</a>
                    <span class="footer-separator">|</span>
                    <a href="#report" class="footer-link">Report Issue</a>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p class="footer-copyright">
                    Â© 2025 Calculator Loop. All rights reserved. Your trusted source for EMI, SIP, BMI, GST, Tax & 300+ free online calculators.
                </p>
            </div>
        </div>
    </footer>
    
    <!-- NEW: Calculator Modal -->
    <div class="modal-overlay" id="calculatorModal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-describedby="modalBody">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Calculator</h2>
                <button class="modal-close-btn" id="modalCloseBtn" aria-label="Close calculator">Ã—</button>
            </div>
            <div class="modal-body" id="modalBody" tabindex="-1">
                <!-- Calculator form will be injected here -->
            </div>
        </div>
    </div>

        <!-- Login Modal -->
        <div class="modal-overlay" id="loginModal" role="dialog" aria-modal="true" aria-labelledby="loginModalTitle">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="loginModalTitle">Sign In</h2>
                    <button class="modal-close-btn" id="loginModalClose" aria-label="Close login dialog">Ã—</button>
                </div>
                <div class="modal-body">
                    <form id="loginForm" class="calculator-form" aria-label="Login form">
                        <div class="form-group">
                            <label for="loginEmail">Email</label>
                            <input type="email" id="loginEmail" placeholder="you@example.com" required>
                        </div>
                        <div class="form-group">
                            <label for="loginPassword">Password</label>
                            <input type="password" id="loginPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" required>
                        </div>
                        <div style="display:flex;gap:12px;justify-content:flex-end;">
                            <button type="submit" class="tool-action" id="loginSubmit">Sign in</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Analytics Dashboard Modal -->
        <div class="modal-overlay" id="analyticsModal" role="dialog" aria-modal="true" aria-labelledby="analyticsModalTitle">
            <div class="modal-content" style="max-width: 700px;">
                <div class="modal-header">
                    <h2 class="modal-title" id="analyticsModalTitle">ðŸ“Š Analytics Dashboard</h2>
                    <button class="modal-close-btn" id="analyticsModalClose" aria-label="Close analytics dashboard">Ã—</button>
                </div>
                <div class="modal-body" id="analyticsModalBody">
                    <!-- Analytics content will be injected here -->
                </div>
            </div>
        </div>

        <!-- Mobile Menu Overlay -->
        <div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>
    
    <!-- Mobile Categories Menu (shows all categories when hamburger is clicked on mobile) -->
    <div class="mobile-categories-menu" id="mobileCategoriesMenu">
        <!-- Persistent Search Header (Mobile) -->
        <div class="mobile-search-header">
            <div class="mobile-search-container">
                <button class="mobile-search-back-btn" id="mobileCategoriesBack" aria-label="Go back">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <div class="mobile-search-input-wrapper">
                    <input 
                        type="text" 
                        id="mobileSearchMainInput" 
                        class="mobile-search-main-input" 
                        placeholder="ðŸ” Search any calculator..."
                        autocomplete="off"
                        aria-label="Search calculators"
                    >
                    <i class="fas fa-search mobile-search-icon-left"></i>
                    <button class="mobile-search-clear-btn" id="mobileSearchClearMain">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="mobile-search-suggestions" id="mobileSearchSuggestions">
                    <!-- Suggestions will be dynamically inserted here -->
                </div>
            </div>
        </div>
        <div class="mobile-menu-content" id="mobileMenuContent">
            <button class="mobile-category-btn" data-category="all">
                <i class="fas fa-th-large"></i>
                All Calculators
            </button>
            <button class="mobile-category-btn" data-category="financial">
                <i class="fas fa-chart-line"></i>
                Financial
            </button>
            <button class="mobile-category-btn" data-category="health">
                <i class="fas fa-heartbeat"></i>
                Fitness &amp; Health
            </button>
            <button class="mobile-category-btn" data-category="math">
                <i class="fas fa-calculator"></i>
                ðŸ”¢ Math & Number Calculators
            </button>
            <button class="mobile-category-btn" data-category="datetime">
                <i class="fas fa-clock"></i>
                Date &amp; Time
            </button>
            <button class="mobile-category-btn" data-category="business">
                <i class="fas fa-briefcase"></i>
                Business &amp; Marketing
            </button>
            <button class="mobile-category-btn" data-category="construction">
                <i class="fas fa-hard-hat"></i>
                Construction &amp; Engineering
            </button>
            <button class="mobile-category-btn" data-category="business">
                <i class="fas fa-briefcase"></i>
                Business &amp; Marketing
            </button>
            <button class="mobile-category-btn" data-category="electricity">
                <i class="fas fa-bolt"></i>
                Electricity &amp; Energy
            </button>
            <button class="mobile-category-btn" data-category="travel">
                <i class="fas fa-plane"></i>
                Travel &amp; Transport
            </button>
            <button class="mobile-category-btn" data-category="taxation">
                <i class="fas fa-file-invoice-dollar"></i>
                Taxation &amp; Accounting
            </button>
        </div>
    </div>
    
    <!-- Scripts -->
    <script>
        // ========== Welcome Tour Functionality ==========
        let currentTourStep = 1;
        const totalTourSteps = 4;

        // Check if user has visited before
        window.addEventListener('DOMContentLoaded', function() {
            const hasVisitedBefore = localStorage.getItem('hasVisitedCalculatorLoop');
            if (!hasVisitedBefore) {
                setTimeout(() => {
                    document.getElementById('welcomeTour').style.display = 'flex';
                }, 500);
            }
        });

        function nextTourStep() {
            if (currentTourStep < totalTourSteps) {
                // Hide current step
                document.querySelector(`.tour-step[data-step="${currentTourStep}"]`).classList.remove('active');
                document.querySelectorAll('.tour-progress-dot')[currentTourStep - 1].classList.remove('active');
                
                // Show next step
                currentTourStep++;
                document.querySelector(`.tour-step[data-step="${currentTourStep}"]`).classList.add('active');
                document.querySelectorAll('.tour-progress-dot')[currentTourStep - 1].classList.add('active');
                
                // Change button text on last step
                if (currentTourStep === totalTourSteps) {
                    document.querySelector('.tour-btn-next').innerHTML = 'Get Started! <i class="fas fa-check"></i>';
                }
            } else {
                completeTour();
            }
        }

        function skipTour() {
            completeTour();
        }

        function completeTour() {
            localStorage.setItem('hasVisitedCalculatorLoop', 'true');
            document.getElementById('welcomeTour').style.display = 'none';
            currentTourStep = 1;
            
            // Reset for next time (if needed for testing)
            document.querySelectorAll('.tour-step').forEach(step => step.classList.remove('active'));
            document.querySelector('.tour-step[data-step="1"]').classList.add('active');
            document.querySelectorAll('.tour-progress-dot').forEach(dot => dot.classList.remove('active'));
            document.querySelectorAll('.tour-progress-dot')[0].classList.add('active');
            document.querySelector('.tour-btn-next').innerHTML = 'Next <i class="fas fa-arrow-right"></i>';
        }

        // ========== Tooltip System ==========
        function createTooltip(term, definition) {
            return `
                <span class="tooltip-wrapper">
                    <i class="fas fa-question-circle tooltip-icon"></i>
                    <div class="tooltip-content">
                        <strong>${term}</strong>
                        <p>${definition}</p>
                    </div>
                </span>
            `;
        }

        // Common tooltips data
        const tooltips = {
            'BMI': 'Body Mass Index - A measure of body fat based on height and weight',
            'EMI': 'Equated Monthly Installment - Fixed monthly payment for loans',
            'CAGR': 'Compound Annual Growth Rate - Average annual growth rate over time',
            'SIP': 'Systematic Investment Plan - Regular investment in mutual funds',
            'ROI': 'Return on Investment - Profit percentage relative to investment cost',
            'APR': 'Annual Percentage Rate - Yearly interest rate including fees',
            'GST': 'Goods and Services Tax - Indirect tax on supply of goods/services',
            'BMR': 'Basal Metabolic Rate - Calories burned at rest per day',
            'TDS': 'Tax Deducted at Source - Income tax deducted before payment',
            'NPV': 'Net Present Value - Current value of future cash flows'
        };

        // ========== Sample Data Functions ==========
        function fillExampleData(calculatorType) {
            const examples = {
                'loan': {
                    amount: 50000,
                    rate: 7.5,
                    term: 5
                },
                'bmi': {
                    weight: 70,
                    height: 170
                },
                'investment': {
                    principal: 10000,
                    rate: 12,
                    years: 10
                },
                'age': {
                    birthDate: '1990-01-01'
                },
                'retirement': {
                    currentAge: 30,
                    retirementAge: 60,
                    currentSavings: 50000,
                    monthlyContribution: 1000,
                    returnRate: 8
                }
            };

            const data = examples[calculatorType];
            if (data) {
                Object.keys(data).forEach(key => {
                    const input = document.getElementById(key) || document.querySelector(`[name="${key}"]`);
                    if (input) {
                        input.value = data[key];
                        input.classList.add('valid');
                    }
                });
            }
        }

        // ========== Input Validation ==========
        function validateInput(input, min, max, type = 'number') {
            const value = input.value;
            const errorDiv = input.nextElementSibling?.classList.contains('input-error') 
                ? input.nextElementSibling 
                : null;

            if (!value) {
                input.classList.remove('valid', 'invalid');
                if (errorDiv) errorDiv.classList.remove('show');
                return false;
            }

            if (type === 'number') {
                const num = parseFloat(value);
                
                if (isNaN(num)) {
                    input.classList.add('invalid');
                    input.classList.remove('valid');
                    if (errorDiv) {
                        errorDiv.textContent = 'âš ï¸ Please enter a valid number';
                        errorDiv.classList.add('show');
                    }
                    return false;
                }

                if (min !== undefined && num < min) {
                    input.classList.add('invalid');
                    input.classList.remove('valid');
                    if (errorDiv) {
                        errorDiv.textContent = `âš ï¸ Value must be at least ${min}`;
                        errorDiv.classList.add('show');
                    }
                    return false;
                }

                if (max !== undefined && num > max) {
                    input.classList.add('invalid');
                    input.classList.remove('valid');
                    if (errorDiv) {
                        errorDiv.textContent = `âš ï¸ Value cannot exceed ${max}`;
                        errorDiv.classList.add('show');
                    }
                    return false;
                }
            }

            input.classList.add('valid');
            input.classList.remove('invalid');
            if (errorDiv) errorDiv.classList.remove('show');
            return true;
        }

        // ========== Result Display Functions ==========
        function displayResult(value, status, explanation, tips) {
            const resultHTML = `
                <div class="result-container">
                    <div class="result-value-box">
                        <div class="result-value">${value}</div>
                        <div class="result-status ${status}">${getStatusIcon(status)} ${getStatusText(status)}</div>
                    </div>
                    
                    ${explanation ? `
                        <div class="result-explanation">
                            <h4><i class="fas fa-info-circle"></i> What does this mean?</h4>
                            <p>${explanation}</p>
                        </div>
                    ` : ''}
                    
                    ${tips ? `
                        <div class="result-tips">
                            <i class="fas fa-lightbulb"></i>
                            <div class="result-tips-content">
                                <h5>ðŸ’¡ Helpful Tip</h5>
                                <p>${tips}</p>
                            </div>
                        </div>
                    ` : ''}
                    
                    <div class="result-actions">
                        <button class="action-btn download" onclick="downloadResult()">
                            <i class="fas fa-download"></i> Download PDF
                        </button>
                        <button class="action-btn share" onclick="showShareModal()">
                            <i class="fas fa-share-alt"></i> Share
                        </button>
                        <button class="action-btn save" onclick="saveResult()">
                            <i class="fas fa-bookmark"></i> Save
                        </button>
                        <button class="action-btn print" onclick="window.print()">
                            <i class="fas fa-print"></i> Print
                        </button>
                    </div>
                </div>
            `;
            
            return resultHTML;
        }

        function getStatusIcon(status) {
            const icons = {
                'healthy': 'âœ…',
                'warning': 'âš ï¸',
                'danger': 'âŒ'
            };
            return icons[status] || 'âœ“';
        }

        function getStatusText(status) {
            const texts = {
                'healthy': 'Healthy Range',
                'warning': 'Moderate',
                'danger': 'Needs Attention'
            };
            return texts[status] || 'Result';
        }

        // ========== Share Modal Functions ==========
        function showShareModal() {
            const modalHTML = `
                <div class="share-modal-overlay" onclick="closeShareModal(event)">
                    <div class="share-modal" onclick="event.stopPropagation()">
                        <h3>ðŸ“¤ Share Your Result</h3>
                        <div class="share-options">
                            <div class="share-option whatsapp" onclick="shareVia('whatsapp')">
                                <i class="fab fa-whatsapp"></i>
                                <span>WhatsApp</span>
                            </div>
                            <div class="share-option facebook" onclick="shareVia('facebook')">
                                <i class="fab fa-facebook"></i>
                                <span>Facebook</span>
                            </div>
                            <div class="share-option twitter" onclick="shareVia('twitter')">
                                <i class="fab fa-twitter"></i>
                                <span>Twitter</span>
                            </div>
                            <div class="share-option linkedin" onclick="shareVia('linkedin')">
                                <i class="fab fa-linkedin"></i>
                                <span>LinkedIn</span>
                            </div>
                        </div>
                        <button class="tour-btn tour-btn-skip" onclick="closeShareModal()" style="width: 100%; margin-top: 20px;">
                            Close
                        </button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }

        function closeShareModal(event) {
            if (event && event.target.classList.contains('share-modal')) return;
            document.querySelector('.share-modal-overlay')?.remove();
        }

        function shareVia(platform) {
            const url = encodeURIComponent(window.location.href);
            const text = encodeURIComponent('Check out my calculation on Calculator Loop!');
            
            const urls = {
                'whatsapp': `https://wa.me/?text=${text}%20${url}`,
                'facebook': `https://www.facebook.com/sharer/sharer.php?u=${url}`,
                'twitter': `https://twitter.com/intent/tweet?text=${text}&url=${url}`,
                'linkedin': `https://www.linkedin.com/sharing/share-offsite/?url=${url}`
            };
            
            window.open(urls[platform], '_blank', 'width=600,height=400');
            closeShareModal();
        }

        // ========== Debug Configuration ==========
        const DEBUG = false; // Set to true for development, false for production
        const dbg = DEBUG ? console.log.bind(console) : () => {};
        const dbgError = console.error.bind(console); // Always log errors
        
        // ========== Toast Notification System ==========
        let toastContainer = null;
        
        function initToastContainer() {
            if (!toastContainer) {
                toastContainer = document.createElement('div');
                toastContainer.className = 'toast-container';
                document.body.appendChild(toastContainer);
            }
            return toastContainer;
        }
        
        function showToast(message, type = 'info', duration = 4000) {
            const container = initToastContainer();
            
            const icons = {
                success: 'âœ…',
                error: 'âŒ',
                warning: 'âš ï¸',
                info: 'â„¹ï¸'
            };
            
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `
                <span class="toast-icon">${icons[type] || icons.info}</span>
                <span class="toast-message">${message}</span>
                <button class="toast-close" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            container.appendChild(toast);
            
            // Trigger animation
            setTimeout(() => toast.classList.add('show'), 10);
            
            // Auto-remove after duration
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 400);
            }, duration);
            
            return toast;
        }

        function downloadResult() {
            showToast('ðŸ“¥ PDF download coming soon in the next update!', 'info');
            // TODO: Implement PDF generation
        }

        function saveResult() {
            const saved = localStorage.getItem('savedCalculations') || '[]';
            showToast('ðŸ”– Result saved to your favorites!', 'success');
            // TODO: Implement save to localStorage
        }

        // Calculator Hub AI - Interactive JavaScript Functionality

        const toolsData = {
          financial: {
            subcategories: {
              'loan-emi': {
                name: 'ï¿½ Loan & EMI Calculators',
                icon: 'fas fa-hand-holding-usd',
                calculators: [
                  { id: 'personal-loan-emi', title: 'Personal Loan EMI Calculator', description: 'Calculate EMI for personal loans.', icon: 'fas fa-user-tie', action: 'Calculate Now' },
                  { id: 'home-loan-emi', title: 'Home Loan EMI Calculator', description: 'Calculate home loan monthly installments.', icon: 'fas fa-home', action: 'Calculate Now' },
                  { id: 'car-loan-emi', title: 'Car Loan EMI Calculator', description: 'Calculate car loan EMI and interest.', icon: 'fas fa-car', action: 'Calculate Now' },
                  { id: 'education-loan-emi', title: 'Education Loan EMI Calculator', description: 'Calculate education loan payments.', icon: 'fas fa-graduation-cap', action: 'Calculate Now' },
                  { id: 'business-loan-emi', title: 'Business Loan EMI Calculator', description: 'Calculate business loan installments.', icon: 'fas fa-briefcase', action: 'Calculate Now' },
                  { id: 'gold-loan-emi', title: 'Gold Loan EMI Calculator', description: 'Calculate EMI for gold-backed loans.', icon: 'fas fa-coins', action: 'Calculate Now' },
                  { id: 'two-wheeler-loan', title: 'Two Wheeler Loan Calculator', description: 'Calculate bike loan EMI.', icon: 'fas fa-motorcycle', action: 'Calculate Now' },
                  { id: 'loan-prepayment-impact', title: 'Loan Prepayment Impact Calculator', description: 'See impact of prepaying loans.', icon: 'fas fa-forward', action: 'Calculate Now' },
                  { id: 'loan-eligibility', title: 'Loan Eligibility Calculator', description: 'Check maximum loan eligibility.', icon: 'fas fa-check-circle', action: 'Calculate Now' },
                  { id: 'loan-comparison', title: 'Loan Comparison Calculator', description: 'Compare multiple loan offers.', icon: 'fas fa-exchange-alt', action: 'Calculate Now' },
                  { id: 'simple-interest-loan', title: 'Simple Interest Loan Calculator', description: 'Calculate simple interest on loans.', icon: 'fas fa-percent', action: 'Calculate Now' },
                  { id: 'compound-interest-loan', title: 'Compound Interest Loan Calculator', description: 'Calculate compound interest loans.', icon: 'fas fa-percentage', action: 'Calculate Now' },
                  { id: 'loan-amortization', title: 'Loan Amortization Schedule', description: 'View detailed loan payment schedule.', icon: 'fas fa-calendar-alt', action: 'Calculate Now' },
                  { id: 'remaining-loan-balance', title: 'Remaining Loan Balance Calculator', description: 'Calculate outstanding loan amount.', icon: 'fas fa-balance-scale', action: 'Calculate Now' },
                  { id: 'top-up-loan', title: 'Top-Up Loan Calculator', description: 'Calculate top-up loan on existing EMI.', icon: 'fas fa-arrow-up', action: 'Calculate Now' }
                ]
              },
              'investment-returns': {
                name: 'ï¿½ Investment & Returns Calculators',
                icon: 'fas fa-chart-line',
                calculators: [
                  { id: 'sip-calculator', title: 'SIP Calculator', description: 'Calculate Systematic Investment Plan returns.', icon: 'fas fa-chart-line', action: 'Calculate Now' },
                  { id: 'mutual-fund-returns', title: 'Mutual Fund Returns Calculator', description: 'Calculate mutual fund investment returns.', icon: 'fas fa-briefcase', action: 'Calculate Now' },
                  { id: 'compound-interest-investment', title: 'Compound Interest Calculator', description: 'Calculate compound investment growth.', icon: 'fas fa-percentage', action: 'Calculate Now' },
                  { id: 'cagr-calculator', title: 'CAGR Calculator', description: 'Calculate Compound Annual Growth Rate.', icon: 'fas fa-chart-area', action: 'Calculate Now' },
                  { id: 'roi-calculator', title: 'ROI Calculator', description: 'Calculate return on investment.', icon: 'fas fa-chart-pie', action: 'Calculate Now' },
                  { id: 'fd-calculator', title: 'Fixed Deposit Calculator', description: 'Calculate FD maturity amount.', icon: 'fas fa-university', action: 'Calculate Now' },
                  { id: 'rd-calculator', title: 'Recurring Deposit Calculator', description: 'Calculate RD returns.', icon: 'fas fa-redo-alt', action: 'Calculate Now' },
                  { id: 'nps-calculator', title: 'NPS Calculator', description: 'Calculate National Pension Scheme returns.', icon: 'fas fa-umbrella-beach', action: 'Calculate Now' },
                  { id: 'ppf-calculator', title: 'PPF Calculator', description: 'Calculate Public Provident Fund maturity.', icon: 'fas fa-piggy-bank', action: 'Calculate Now' },
                  { id: 'retirement-corpus', title: 'Retirement Corpus Calculator', description: 'Calculate retirement savings needed.', icon: 'fas fa-user-clock', action: 'Calculate Now' },
                  { id: 'lumpsum-investment', title: 'Lumpsum Investment Calculator', description: 'Calculate one-time investment returns.', icon: 'fas fa-hand-holding-usd', action: 'Calculate Now' },
                  { id: 'inflation-impact', title: 'Inflation Impact on Returns', description: 'Calculate real returns after inflation.', icon: 'fas fa-chart-line-down', action: 'Calculate Now' }
                ]
              },
              'tax-income': {
                name: 'ðŸ§¾ Tax & Income Calculators',
                icon: 'fas fa-file-invoice-dollar',
                calculators: [
                  { id: 'income-tax-calculator', title: 'Income Tax Calculator', description: 'Calculate annual income tax liability.', icon: 'fas fa-file-invoice-dollar', action: 'Calculate Now' },
                  { id: 'salary-breakup', title: 'Salary Breakup Calculator', description: 'Calculate CTC vs in-hand salary.', icon: 'fas fa-money-bill-wave', action: 'Calculate Now' },
                  { id: 'hra-calculator', title: 'HRA Calculator', description: 'Calculate House Rent Allowance exemption.', icon: 'fas fa-home', action: 'Calculate Now' },
                  { id: 'pf-calculator', title: 'PF Calculator', description: 'Calculate Provident Fund maturity.', icon: 'fas fa-wallet', action: 'Calculate Now' },
                  { id: 'gratuity-calculator', title: 'Gratuity Calculator', description: 'Calculate gratuity amount on retirement.', icon: 'fas fa-gift', action: 'Calculate Now' },
                  { id: 'tds-calculator', title: 'TDS Calculator', description: 'Calculate Tax Deducted at Source.', icon: 'fas fa-receipt', action: 'Calculate Now' },
                  { id: 'gst-calculator', title: 'GST Calculator', description: 'Calculate GST inclusive/exclusive prices.', icon: 'fas fa-file-invoice', action: 'Calculate Now' },
                  { id: 'professional-tax', title: 'Professional Tax Calculator', description: 'Calculate professional tax deductions.', icon: 'fas fa-briefcase', action: 'Calculate Now' },
                  { id: 'advance-tax', title: 'Advance Tax Calculator', description: 'Calculate quarterly advance tax.', icon: 'fas fa-calendar-check', action: 'Calculate Now' },
                  { id: 'post-tax-income', title: 'Post-Tax Income Calculator', description: 'Calculate income after all taxes.', icon: 'fas fa-hand-holding-usd', action: 'Calculate Now' }
                ]
              },
              'currency-forex': {
                name: 'ï¿½ Currency & Forex Calculators',
                icon: 'fas fa-exchange-alt',
                calculators: [
                  { id: 'currency-converter', title: 'Currency Converter', description: 'Convert between world currencies.', icon: 'fas fa-exchange-alt', action: 'Calculate Now' },
                  { id: 'crypto-profit-loss', title: 'Crypto Profit & Loss Calculator', description: 'Calculate cryptocurrency trading P&L.', icon: 'fab fa-bitcoin', action: 'Calculate Now' },
                  { id: 'forex-margin', title: 'Forex Margin Calculator', description: 'Calculate forex trading margin.', icon: 'fas fa-chart-line', action: 'Calculate Now' },
                  { id: 'exchange-rate-impact', title: 'Exchange Rate Impact Calculator', description: 'Calculate currency fluctuation impact.', icon: 'fas fa-globe', action: 'Calculate Now' },
                  { id: 'bitcoin-converter', title: 'Bitcoin to INR Converter', description: 'Convert Bitcoin to Indian Rupees.', icon: 'fab fa-bitcoin', action: 'Calculate Now' },
                  { id: 'import-export-duty', title: 'Import/Export Duty Calculator', description: 'Calculate customs duties.', icon: 'fas fa-ship', action: 'Calculate Now' },
                  { id: 'gold-silver-price', title: 'Gold/Silver Price Calculator', description: 'Calculate precious metal prices.', icon: 'fas fa-coins', action: 'Calculate Now' },
                  { id: 'international-transfer', title: 'International Transfer Fee Calculator', description: 'Calculate wire transfer costs.', icon: 'fas fa-paper-plane', action: 'Calculate Now' }
                ]
              },
              'banking-savings': {
                name: 'ðŸ¦ Banking & Savings Calculators',
                icon: 'fas fa-university',
                calculators: [
                  { id: 'savings-interest', title: 'Savings Account Interest Calculator', description: 'Calculate savings account interest.', icon: 'fas fa-piggy-bank', action: 'Calculate Now' },
                  { id: 'fd-rd-maturity', title: 'FD/RD Maturity Calculator', description: 'Calculate deposit maturity amounts.', icon: 'fas fa-certificate', action: 'Calculate Now' },
                  { id: 'interest-rate-comparison', title: 'Interest Rate Comparison Tool', description: 'Compare bank interest rates.', icon: 'fas fa-percentage', action: 'Calculate Now' },
                  { id: 'deposit-growth', title: 'Deposit Growth Calculator', description: 'Calculate savings growth over time.', icon: 'fas fa-chart-line', action: 'Calculate Now' },
                  { id: 'rd-planner', title: 'RD Installment Planner', description: 'Plan recurring deposit schedule.', icon: 'fas fa-calendar-alt', action: 'Calculate Now' },
                  { id: 'minimum-balance-penalty', title: 'Minimum Balance Penalty Calculator', description: 'Calculate penalty for low balance.', icon: 'fas fa-exclamation-triangle', action: 'Calculate Now' }
                ]
              },
              'business-profitability': {
                name: 'ï¿½ Business & Profitability Calculators',
                icon: 'fas fa-chart-pie',
                calculators: [
                  { id: 'profit-margin', title: 'Profit Margin Calculator', description: 'Calculate gross and net profit margins.', icon: 'fas fa-percentage', action: 'Calculate Now' },
                  { id: 'break-even-analysis', title: 'Break-Even Analysis Calculator', description: 'Calculate break-even point.', icon: 'fas fa-balance-scale', action: 'Calculate Now' },
                  { id: 'cost-vs-selling', title: 'Cost vs Selling Price Calculator', description: 'Calculate optimal pricing.', icon: 'fas fa-tags', action: 'Calculate Now' },
                  { id: 'markup-vs-margin', title: 'Markup vs Margin Calculator', description: 'Compare markup and margin.', icon: 'fas fa-calculator', action: 'Calculate Now' },
                  { id: 'inventory-cost', title: 'Inventory Cost Calculator', description: 'Calculate inventory holding costs.', icon: 'fas fa-boxes', action: 'Calculate Now' },
                  { id: 'roi-campaigns', title: 'ROI for Marketing Campaigns', description: 'Calculate marketing campaign ROI.', icon: 'fas fa-bullhorn', action: 'Calculate Now' },
                  { id: 'equity-valuation', title: 'Business Equity Valuation', description: 'Calculate business valuation.', icon: 'fas fa-building', action: 'Calculate Now' },
                  { id: 'freelancer-rate', title: 'Freelancer Rate Calculator', description: 'Calculate hourly freelance rates.', icon: 'fas fa-user-tie', action: 'Calculate Now' }
                ]
              },
              'miscellaneous-financial': {
                name: 'ðŸ§® Miscellaneous Financial Tools',
                icon: 'fas fa-calculator',
                calculators: [
                  { id: 'percentage-calculator', title: 'Percentage Calculator', description: 'Calculate percentages easily.', icon: 'fas fa-percent', action: 'Calculate Now' },
                  { id: 'discount-gst', title: 'Discount & GST Calculator', description: 'Calculate discounts with GST.', icon: 'fas fa-tags', action: 'Calculate Now' },
                  { id: 'tip-splitter', title: 'Tip & Bill Splitter', description: 'Split bills and calculate tips.', icon: 'fas fa-receipt', action: 'Calculate Now' },
                  { id: 'inflation-rate', title: 'Inflation Rate Calculator', description: 'Calculate historical inflation.', icon: 'fas fa-chart-area', action: 'Calculate Now' },
                  { id: 'time-value-money', title: 'Time Value of Money Calculator', description: 'Calculate present/future value.', icon: 'fas fa-clock', action: 'Calculate Now' },
                  { id: 'future-present-value', title: 'Future & Present Value Tool', description: 'Calculate money value over time.', icon: 'fas fa-forward', action: 'Calculate Now' }
                ]
              }
            }
          },
          health: {
            subcategories: {
              'body-measurements': {
                name: 'ðŸ”¸ Body Measurements',
                icon: 'fas fa-ruler-vertical',
                calculators: [
                  { id: 'bmi-calculator', title: 'BMI Calculator', description: 'Calculate your Body Mass Index.', icon: 'fas fa-weight-scale', url: './fitness-health/bmi-calculator.html' },
                  { id: 'bmr-calculator', title: 'BMR Calculator', description: 'Calculate your Basal Metabolic Rate.', icon: 'fas fa-fire', action: 'Calculate Now' },
                  { id: 'body-fat-calculator', title: 'Body Fat Calculator', description: 'Estimate your body fat percentage.', icon: 'fas fa-percentage', action: 'Calculate Now' },
                  { id: 'lean-body-mass', title: 'Lean Body Mass Calculator', description: 'Calculate your lean body mass.', icon: 'fas fa-dumbbell', action: 'Calculate Now' },
                  { id: 'body-surface-area', title: 'Body Surface Area Calculator', description: 'Calculate BSA for medical purposes.', icon: 'fas fa-user-md', action: 'Calculate Now' },
                  { id: 'waist-hip-ratio', title: 'Waist-to-Hip Ratio', description: 'Measure body fat distribution.', icon: 'fas fa-ruler-horizontal', action: 'Calculate Now' },
                ]
              },
              'nutrition-calories': {
                name: 'ðŸ”¸ Nutrition & Calorie Tracking',
                icon: 'fas fa-apple-alt',
                calculators: [
                  { id: 'calorie-calculator', title: 'Calorie Calculator', description: 'Estimate your daily calorie needs.', icon: 'fas fa-apple-alt', url: './fitness-health/calorie-calculator.html' },
                  { id: 'macro-calculator', title: 'Macro Calculator', description: 'Calculate your optimal macronutrient intake.', icon: 'fas fa-utensils', action: 'Calculate Now' },
                  { id: 'tdee-calculator', title: 'TDEE Calculator', description: 'Calculate Total Daily Energy Expenditure.', icon: 'fas fa-battery-full', action: 'Calculate Now' },
                  { id: 'protein-calculator', title: 'Protein Calculator', description: 'Calculate daily protein requirements.', icon: 'fas fa-drumstick-bite', action: 'Calculate Now' },
                  { id: 'water-intake-calculator', title: 'Water Intake Calculator', description: 'Calculate daily water needs.', icon: 'fas fa-glass-water', action: 'Calculate Now' },
                  { id: 'meal-planner', title: 'Meal Planner Calculator', description: 'Plan balanced meals and portions.', icon: 'fas fa-plate-wheat', action: 'Calculate Now' },
                ]
              },
              'exercise-performance': {
                name: 'ðŸ”¸ Exercise & Performance',
                icon: 'fas fa-running',
                calculators: [
                  { id: 'calories-burned', title: 'Calories Burned Calculator', description: 'Estimate calories burned during exercise.', icon: 'fas fa-fire-alt', action: 'Calculate Now' },
                  { id: 'pace-calculator', title: 'Pace Calculator', description: 'Calculate running/walking pace.', icon: 'fas fa-running', action: 'Calculate Now' },
                  { id: 'one-rep-max', title: 'One Rep Max Calculator', description: 'Calculate maximum lifting capacity.', icon: 'fas fa-dumbbell', action: 'Calculate Now' },
                  { id: 'vo2-max-calculator', title: 'VO2 Max Calculator', description: 'Measure aerobic fitness level.', icon: 'fas fa-lungs', action: 'Calculate Now' },
                  { id: 'training-zone-calculator', title: 'Training Zone Calculator', description: 'Calculate optimal training zones.', icon: 'fas fa-heartbeat', action: 'Calculate Now' },
                  { id: 'workout-intensity', title: 'Workout Intensity Calculator', description: 'Calculate exercise intensity levels.', icon: 'fas fa-tachometer-alt', action: 'Calculate Now' },
                ]
              },
              'heart-vital-health': {
                name: 'ðŸ”¸ Heart & Vital Health',
                icon: 'fas fa-heartbeat',
                calculators: [
                  { id: 'target-heart-rate', title: 'Target Heart Rate Calculator', description: 'Find your target heart rate zones.', icon: 'fas fa-heart-pulse', action: 'Calculate Now' },
                  { id: 'blood-pressure-calculator', title: 'Blood Pressure Calculator', description: 'Interpret blood pressure readings.', icon: 'fas fa-heart', action: 'Calculate Now' },
                  { id: 'resting-heart-rate', title: 'Resting Heart Rate Calculator', description: 'Calculate your RHR and fitness level.', icon: 'fas fa-bed', action: 'Calculate Now' },
                  { id: 'cardiovascular-risk', title: 'Cardiovascular Risk Calculator', description: 'Assess heart disease risk.', icon: 'fas fa-heartbeat', action: 'Calculate Now' },
                  { id: 'pulse-pressure-calculator', title: 'Pulse Pressure Calculator', description: 'Calculate pulse pressure from BP.', icon: 'fas fa-wave-square', action: 'Calculate Now' },
                ]
              },
              'pregnancy-fertility': {
                name: 'ðŸ”¸ Pregnancy & Fertility',
                icon: 'fas fa-baby',
                calculators: [
                  { id: 'pregnancy-calculator', title: 'Pregnancy Calculator', description: 'Track pregnancy and due date.', icon: 'fas fa-baby', action: 'Calculate Now' },
                  { id: 'due-date-calculator', title: 'Due Date Calculator', description: 'Calculate baby due date.', icon: 'fas fa-calendar-alt', action: 'Calculate Now' },
                  { id: 'ovulation-calculator', title: 'Ovulation Calculator', description: 'Predict most fertile days.', icon: 'fas fa-leaf', action: 'Calculate Now' },
                  { id: 'conception-calculator', title: 'Conception Calculator', description: 'Estimate conception date.', icon: 'fas fa-heart', action: 'Calculate Now' },
                  { id: 'pregnancy-weight-gain', title: 'Pregnancy Weight Gain Calculator', description: 'Track healthy pregnancy weight.', icon: 'fas fa-weight-scale', action: 'Calculate Now' },
                  { id: 'fertility-window', title: 'Fertility Window Calculator', description: 'Calculate fertility period.', icon: 'fas fa-calendar-check', action: 'Calculate Now' },
                ]
              },
              'sleep-lifestyle': {
                name: 'ðŸ”¸ Sleep & Lifestyle',
                icon: 'fas fa-bed',
                calculators: [
                  { id: 'sleep-calculator', title: 'Sleep Calculator', description: 'Calculate optimal sleep and wake times.', icon: 'fas fa-bed', action: 'Calculate Now' },
                  { id: 'sleep-cycle-calculator', title: 'Sleep Cycle Calculator', description: 'Find best wake-up time for REM cycles.', icon: 'fas fa-moon', action: 'Calculate Now' },
                  { id: 'caffeine-calculator', title: 'Caffeine Calculator', description: 'Calculate safe caffeine intake.', icon: 'fas fa-coffee', action: 'Calculate Now' },
                  { id: 'stress-level-calculator', title: 'Stress Level Calculator', description: 'Assess your stress levels.', icon: 'fas fa-brain', action: 'Calculate Now' },
                  { id: 'screen-time-calculator', title: 'Screen Time Calculator', description: 'Track and manage screen time.', icon: 'fas fa-mobile-alt', action: 'Calculate Now' },
                ]
              },
              'weight-goal-management': {
                name: 'ðŸ”¸ Weight & Goal Management',
                icon: 'fas fa-bullseye',
                calculators: [
                  { id: 'ideal-weight-calculator', title: 'Ideal Weight Calculator', description: 'Find your ideal healthy weight range.', icon: 'fas fa-balance-scale-right', action: 'Calculate Now' },
                  { id: 'weight-loss-calculator', title: 'Weight Loss Calculator', description: 'Calculate weight loss timeline.', icon: 'fas fa-weight', action: 'Calculate Now' },
                  { id: 'calorie-deficit-calculator', title: 'Calorie Deficit Calculator', description: 'Calculate deficit for weight loss.', icon: 'fas fa-minus-circle', action: 'Calculate Now' },
                  { id: 'body-frame-calculator', title: 'Body Frame Calculator', description: 'Determine your body frame size.', icon: 'fas fa-user', action: 'Calculate Now' },
                  { id: 'weight-goal-tracker', title: 'Weight Goal Tracker', description: 'Track progress toward weight goals.', icon: 'fas fa-chart-line', action: 'Calculate Now' },
                  { id: 'maintenance-calorie-calculator', title: 'Maintenance Calorie Calculator', description: 'Calculate calories to maintain weight.', icon: 'fas fa-equals', action: 'Calculate Now' },
                ]
              },
              'disease-risk-prevention': {
                name: 'ðŸ”¸ Disease Risk & Prevention',
                icon: 'fas fa-shield-virus',
                calculators: [
                  { id: 'diabetes-risk-calculator', title: 'Diabetes Risk Calculator', description: 'Assess diabetes risk factors.', icon: 'fas fa-syringe', action: 'Calculate Now' },
                  { id: 'cholesterol-ratio-calculator', title: 'Cholesterol Ratio Calculator', description: 'Calculate cholesterol ratios.', icon: 'fas fa-vial', action: 'Calculate Now' },
                  { id: 'stroke-risk-calculator', title: 'Stroke Risk Calculator', description: 'Assess stroke risk factors.', icon: 'fas fa-brain', action: 'Calculate Now' },
                  { id: 'metabolic-syndrome-calculator', title: 'Metabolic Syndrome Calculator', description: 'Check metabolic health indicators.', icon: 'fas fa-heartbeat', action: 'Calculate Now' },
                  { id: 'bone-density-calculator', title: 'Bone Density Calculator', description: 'Assess osteoporosis risk.', icon: 'fas fa-bone', action: 'Calculate Now' },
                  { id: 'kidney-function-calculator', title: 'Kidney Function Calculator', description: 'Calculate GFR and kidney health.', icon: 'fas fa-kidneys', action: 'Calculate Now' },
                ]
              }
            }
          },
          math: {
            subcategories: {
              'basic-arithmetic': {
                name: 'ðŸ”¸ Basic Arithmetic',
                icon: 'fas fa-calculator',
                calculators: [
                  { id: 'basic-calculator', title: 'Basic Calculator', description: 'Perform basic arithmetic operations.', icon: 'fas fa-calculator', action: 'Calculate Now' },
                  { id: 'percentage-calculator', title: 'Percentage Calculator', description: 'Solve various percentage problems.', icon: 'fas fa-percent', url: './math-geometry/percentage-calculator.html' },
                  { id: 'fraction-calculator', title: 'Fraction Calculator', description: 'Add, subtract, multiply, and divide fractions.', icon: 'fas fa-divide', action: 'Calculate Now' },
                  { id: 'decimal-calculator', title: 'Decimal Calculator', description: 'Perform operations with decimals.', icon: 'fas fa-sort-numeric-down', action: 'Calculate Now' },
                  { id: 'ratio-calculator', title: 'Ratio Calculator', description: 'Simplify and solve ratios.', icon: 'fas fa-equals', action: 'Calculate Now' },
                  { id: 'proportion-calculator', title: 'Proportion Calculator', description: 'Solve proportions and cross multiplication.', icon: 'fas fa-balance-scale', action: 'Calculate Now' },
                  { id: 'average-calculator', title: 'Average Calculator', description: 'Calculate mean, median, mode.', icon: 'fas fa-chart-bar', action: 'Calculate Now' },
                  { id: 'rounding-calculator', title: 'Rounding Calculator', description: 'Round numbers to specified decimals.', icon: 'fas fa-compress-arrows-alt', action: 'Calculate Now' },
                ]
              },
              'algebra-equations': {
                name: 'ðŸ”¸ Algebra & Equations',
                icon: 'fas fa-square-root-alt',
                calculators: [
                  { id: 'quadratic-formula-calculator', title: 'Quadratic Formula Calculator', description: 'Solve quadratic equations.', icon: 'fas fa-square-root-alt', action: 'Calculate Now' },
                  { id: 'linear-equation-solver', title: 'Linear Equation Solver', description: 'Solve linear equations and systems.', icon: 'fas fa-slash', action: 'Calculate Now' },
                  { id: 'polynomial-calculator', title: 'Polynomial Calculator', description: 'Calculate and simplify polynomials.', icon: 'fas fa-subscript', action: 'Calculate Now' },
                  { id: 'factoring-calculator', title: 'Factoring Calculator', description: 'Factor algebraic expressions.', icon: 'fas fa-code-branch', action: 'Calculate Now' },
                  { id: 'exponent-calculator', title: 'Exponent Calculator', description: 'Solve expressions with exponents.', icon: 'fas fa-superscript', action: 'Calculate Now' },
                  { id: 'logarithm-calculator', title: 'Logarithm Calculator', description: 'Calculate logarithms with any base.', icon: 'fas fa-wave-square', action: 'Calculate Now' },
                  { id: 'inequalities-solver', title: 'Inequalities Solver', description: 'Solve algebraic inequalities.', icon: 'fas fa-not-equal', action: 'Calculate Now' },
                  { id: 'simultaneous-equations', title: 'Simultaneous Equations Solver', description: 'Solve systems of equations.', icon: 'fas fa-layer-group', action: 'Calculate Now' },
                ]
              },
              'geometry-shapes': {
                name: 'ðŸ”¸ Geometry & Shapes',
                icon: 'fas fa-shapes',
                calculators: [
                  { id: 'area-calculator', title: 'Area Calculator', description: 'Calculate area of 2D shapes.', icon: 'fas fa-square', action: 'Calculate Now' },
                  { id: 'perimeter-calculator', title: 'Perimeter Calculator', description: 'Calculate perimeter of shapes.', icon: 'fas fa-border-all', action: 'Calculate Now' },
                  { id: 'volume-calculator', title: 'Volume Calculator', description: 'Calculate volume of 3D shapes.', icon: 'fas fa-cube', action: 'Calculate Now' },
                  { id: 'surface-area-calculator', title: 'Surface Area Calculator', description: 'Calculate surface area of 3D objects.', icon: 'fas fa-cubes', action: 'Calculate Now' },
                  { id: 'triangle-calculator', title: 'Triangle Calculator', description: 'Solve for sides and angles of triangles.', icon: 'fas fa-drafting-compass', action: 'Calculate Now' },
                  { id: 'circle-calculator', title: 'Circle Calculator', description: 'Calculate circle properties.', icon: 'fas fa-circle', action: 'Calculate Now' },
                  { id: 'pythagorean-theorem', title: 'Pythagorean Theorem Calculator', description: 'Calculate right triangle sides.', icon: 'fas fa-ruler-combined', action: 'Calculate Now' },
                  { id: 'polygon-calculator', title: 'Polygon Calculator', description: 'Calculate properties of polygons.', icon: 'fas fa-draw-polygon', action: 'Calculate Now' },
                  { id: 'distance-calculator', title: 'Distance Calculator', description: 'Find distance between two points.', icon: 'fas fa-ruler-horizontal', action: 'Calculate Now' },
                  { id: 'coordinate-geometry', title: 'Coordinate Geometry Calculator', description: 'Work with coordinate geometry.', icon: 'fas fa-map-marked', action: 'Calculate Now' },
                ]
              },
              'trigonometry': {
                name: 'ðŸ”¸ Trigonometry',
                icon: 'fas fa-wave-sine',
                calculators: [
                  { id: 'trigonometry-calculator', title: 'Trigonometry Calculator', description: 'Calculate sine, cosine, tangent.', icon: 'fas fa-wave-sine', action: 'Calculate Now' },
                  { id: 'inverse-trig-calculator', title: 'Inverse Trig Calculator', description: 'Calculate arcsin, arccos, arctan.', icon: 'fas fa-undo', action: 'Calculate Now' },
                  { id: 'law-of-sines', title: 'Law of Sines Calculator', description: 'Solve triangles using law of sines.', icon: 'fas fa-angle-right', action: 'Calculate Now' },
                  { id: 'law-of-cosines', title: 'Law of Cosines Calculator', description: 'Solve triangles using law of cosines.', icon: 'fas fa-angle-left', action: 'Calculate Now' },
                  { id: 'unit-circle-calculator', title: 'Unit Circle Calculator', description: 'Find values on the unit circle.', icon: 'fas fa-circle-notch', action: 'Calculate Now' },
                  { id: 'angle-converter', title: 'Angle Converter', description: 'Convert between degrees and radians.', icon: 'fas fa-sync-alt', action: 'Calculate Now' },
                  { id: 'triangle-angle-calculator', title: 'Triangle Angle Calculator', description: 'Calculate missing triangle angles.', icon: 'fas fa-triangle', action: 'Calculate Now' },
                ]
              },
              'probability-statistics': {
                name: 'ðŸ”¸ Probability & Statistics',
                icon: 'fas fa-chart-pie',
                calculators: [
                  { id: 'probability-calculator', title: 'Probability Calculator', description: 'Calculate probability of events.', icon: 'fas fa-dice', action: 'Calculate Now' },
                  { id: 'standard-deviation-calculator', title: 'Standard Deviation Calculator', description: 'Calculate standard deviation.', icon: 'fas fa-chart-bar', action: 'Calculate Now' },
                  { id: 'mean-median-mode', title: 'Mean, Median, Mode Calculator', description: 'Find central tendency of data.', icon: 'fas fa-sort-numeric-down', action: 'Calculate Now' },
                  { id: 'variance-calculator', title: 'Variance Calculator', description: 'Calculate variance of dataset.', icon: 'fas fa-chart-area', action: 'Calculate Now' },
                  { id: 'permutation-calculator', title: 'Permutation Calculator', description: 'Calculate permutations nPr.', icon: 'fas fa-list-ol', action: 'Calculate Now' },
                  { id: 'combination-calculator', title: 'Combination Calculator', description: 'Calculate combinations nCr.', icon: 'fas fa-layer-group', action: 'Calculate Now' },
                  { id: 'z-score-calculator', title: 'Z-Score Calculator', description: 'Calculate z-score for normal distribution.', icon: 'fas fa-chart-line', action: 'Calculate Now' },
                  { id: 'correlation-coefficient', title: 'Correlation Coefficient Calculator', description: 'Calculate correlation between variables.', icon: 'fas fa-project-diagram', action: 'Calculate Now' },
                  { id: 'regression-calculator', title: 'Regression Calculator', description: 'Perform linear regression analysis.', icon: 'fas fa-chart-scatter', action: 'Calculate Now' },
                  { id: 'confidence-interval', title: 'Confidence Interval Calculator', description: 'Calculate confidence intervals.', icon: 'fas fa-percentage', action: 'Calculate Now' },
                ]
              },
              'unit-conversions': {
                name: 'ðŸ”¸ Unit Conversions',
                icon: 'fas fa-exchange-alt',
                calculators: [
                  { id: 'length-converter', title: 'Length Converter', description: 'Convert between length units.', icon: 'fas fa-ruler', action: 'Calculate Now' },
                  { id: 'weight-converter', title: 'Weight/Mass Converter', description: 'Convert between weight units.', icon: 'fas fa-weight', action: 'Calculate Now' },
                  { id: 'volume-converter', title: 'Volume Converter', description: 'Convert between volume units.', icon: 'fas fa-flask', action: 'Calculate Now' },
                  { id: 'temperature-converter', title: 'Temperature Converter', description: 'Convert Celsius, Fahrenheit, Kelvin.', icon: 'fas fa-thermometer-half', action: 'Calculate Now' },
                  { id: 'area-converter', title: 'Area Converter', description: 'Convert between area units.', icon: 'fas fa-vector-square', action: 'Calculate Now' },
                  { id: 'speed-converter', title: 'Speed Converter', description: 'Convert between speed units.', icon: 'fas fa-tachometer-alt', action: 'Calculate Now' },
                  { id: 'time-converter', title: 'Time Converter', description: 'Convert between time units.', icon: 'fas fa-clock', action: 'Calculate Now' },
                  { id: 'pressure-converter', title: 'Pressure Converter', description: 'Convert between pressure units.', icon: 'fas fa-compress', action: 'Calculate Now' },
                  { id: 'energy-converter', title: 'Energy Converter', description: 'Convert between energy units.', icon: 'fas fa-battery-full', action: 'Calculate Now' },
                  { id: 'power-converter', title: 'Power Converter', description: 'Convert between power units.', icon: 'fas fa-bolt', action: 'Calculate Now' },
                ]
              },
              'number-systems': {
                name: 'ðŸ”¸ Number Systems & Converters',
                icon: 'fas fa-microchip',
                calculators: [
                  { id: 'binary-calculator', title: 'Binary Calculator', description: 'Perform calculations in binary.', icon: 'fas fa-microchip', action: 'Calculate Now' },
                  { id: 'hex-calculator', title: 'Hexadecimal Calculator', description: 'Work with hexadecimal numbers.', icon: 'fas fa-hashtag', action: 'Calculate Now' },
                  { id: 'octal-calculator', title: 'Octal Calculator', description: 'Perform octal calculations.', icon: 'fas fa-code', action: 'Calculate Now' },
                  { id: 'base-converter', title: 'Number Base Converter', description: 'Convert between number bases.', icon: 'fas fa-exchange-alt', action: 'Calculate Now' },
                  { id: 'roman-numeral-converter', title: 'Roman Numeral Converter', description: 'Convert to/from Roman numerals.', icon: 'fas fa-font', action: 'Calculate Now' },
                  { id: 'scientific-notation-converter', title: 'Scientific Notation Converter', description: 'Convert to scientific notation.', icon: 'fas fa-superscript', action: 'Calculate Now' },
                  { id: 'prime-number-checker', title: 'Prime Number Checker', description: 'Check if a number is prime.', icon: 'fas fa-check-circle', action: 'Calculate Now' },
                  { id: 'factors-calculator', title: 'Factors Calculator', description: 'Find factors of a number.', icon: 'fas fa-list-ul', action: 'Calculate Now' },
                  { id: 'lcm-gcf-calculator', title: 'LCM & GCF Calculator', description: 'Find LCM and GCF of numbers.', icon: 'fas fa-intersection', action: 'Calculate Now' },
                ]
              },
              'graphs-formulas': {
                name: 'ðŸ”¸ Graphs & Formulas',
                icon: 'fas fa-chart-line',
                calculators: [
                  { id: 'graphing-calculator', title: 'Graphing Calculator', description: 'Graph mathematical functions.', icon: 'fas fa-chart-line', action: 'Calculate Now' },
                  { id: 'slope-calculator', title: 'Slope Calculator', description: 'Calculate slope between two points.', icon: 'fas fa-slash', action: 'Calculate Now' },
                  { id: 'midpoint-calculator', title: 'Midpoint Calculator', description: 'Find midpoint between two points.', icon: 'fas fa-dot-circle', action: 'Calculate Now' },
                  { id: 'intercept-calculator', title: 'Intercept Calculator', description: 'Find x and y intercepts.', icon: 'fas fa-times', action: 'Calculate Now' },
                  { id: 'sequence-calculator', title: 'Sequence Calculator', description: 'Calculate arithmetic & geometric sequences.', icon: 'fas fa-list-ol', action: 'Calculate Now' },
                  { id: 'series-calculator', title: 'Series Calculator', description: 'Calculate series summations.', icon: 'fas fa-sigma', action: 'Calculate Now' },
                  { id: 'function-calculator', title: 'Function Calculator', description: 'Evaluate mathematical functions.', icon: 'fas fa-function', action: 'Calculate Now' },
                  { id: 'parabola-calculator', title: 'Parabola Calculator', description: 'Calculate parabola properties.', icon: 'fas fa-curve', action: 'Calculate Now' },
                ]
              },
              'matrices-vectors': {
                name: 'ðŸ”¸ Matrices & Vectors',
                icon: 'fas fa-th',
                calculators: [
                  { id: 'matrix-calculator', title: 'Matrix Calculator', description: 'Add, multiply, inverse matrices.', icon: 'fas fa-th', action: 'Calculate Now' },
                  { id: 'determinant-calculator', title: 'Determinant Calculator', description: 'Calculate matrix determinant.', icon: 'fas fa-grip', action: 'Calculate Now' },
                  { id: 'vector-calculator', title: 'Vector Calculator', description: 'Vector operations and calculations.', icon: 'fas fa-arrows-alt', action: 'Calculate Now' },
                  { id: 'dot-product-calculator', title: 'Dot Product Calculator', description: 'Calculate dot product of vectors.', icon: 'fas fa-circle', action: 'Calculate Now' },
                  { id: 'cross-product-calculator', title: 'Cross Product Calculator', description: 'Calculate cross product of vectors.', icon: 'fas fa-times', action: 'Calculate Now' },
                  { id: 'eigenvalue-calculator', title: 'Eigenvalue Calculator', description: 'Find eigenvalues and eigenvectors.', icon: 'fas fa-vector-square', action: 'Calculate Now' },
                  { id: 'matrix-inverse', title: 'Matrix Inverse Calculator', description: 'Calculate inverse of a matrix.', icon: 'fas fa-undo', action: 'Calculate Now' },
                ]
              },
              'advanced-mathematics': {
                name: 'ðŸ”¸ Advanced Mathematics',
                icon: 'fas fa-infinity',
                calculators: [
                  { id: 'scientific-calculator', title: 'Scientific Calculator', description: 'Perform advanced mathematical calculations.', icon: 'fas fa-flask', action: 'Calculate Now' },
                  { id: 'derivative-calculator', title: 'Derivative Calculator', description: 'Calculate derivatives of functions.', icon: 'fas fa-chart-line', action: 'Calculate Now' },
                  { id: 'integral-calculator', title: 'Integral Calculator', description: 'Calculate definite and indefinite integrals.', icon: 'fas fa-integral', action: 'Calculate Now' },
                  { id: 'limit-calculator', title: 'Limit Calculator', description: 'Calculate limits of functions.', icon: 'fas fa-infinity', action: 'Calculate Now' },
                  { id: 'differential-equation-solver', title: 'Differential Equation Solver', description: 'Solve differential equations.', icon: 'fas fa-wave-square', action: 'Calculate Now' },
                  { id: 'fourier-series-calculator', title: 'Fourier Series Calculator', description: 'Calculate Fourier series.', icon: 'fas fa-wave-sine', action: 'Calculate Now' },
                  { id: 'laplace-transform', title: 'Laplace Transform Calculator', description: 'Calculate Laplace transforms.', icon: 'fas fa-project-diagram', action: 'Calculate Now' },
                  { id: 'complex-number-calculator', title: 'Complex Number Calculator', description: 'Work with complex numbers.', icon: 'fas fa-code', action: 'Calculate Now' },
                  { id: 'partial-derivative', title: 'Partial Derivative Calculator', description: 'Calculate partial derivatives.', icon: 'fas fa-divide', action: 'Calculate Now' },
                  { id: 'random-number-generator', title: 'Random Number Generator', description: 'Generate random numbers within a range.', icon: 'fas fa-random', action: 'Calculate Now' },
                ]
              }
            }
          },
          datetime: {
            subcategories: {
              'age-birthdate': {
                name: 'ðŸŽ‚ Age & Birthdate Calculation',
                icon: 'fas fa-birthday-cake',
                calculators: [
                  { id: 'age-calculator', title: 'Age Calculator', description: 'Calculate your exact age in years, months, and days.', icon: 'fas fa-birthday-cake', url: './date-time/age-calculator.html' },
                  { id: 'exact-age-calculator', title: 'Exact Age Calculator', description: 'Calculate age with hours and minutes precision.', icon: 'fas fa-stopwatch', action: 'Calculate Now' },
                  { id: 'zodiac-sign-calculator', title: 'Zodiac Sign Calculator', description: 'Find zodiac sign from birthdate.', icon: 'fas fa-star', action: 'Calculate Now' },
                ]
              },
              'date-arithmetic': {
                name: 'ðŸ“… Date Arithmetic & Difference',
                icon: 'fas fa-calculator',
                calculators: [
                  { id: 'date-difference-calculator', title: 'Date Difference Calculator', description: 'Calculate difference between two dates.', icon: 'fas fa-calendar-minus', action: 'Calculate Now' },
                  { id: 'add-days-calculator', title: 'Add Days to Date', description: 'Add or subtract days from a date.', icon: 'fas fa-calendar-plus', action: 'Calculate Now' },
                  { id: 'business-days-calculator', title: 'Business Days Calculator', description: 'Calculate working days between dates.', icon: 'fas fa-briefcase', action: 'Calculate Now' },
                ]
              },
              'time-management': {
                name: 'â±ï¸ Time Management & Tracking',
                icon: 'fas fa-hourglass-half',
                calculators: [
                  { id: 'countdown-timer', title: 'Countdown Timer', description: 'Set countdown for any event.', icon: 'fas fa-hourglass-half', action: 'Calculate Now' },
                  { id: 'event-countdown', title: 'Event Countdown', description: 'Count down to special events.', icon: 'fas fa-calendar-check', action: 'Calculate Now' },
                  { id: 'pomodoro-timer', title: 'Pomodoro Timer', description: 'Productivity timer with breaks.', icon: 'fas fa-clock', action: 'Calculate Now' },
                ]
              },
              'timezone-world': {
                name: 'ðŸŒ Time Zone & World Time',
                icon: 'fas fa-globe-americas',
                calculators: [
                  { id: 'timezone-converter', title: 'Time Zone Converter', description: 'Convert time across different time zones.', icon: 'fas fa-globe', action: 'Calculate Now' },
                  { id: 'world-clock', title: 'World Clock', description: 'View time in multiple time zones.', icon: 'fas fa-globe-americas', action: 'Calculate Now' },
                  { id: 'utc-converter', title: 'UTC Time Converter', description: 'Convert to/from UTC time.', icon: 'fas fa-clock', action: 'Calculate Now' },
                ]
              },
            }
          },
          construction: {
            subcategories: {
              'structural-engineering': {
                name: 'ðŸ—ï¸ Structural Engineering',
                icon: 'fas fa-building',
                calculators: [
                  { id: 'load-calculator', title: 'Structural Load Calculator', description: 'Estimate structural loads for beams and columns.', icon: 'fas fa-ruler-combined', action: 'Calculate Now' },
                  { id: 'beam-calculator', title: 'Beam Deflection Calculator', description: 'Calculate beam deflection and stress.', icon: 'fas fa-minus', action: 'Calculate Now' },
                  { id: 'column-calculator', title: 'Column Design Calculator', description: 'Design concrete and steel columns.', icon: 'fas fa-grip-lines-vertical', action: 'Calculate Now' },
                  { id: 'rebar-calculator', title: 'Rebar Calculator', description: 'Calculate reinforcement requirements.', icon: 'fas fa-bars', action: 'Calculate Now' },
                ]
              },
              'materials-quantity': {
                name: 'ðŸ“¦ Materials & Quantity',
                icon: 'fas fa-cubes',
                calculators: [
                  { id: 'concrete-calculator', title: 'Concrete Calculator', description: 'Calculate concrete volume for construction.', icon: 'fas fa-hard-hat', action: 'Calculate Now' },
                  { id: 'brick-calculator', title: 'Brick Calculator', description: 'Calculate number of bricks needed.', icon: 'fas fa-cube', action: 'Calculate Now' },
                  { id: 'cement-calculator', title: 'Cement Calculator', description: 'Calculate cement bags required.', icon: 'fas fa-box', action: 'Calculate Now' },
                  { id: 'sand-calculator', title: 'Sand & Gravel Calculator', description: 'Calculate sand and gravel quantities.', icon: 'fas fa-layer-group', action: 'Calculate Now' },
                ]
              },
              'area-volume': {
                name: 'ðŸ“ Area & Volume Calculation',
                icon: 'fas fa-ruler-combined',
                calculators: [
                  { id: 'area-calculator', title: 'Area Calculator', description: 'Calculate area for various shapes.', icon: 'fas fa-square', action: 'Calculate Now' },
                  { id: 'volume-calculator', title: 'Volume Calculator', description: 'Calculate volume for 3D shapes.', icon: 'fas fa-cube', action: 'Calculate Now' },
                  { id: 'room-size-calculator', title: 'Room Size Calculator', description: 'Calculate room dimensions and area.', icon: 'fas fa-home', action: 'Calculate Now' },
                  { id: 'excavation-calculator', title: 'Excavation Calculator', description: 'Calculate excavation volume.', icon: 'fas fa-industry', action: 'Calculate Now' },
                ]
              },
              'finishing-work': {
                name: 'ðŸŽ¨ Finishing Work',
                icon: 'fas fa-paint-roller',
                calculators: [
                  { id: 'paint-calculator', title: 'Paint Calculator', description: 'Estimate paint quantity needed.', icon: 'fas fa-paint-roller', action: 'Calculate Now' },
                  { id: 'tile-calculator', title: 'Tile Calculator', description: 'Calculate tiles needed for flooring.', icon: 'fas fa-th', action: 'Calculate Now' },
                  { id: 'wallpaper-calculator', title: 'Wallpaper Calculator', description: 'Calculate wallpaper rolls needed.', icon: 'fas fa-image', action: 'Calculate Now' },
                  { id: 'flooring-calculator', title: 'Flooring Calculator', description: 'Calculate flooring materials needed.', icon: 'fas fa-grip-horizontal', action: 'Calculate Now' },
                ]
              },
            }
          },
          physics: {
            subcategories: {
              'mechanics-motion': {
                name: 'âš¡ Mechanics & Motion',
                icon: 'fas fa-tachometer-alt',
                calculators: [
                  { id: 'velocity-calculator', title: 'Velocity Calculator', description: 'Calculate velocity from distance and time.', icon: 'fas fa-tachometer-alt', action: 'Calculate Now' },
                  { id: 'force-calculator', title: 'Force Calculator', description: 'Calculate force using mass and acceleration.', icon: 'fas fa-atom', action: 'Calculate Now' },
                  { id: 'acceleration-calculator', title: 'Acceleration Calculator', description: 'Calculate acceleration from velocity change.', icon: 'fas fa-rocket', action: 'Calculate Now' },
                  { id: 'momentum-calculator', title: 'Momentum Calculator', description: 'Calculate momentum of objects.', icon: 'fas fa-car', action: 'Calculate Now' },
                ]
              },
              'energy-power': {
                name: 'âš¡ Energy & Power',
                icon: 'fas fa-bolt',
                calculators: [
                  { id: 'kinetic-energy', title: 'Kinetic Energy Calculator', description: 'Calculate kinetic energy of moving objects.', icon: 'fas fa-running', action: 'Calculate Now' },
                  { id: 'potential-energy', title: 'Potential Energy Calculator', description: 'Calculate gravitational potential energy.', icon: 'fas fa-mountain', action: 'Calculate Now' },
                  { id: 'power-calculator', title: 'Power Calculator', description: 'Calculate power from work and time.', icon: 'fas fa-bolt', action: 'Calculate Now' },
                  { id: 'work-calculator', title: 'Work Calculator', description: 'Calculate work done by force.', icon: 'fas fa-weight-hanging', action: 'Calculate Now' },
                ]
              },
              'electricity': {
                name: 'ðŸ”Œ Electricity & Electronics',
                icon: 'fas fa-plug',
                calculators: [
                  { id: 'ohms-law', title: "Ohm's Law Calculator", description: 'Calculate voltage, current, and resistance.', icon: 'fas fa-bolt', action: 'Calculate Now' },
                  { id: 'power-consumption', title: 'Power Consumption Calculator', description: 'Calculate electrical power usage.', icon: 'fas fa-lightbulb', action: 'Calculate Now' },
                  { id: 'resistance-calculator', title: 'Resistance Calculator', description: 'Calculate series and parallel resistance.', icon: 'fas fa-minus-circle', action: 'Calculate Now' },
                  { id: 'capacitance-calculator', title: 'Capacitance Calculator', description: 'Calculate capacitor values.', icon: 'fas fa-battery-full', action: 'Calculate Now' },
                ]
              },
            }
          },
          business: {
            subcategories: {
              'profit-analysis': {
                name: 'ðŸ’° Profit & Margin Analysis',
                icon: 'fas fa-chart-line',
                calculators: [
                  { id: 'profit-margin-calculator', title: 'Profit Margin Calculator', description: 'Calculate gross and net profit margins.', icon: 'fas fa-percentage', action: 'Calculate Now' },
                  { id: 'break-even-calculator', title: 'Break-Even Point Calculator', description: 'Find when revenue equals costs.', icon: 'fas fa-balance-scale', action: 'Calculate Now' },
                  { id: 'markup-margin-converter', title: 'Markup vs Margin Converter', description: 'Convert between markup and margin.', icon: 'fas fa-exchange-alt', action: 'Calculate Now' },
                  { id: 'roi-calculator', title: 'ROI on Campaigns', description: 'Calculate return on investment.', icon: 'fas fa-bullseye', action: 'Calculate Now' },
                ]
              },
              'pricing-cost': {
                name: 'ðŸ’µ Pricing & Cost Management',
                icon: 'fas fa-dollar-sign',
                calculators: [
                  { id: 'cost-vs-selling-price', title: 'Cost vs Selling Price Calculator', description: 'Calculate optimal selling prices.', icon: 'fas fa-tags', action: 'Calculate Now' },
                  { id: 'inventory-cost-estimator', title: 'Inventory Cost Estimator', description: 'Estimate inventory holding costs.', icon: 'fas fa-boxes', action: 'Calculate Now' },
                  { id: 'pricing-strategy-tool', title: 'Pricing Strategy Tool', description: 'Determine competitive pricing.', icon: 'fas fa-hand-holding-usd', action: 'Calculate Now' },
                ]
              },
              'valuation-equity': {
                name: 'ðŸ“Š Equity & Valuation',
                icon: 'fas fa-chart-pie',
                calculators: [
                  { id: 'equity-valuation-calculator', title: 'Equity & Valuation Calculator', description: 'Calculate business equity value.', icon: 'fas fa-building', action: 'Calculate Now' },
                  { id: 'company-valuation', title: 'Company Valuation Tool', description: 'Estimate company worth.', icon: 'fas fa-briefcase', action: 'Calculate Now' },
                  { id: 'stock-valuation', title: 'Stock Valuation Calculator', description: 'Calculate stock fair value.', icon: 'fas fa-chart-area', action: 'Calculate Now' },
                ]
              },
              'freelance-rates': {
                name: 'ðŸ’¼ Freelance & Consulting',
                icon: 'fas fa-user-tie',
                calculators: [
                  { id: 'freelancer-hourly-rate', title: 'Freelancer Hourly Rate Tool', description: 'Calculate your ideal hourly rate.', icon: 'fas fa-clock', action: 'Calculate Now' },
                  { id: 'project-pricing-calculator', title: 'Project Pricing Calculator', description: 'Price projects accurately.', icon: 'fas fa-file-invoice-dollar', action: 'Calculate Now' },
                  { id: 'consultant-rate-calculator', title: 'Consultant Rate Calculator', description: 'Set consulting fees.', icon: 'fas fa-handshake', action: 'Calculate Now' },
                ]
              },
            }
          },
          everyday: {
            subcategories: {
              'food-dining': {
                name: 'ðŸ½ï¸ Food & Dining',
                icon: 'fas fa-utensils',
                calculators: [
                  { id: 'tip-calculator', title: 'Tip Calculator', description: 'Calculate tips and split bills.', icon: 'fas fa-hand-holding-heart', action: 'Calculate Now' },
                  { id: 'recipe-converter', title: 'Recipe Converter', description: 'Convert recipe quantities.', icon: 'fas fa-book-open', action: 'Calculate Now' },
                  { id: 'serving-size-calculator', title: 'Serving Size Calculator', description: 'Adjust recipe for different servings.', icon: 'fas fa-users', action: 'Calculate Now' },
                  { id: 'cooking-time-calculator', title: 'Cooking Time Calculator', description: 'Calculate cooking times for recipes.', icon: 'fas fa-clock', action: 'Calculate Now' },
                ]
              },
              'conversion-tools': {
                name: 'ðŸ”„ Conversion Tools',
                icon: 'fas fa-exchange-alt',
                calculators: [
                  { id: 'unit-converter', title: 'Unit Converter', description: 'Convert between different units.', icon: 'fas fa-exchange-alt', action: 'Calculate Now' },
                  { id: 'temperature-converter', title: 'Temperature Converter', description: 'Convert Celsius, Fahrenheit, Kelvin.', icon: 'fas fa-thermometer-half', action: 'Calculate Now' },
                  { id: 'currency-converter', title: 'Currency Converter', description: 'Convert between currencies.', icon: 'fas fa-money-bill-wave', action: 'Calculate Now' },
                  { id: 'length-converter', title: 'Length Converter', description: 'Convert meters, feet, inches, etc.', icon: 'fas fa-ruler', action: 'Calculate Now' },
                ]
              },
              'shopping-budgeting': {
                name: 'ðŸ›’ Shopping & Budgeting',
                icon: 'fas fa-shopping-cart',
                calculators: [
                  { id: 'discount-calculator', title: 'Discount Calculator', description: 'Calculate sale prices and savings.', icon: 'fas fa-tags', action: 'Calculate Now' },
                  { id: 'sales-tax-calculator', title: 'Sales Tax Calculator', description: 'Calculate tax on purchases.', icon: 'fas fa-receipt', action: 'Calculate Now' },
                  { id: 'price-comparison', title: 'Price Comparison Calculator', description: 'Compare unit prices.', icon: 'fas fa-balance-scale', action: 'Calculate Now' },
                  { id: 'budget-calculator', title: 'Budget Calculator', description: 'Plan and track your budget.', icon: 'fas fa-wallet', action: 'Calculate Now' },
                ]
              },
            }
          },
          education: {
            subcategories: {
              'academic-grades': {
                name: 'ðŸŽ“ Academic & Grades',
                icon: 'fas fa-graduation-cap',
                calculators: [
                  { id: 'gpa-calculator', title: 'GPA Calculator', description: 'Calculate your Grade Point Average.', icon: 'fas fa-graduation-cap', action: 'Calculate Now' },
                  { id: 'grade-calculator', title: 'Grade Calculator', description: 'Calculate your final grade.', icon: 'fas fa-award', action: 'Calculate Now' },
                  { id: 'percentage-calculator', title: 'Percentage Grade Calculator', description: 'Convert marks to percentage.', icon: 'fas fa-percent', action: 'Calculate Now' },
                  { id: 'cgpa-calculator', title: 'CGPA Calculator', description: 'Calculate cumulative GPA.', icon: 'fas fa-chart-line', action: 'Calculate Now' },
                ]
              },
              'test-preparation': {
                name: 'ðŸ“ Test & Preparation',
                icon: 'fas fa-clipboard-check',
                calculators: [
                  { id: 'study-time-calculator', title: 'Study Time Calculator', description: 'Plan your study schedule.', icon: 'fas fa-clock', action: 'Calculate Now' },
                  { id: 'exam-score-calculator', title: 'Exam Score Calculator', description: 'Calculate required exam scores.', icon: 'fas fa-file-alt', action: 'Calculate Now' },
                  { id: 'reading-time-calculator', title: 'Reading Time Calculator', description: 'Estimate time to read books.', icon: 'fas fa-book-reader', action: 'Calculate Now' },
                ]
              },
            }
          },
          technology: {
            subcategories: {
              'networking': {
                name: 'ðŸŒ Networking & Internet',
                icon: 'fas fa-network-wired',
                calculators: [
                  { id: 'bandwidth-calculator', title: 'Bandwidth Calculator', description: 'Calculate network bandwidth requirements.', icon: 'fas fa-wifi', action: 'Calculate Now' },
                  { id: 'ip-subnet-calculator', title: 'IP Subnet Calculator', description: 'Calculate IP subnets and ranges.', icon: 'fas fa-server', action: 'Calculate Now' },
                  { id: 'download-time-calculator', title: 'Download Time Calculator', description: 'Estimate file download time.', icon: 'fas fa-download', action: 'Calculate Now' },
                ]
              },
              'security': {
                name: 'ðŸ” Security & Privacy',
                icon: 'fas fa-shield-alt',
                calculators: [
                  { id: 'password-strength', title: 'Password Strength Checker', description: 'Check password security strength.', icon: 'fas fa-lock', action: 'Calculate Now' },
                  { id: 'password-generator', title: 'Password Generator', description: 'Generate secure random passwords.', icon: 'fas fa-key', action: 'Calculate Now' },
                  { id: 'encryption-calculator', title: 'Encryption Calculator', description: 'Calculate encryption strength.', icon: 'fas fa-user-secret', action: 'Calculate Now' },
                ]
              },
              'storage-data': {
                name: 'ðŸ’¾ Storage & Data',
                icon: 'fas fa-hdd',
                calculators: [
                  { id: 'file-size-converter', title: 'File Size Converter', description: 'Convert bytes, KB, MB, GB, TB.', icon: 'fas fa-file', action: 'Calculate Now' },
                  { id: 'storage-calculator', title: 'Storage Calculator', description: 'Calculate storage requirements.', icon: 'fas fa-hdd', action: 'Calculate Now' },
                  { id: 'data-transfer-calculator', title: 'Data Transfer Calculator', description: 'Calculate data transfer rates.', icon: 'fas fa-exchange-alt', action: 'Calculate Now' },
                ]
              },
            }
          },
          scientific: {
            subcategories: {
              'physics': {
                name: 'âš›ï¸ Physics Calculators',
                icon: 'fas fa-atom',
                calculators: [
                  { id: 'velocity-calculator', title: 'Velocity Calculator', description: 'Calculate velocity and speed.', icon: 'fas fa-tachometer-alt', action: 'Calculate Now' },
                  { id: 'acceleration-calculator', title: 'Acceleration Calculator', description: 'Calculate acceleration.', icon: 'fas fa-rocket', action: 'Calculate Now' },
                  { id: 'force-calculator', title: 'Force Calculator', description: 'Calculate force (F = ma).', icon: 'fas fa-hand-rock', action: 'Calculate Now' },
                  { id: 'kinetic-energy-calculator', title: 'Kinetic Energy Calculator', description: 'Calculate kinetic energy.', icon: 'fas fa-bolt', action: 'Calculate Now' },
                  { id: 'potential-energy-calculator', title: 'Potential Energy Calculator', description: 'Calculate potential energy.', icon: 'fas fa-arrow-up', action: 'Calculate Now' },
                  { id: 'work-calculator', title: 'Work Calculator', description: 'Calculate work done.', icon: 'fas fa-tools', action: 'Calculate Now' },
                  { id: 'power-calculator', title: 'Power Calculator', description: 'Calculate power output.', icon: 'fas fa-plug', action: 'Calculate Now' },
                  { id: 'momentum-calculator', title: 'Momentum Calculator', description: 'Calculate momentum.', icon: 'fas fa-running', action: 'Calculate Now' },
                ]
              },
              'chemistry': {
                name: 'ðŸ§ª Chemistry Calculators',
                icon: 'fas fa-flask',
                calculators: [
                  { id: 'mole-calculator', title: 'Mole Calculator', description: 'Calculate moles and molecular mass.', icon: 'fas fa-atom', action: 'Calculate Now' },
                  { id: 'concentration-calculator', title: 'Concentration Calculator', description: 'Calculate solution concentrations.', icon: 'fas fa-flask', action: 'Calculate Now' },
                  { id: 'ph-calculator', title: 'pH Calculator', description: 'Calculate pH and pOH values.', icon: 'fas fa-vial', action: 'Calculate Now' },
                  { id: 'molarity-calculator', title: 'Molarity Calculator', description: 'Calculate molarity of solutions.', icon: 'fas fa-flask', action: 'Calculate Now' },
                  { id: 'dilution-calculator', title: 'Dilution Calculator', description: 'Calculate dilution ratios.', icon: 'fas fa-tint', action: 'Calculate Now' },
                  { id: 'stoichiometry-calculator', title: 'Stoichiometry Calculator', description: 'Calculate stoichiometric ratios.', icon: 'fas fa-balance-scale', action: 'Calculate Now' },
                ]
              },
              'astronomy-space': {
                name: 'ðŸš€ Astronomy & Space',
                icon: 'fas fa-rocket',
                calculators: [
                  { id: 'astronomical-calculator', title: 'Astronomical Calculator', description: 'Calculate astronomical distances.', icon: 'fas fa-rocket', action: 'Calculate Now' },
                  { id: 'light-year-calculator', title: 'Light Year Calculator', description: 'Convert light years to other units.', icon: 'fas fa-star', action: 'Calculate Now' },
                  { id: 'planet-weight-calculator', title: 'Planet Weight Calculator', description: 'Calculate weight on different planets.', icon: 'fas fa-globe', action: 'Calculate Now' },
                ]
              },
              'scientific-notation': {
                name: 'ðŸ”¬ Scientific Notation & Units',
                icon: 'fas fa-microscope',
                calculators: [
                  { id: 'scientific-notation-calculator', title: 'Scientific Notation Calculator', description: 'Convert to scientific notation.', icon: 'fas fa-microscope', action: 'Calculate Now' },
                  { id: 'unit-converter', title: 'Unit Converter', description: 'Convert between different units.', icon: 'fas fa-exchange-alt', action: 'Calculate Now' },
                ]
              },
            }
          }
        };
        
        // --- NEW: Calculator Implementation Hub ---
        // This is where you add the logic for each calculator.
        const calculatorImplementations = {
            'mortgage-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="loanAmount">Loan Amount ($)</label>
                            <input type="number" id="loanAmount" value="300000" placeholder="e.g., 300000">
                        </div>
                        <div class="form-group">
                            <label for="interestRate">Interest Rate (%)</label>
                            <input type="number" id="interestRate" value="6.5" step="0.01" placeholder="e.g., 6.5">
                        </div>
                        <div class="form-group">
                            <label for="loanTerm">Loan Term (years)</label>
                            <input type="number" id="loanTerm" value="30" placeholder="e.g., 30">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Monthly Payment</p>
                            <p class="result-value" id="resultValue">$0.00</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const P = parseFloat(modal.querySelector('#loanAmount').value);
                        const annualRate = parseFloat(modal.querySelector('#interestRate').value);
                        const termYears = parseFloat(modal.querySelector('#loanTerm').value);
                        
                        if (P > 0 && annualRate > 0 && termYears > 0) {
                            const i = annualRate / 100 / 12;
                            const n = termYears * 12;
                            const M = P * (i * Math.pow(1 + i, n)) / (Math.pow(1 + i, n) - 1);
                            
                            modal.querySelector('#resultValue').textContent = M.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                            modal.querySelector('#resultInterpretation').textContent = '';
                            
                            // Track calculation
                            Analytics.trackCalculation('mortgage-calculator');
                        } else {
                            modal.querySelector('#resultValue').textContent = '$0.00';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter valid loan details.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    calculate(); // Initial calculation
                }
            },
            'bmi-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="height">Height (cm)</label>
                            <input type="number" id="height" value="175" placeholder="e.g., 175">
                        </div>
                        <div class="form-group">
                            <label for="weight">Weight (kg)</label>
                            <input type="number" id="weight" value="70" placeholder="e.g., 70">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Your BMI</p>
                            <p class="result-value" id="resultValue">--</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const heightCm = parseFloat(modal.querySelector('#height').value);
                        const weightKg = parseFloat(modal.querySelector('#weight').value);

                        if (heightCm > 0 && weightKg > 0) {
                            const heightM = heightCm / 100;
                            const bmi = weightKg / (heightM * heightM);
                            
                            let interpretation = 'Based on your BMI, you are in the ';
                            if (bmi < 18.5) interpretation += 'Underweight range.';
                            else if (bmi < 25) interpretation += 'Normal weight range.';
                            else if (bmi < 30) interpretation += 'Overweight range.';
                            else interpretation += 'Obesity range.';
                            
                            modal.querySelector('#resultValue').textContent = bmi.toFixed(1);
                            modal.querySelector('#resultInterpretation').textContent = interpretation + ' This is an estimate, consult a healthcare professional for advice.';
                        } else {
                            modal.querySelector('#resultValue').textContent = '--';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter a valid height and weight.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    calculate();
                }
            },
            'age-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="birthDate">Enter Your Date of Birth</label>
                            <input type="date" id="birthDate" required>
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Your Age Is</p>
                            <p class="result-value" id="resultValue">--</p>
                            <p class="result-interpretation" id="resultInterpretation">Enter your date of birth to calculate your age.</p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const birthDateInput = modal.querySelector('#birthDate');
                    
                    // Set max date to today and a reasonable default (20 years ago)
                    const today = new Date();
                    const defaultDate = new Date(today.getFullYear() - 20, today.getMonth(), today.getDate());
                    const formattedToday = today.toISOString().split('T')[0];
                    const formattedDefault = defaultDate.toISOString().split('T')[0];
                    
                    birthDateInput.max = formattedToday;
                    birthDateInput.value = formattedDefault;
                    
                    const calculate = () => {
                        if (!birthDateInput.value) {
                            modal.querySelector('#resultValue').textContent = '--';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter your date of birth.';
                            return;
                        }

                        const birthDate = new Date(birthDateInput.value);
                        const currentDate = new Date();
                        
                        // Check if birth date is in the future
                        if (birthDate > currentDate) {
                            modal.querySelector('#resultValue').textContent = '--';
                            modal.querySelector('#resultInterpretation').textContent = 'Birth date cannot be in the future.';
                            return;
                        }
                        
                        // Calculate difference
                        let years = currentDate.getFullYear() - birthDate.getFullYear();
                        let months = currentDate.getMonth() - birthDate.getMonth();
                        let days = currentDate.getDate() - birthDate.getDate();
                        
                        // Adjust for negative days
                        if (days < 0) {
                            months--;
                            // Get days in previous month
                            const prevMonth = new Date(currentDate.getFullYear(), currentDate.getMonth(), 0);
                            days += prevMonth.getDate();
                        }
                        
                        // Adjust for negative months
                        if (months < 0) {
                            years--;
                            months += 12;
                        }
                        
                        // Format the result
                        const yearText = years === 1 ? 'year' : 'years';
                        const monthText = months === 1 ? 'month' : 'months';
                        const dayText = days === 1 ? 'day' : 'days';
                        
                        modal.querySelector('#resultValue').textContent = `${years} ${yearText}, ${months} ${monthText}, ${days} ${dayText}`;
                        modal.querySelector('#resultInterpretation').textContent = `Calculated as of ${currentDate.toLocaleDateString()}`;
                    };
                    
                    form.addEventListener('input', calculate);
                    calculate(); // Initial calculation
                }
            },
            'percentage-calculator': {
                 getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                             <select id="calcMode">
                                <option value="p_of_n">What is X % of Y?</option>
                                <option value="n_is_p_of">X is what % of Y?</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="val1" id="label1">Percentage (X)</label>
                            <input type="number" id="val1" placeholder="e.g., 15">
                        </div>
                        <div class="form-group">
                            <label for="val2" id="label2">Total Number (Y)</label>
                            <input type="number" id="val2" placeholder="e.g., 200">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Result</p>
                            <p class="result-value" id="resultValue">--</p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const modeSelect = modal.querySelector('#calcMode');
                    const label1 = modal.querySelector('#label1');
                    const label2 = modal.querySelector('#label2');

                    const updateLabels = () => {
                        if (modeSelect.value === 'p_of_n') {
                            label1.textContent = 'Percentage (X)';
                            label2.textContent = 'Total Number (Y)';
                        } else {
                            label1.textContent = 'Part Number (X)';
                            label2.textContent = 'Total Number (Y)';
                        }
                    };
                    
                    const calculate = () => {
                        const val1 = parseFloat(modal.querySelector('#val1').value);
                        const val2 = parseFloat(modal.querySelector('#val2').value);
                        let result = '--';

                        if (!isNaN(val1) && !isNaN(val2)) {
                            if (modeSelect.value === 'p_of_n') {
                                result = (val1 / 100) * val2;
                            } else if (val2 !== 0) {
                                result = `${(val1 / val2) * 100}%`;
                            } else {
                                result = 'Error';
                            }
                        }
                        modal.querySelector('#resultValue').textContent = result;
                    };
                    
                    modeSelect.addEventListener('change', () => {
                        updateLabels();
                        calculate();
                    });
                    form.addEventListener('input', calculate);
                    updateLabels();
                }
            },
            'loan-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="principal">Loan Amount ($)</label>
                            <input type="number" id="principal" value="10000" placeholder="e.g., 10000">
                        </div>
                        <div class="form-group">
                            <label for="rate">Annual Interest Rate (%)</label>
                            <input type="number" id="rate" value="5" step="0.1" placeholder="e.g., 5">
                        </div>
                        <div class="form-group">
                            <label for="years">Loan Term (years)</label>
                            <input type="number" id="years" value="5" placeholder="e.g., 5">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Monthly Payment</p>
                            <p class="result-value" id="resultValue">$0.00</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const P = parseFloat(modal.querySelector('#principal').value);
                        const r = parseFloat(modal.querySelector('#rate').value) / 100 / 12;
                        const n = parseFloat(modal.querySelector('#years').value) * 12;
                        
                        if (P > 0 && r > 0 && n > 0) {
                            const M = P * (r * Math.pow(1 + r, n)) / (Math.pow(1 + r, n) - 1);
                            const total = M * n;
                            const interest = total - P;
                            
                            modal.querySelector('#resultValue').textContent = M.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                            modal.querySelector('#resultInterpretation').textContent = 
                                `Total Payment: ${total.toLocaleString('en-US', { style: 'currency', currency: 'USD' })} | Total Interest: ${interest.toLocaleString('en-US', { style: 'currency', currency: 'USD' })}`;
                        } else {
                            modal.querySelector('#resultValue').textContent = '$0.00';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter valid loan details.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    calculate();
                }
            },
            'gst-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label>Calculation Type</label>
                            <select id="gstType">
                                <option value="add">Add GST to Amount</option>
                                <option value="remove">Remove GST from Amount</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="amount">Amount ($)</label>
                            <input type="number" id="amount" value="1000" placeholder="e.g., 1000">
                        </div>
                        <div class="form-group">
                            <label for="gstRate">GST Rate (%)</label>
                            <input type="number" id="gstRate" value="18" step="0.1" placeholder="e.g., 18">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Result</p>
                            <p class="result-value" id="resultValue">$0.00</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const amount = parseFloat(modal.querySelector('#amount').value);
                        const gstRate = parseFloat(modal.querySelector('#gstRate').value);
                        const type = modal.querySelector('#gstType').value;
                        
                        if (amount > 0 && gstRate >= 0) {
                            let result, gstAmount, finalAmount;
                            
                            if (type === 'add') {
                                gstAmount = (amount * gstRate) / 100;
                                finalAmount = amount + gstAmount;
                                modal.querySelector('#resultValue').textContent = finalAmount.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                                modal.querySelector('#resultInterpretation').textContent = 
                                    `Original: ${amount.toLocaleString('en-US', { style: 'currency', currency: 'USD' })} | GST (${gstRate}%): ${gstAmount.toLocaleString('en-US', { style: 'currency', currency: 'USD' })}`;
                            } else {
                                finalAmount = amount / (1 + gstRate / 100);
                                gstAmount = amount - finalAmount;
                                modal.querySelector('#resultValue').textContent = finalAmount.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                                modal.querySelector('#resultInterpretation').textContent = 
                                    `Amount without GST | GST (${gstRate}%): ${gstAmount.toLocaleString('en-US', { style: 'currency', currency: 'USD' })}`;
                            }
                        } else {
                            modal.querySelector('#resultValue').textContent = '$0.00';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter valid values.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    modal.querySelector('#gstType').addEventListener('change', calculate);
                    calculate();
                }
            },
            'calorie-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="gender">Gender</label>
                            <select id="gender">
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="age">Age (years)</label>
                            <input type="number" id="age" value="30" placeholder="e.g., 30">
                        </div>
                        <div class="form-group">
                            <label for="weight">Weight (kg)</label>
                            <input type="number" id="weight" value="70" placeholder="e.g., 70">
                        </div>
                        <div class="form-group">
                            <label for="height">Height (cm)</label>
                            <input type="number" id="height" value="170" placeholder="e.g., 170">
                        </div>
                        <div class="form-group">
                            <label for="activity">Activity Level</label>
                            <select id="activity">
                                <option value="1.2">Sedentary (little or no exercise)</option>
                                <option value="1.375">Light (exercise 1-3 days/week)</option>
                                <option value="1.55" selected>Moderate (exercise 3-5 days/week)</option>
                                <option value="1.725">Active (exercise 6-7 days/week)</option>
                                <option value="1.9">Very Active (intense exercise daily)</option>
                            </select>
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Daily Calorie Needs</p>
                            <p class="result-value" id="resultValue">-- kcal</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const gender = modal.querySelector('#gender').value;
                        const age = parseFloat(modal.querySelector('#age').value);
                        const weight = parseFloat(modal.querySelector('#weight').value);
                        const height = parseFloat(modal.querySelector('#height').value);
                        const activity = parseFloat(modal.querySelector('#activity').value);
                        
                        if (age > 0 && weight > 0 && height > 0) {
                            let bmr;
                            // Mifflin-St Jeor Equation
                            if (gender === 'male') {
                                bmr = (10 * weight) + (6.25 * height) - (5 * age) + 5;
                            } else {
                                bmr = (10 * weight) + (6.25 * height) - (5 * age) - 161;
                            }
                            
                            const tdee = Math.round(bmr * activity);
                            const weightLoss = Math.round(tdee - 500);
                            const weightGain = Math.round(tdee + 500);
                            
                            modal.querySelector('#resultValue').textContent = `${tdee} kcal`;
                            modal.querySelector('#resultInterpretation').textContent = 
                                `Weight Loss: ${weightLoss} kcal/day | Weight Gain: ${weightGain} kcal/day`;
                        } else {
                            modal.querySelector('#resultValue').textContent = '-- kcal';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter valid details.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    form.addEventListener('change', calculate);
                    calculate();
                }
            },
            'tip-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="billAmount">Bill Amount ($)</label>
                            <input type="number" id="billAmount" value="100" step="0.01" placeholder="e.g., 100">
                        </div>
                        <div class="form-group">
                            <label for="tipPercent">Tip Percentage (%)</label>
                            <input type="number" id="tipPercent" value="15" step="1" placeholder="e.g., 15">
                        </div>
                        <div class="form-group">
                            <label for="numPeople">Number of People</label>
                            <input type="number" id="numPeople" value="1" min="1" placeholder="e.g., 2">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Total Amount</p>
                            <p class="result-value" id="resultValue">$0.00</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const bill = parseFloat(modal.querySelector('#billAmount').value);
                        const tipPercent = parseFloat(modal.querySelector('#tipPercent').value);
                        const people = parseInt(modal.querySelector('#numPeople').value);
                        
                        if (bill > 0 && tipPercent >= 0 && people > 0) {
                            const tipAmount = (bill * tipPercent) / 100;
                            const totalAmount = bill + tipAmount;
                            const perPerson = totalAmount / people;
                            
                            modal.querySelector('#resultValue').textContent = totalAmount.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                            modal.querySelector('#resultInterpretation').textContent = 
                                `Tip: ${tipAmount.toLocaleString('en-US', { style: 'currency', currency: 'USD' })} | Per Person: ${perPerson.toLocaleString('en-US', { style: 'currency', currency: 'USD' })}`;
                        } else {
                            modal.querySelector('#resultValue').textContent = '$0.00';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter valid values.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    calculate();
                }
            },
            'gpa-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label>Add Your Courses</label>
                            <div id="coursesList"></div>
                            <button type="button" id="addCourse" class="tool-action" style="width: 100%; margin-top: 12px;">
                                <i class="fas fa-plus"></i> Add Course
                            </button>
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Your GPA</p>
                            <p class="result-value" id="resultValue">0.00</p>
                            <p class="result-interpretation" id="resultInterpretation">Add courses to calculate your GPA</p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const coursesList = modal.querySelector('#coursesList');
                    const addButton = modal.querySelector('#addCourse');
                    let courseCount = 0;
                    
                    const gradePoints = {
                        'A+': 4.0, 'A': 4.0, 'A-': 3.7,
                        'B+': 3.3, 'B': 3.0, 'B-': 2.7,
                        'C+': 2.3, 'C': 2.0, 'C-': 1.7,
                        'D+': 1.3, 'D': 1.0, 'F': 0.0
                    };
                    
                    const addCourse = () => {
                        courseCount++;
                        const courseDiv = document.createElement('div');
                        courseDiv.className = 'form-group';
                        courseDiv.style.border = '1px solid var(--bg-tertiary)';
                        courseDiv.style.padding = '12px';
                        courseDiv.style.borderRadius = '8px';
                        courseDiv.style.marginBottom = '12px';
                        courseDiv.innerHTML = `
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <strong>Course ${courseCount}</strong>
                                <button type="button" class="removeCourse" style="background: var(--accent-pink); color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer;">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                                <select class="grade" style="width: 100%; padding: 8px; border: 1px solid var(--bg-tertiary); background: var(--bg-primary); border-radius: 6px; color: var(--text-primary);">
                                    <option value="">Select Grade</option>
                                    ${Object.keys(gradePoints).map(g => `<option value="${g}">${g}</option>`).join('')}
                                </select>
                                <input type="number" class="credits" min="1" max="10" value="3" placeholder="Credits" style="width: 100%; padding: 8px; border: 1px solid var(--bg-tertiary); background: var(--bg-primary); border-radius: 6px; color: var(--text-primary);">
                            </div>
                        `;
                        coursesList.appendChild(courseDiv);
                        
                        courseDiv.querySelector('.removeCourse').addEventListener('click', () => {
                            courseDiv.remove();
                            calculate();
                        });
                        
                        courseDiv.querySelector('.grade').addEventListener('change', calculate);
                        courseDiv.querySelector('.credits').addEventListener('input', calculate);
                    };
                    
                    const calculate = () => {
                        const courses = coursesList.querySelectorAll('.form-group');
                        let totalPoints = 0;
                        let totalCredits = 0;
                        
                        courses.forEach(course => {
                            const grade = course.querySelector('.grade').value;
                            const credits = parseFloat(course.querySelector('.credits').value);
                            
                            if (grade && credits > 0) {
                                totalPoints += gradePoints[grade] * credits;
                                totalCredits += credits;
                            }
                        });
                        
                        if (totalCredits > 0) {
                            const gpa = (totalPoints / totalCredits).toFixed(2);
                            modal.querySelector('#resultValue').textContent = gpa;
                            modal.querySelector('#resultInterpretation').textContent = 
                                `Based on ${courses.length} course${courses.length !== 1 ? 's' : ''} (${totalCredits} credits)`;
                        } else {
                            modal.querySelector('#resultValue').textContent = '0.00';
                            modal.querySelector('#resultInterpretation').textContent = 'Add courses with grades and credits';
                        }
                    };
                    
                    addButton.addEventListener('click', addCourse);
                    
                    // Add 2 default courses
                    addCourse();
                    addCourse();
                }
            },
            'compound-interest': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="principal">Principal Amount ($)</label>
                            <input type="number" id="principal" value="10000" placeholder="e.g., 10000">
                        </div>
                        <div class="form-group">
                            <label for="rate">Annual Interest Rate (%)</label>
                            <input type="number" id="rate" value="5" step="0.1" placeholder="e.g., 5">
                        </div>
                        <div class="form-group">
                            <label for="time">Time Period (years)</label>
                            <input type="number" id="time" value="10" placeholder="e.g., 10">
                        </div>
                        <div class="form-group">
                            <label for="compound">Compound Frequency</label>
                            <select id="compound">
                                <option value="1">Annually</option>
                                <option value="2">Semi-Annually</option>
                                <option value="4">Quarterly</option>
                                <option value="12" selected>Monthly</option>
                                <option value="365">Daily</option>
                            </select>
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Future Value</p>
                            <p class="result-value" id="resultValue">$0.00</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const P = parseFloat(modal.querySelector('#principal').value);
                        const r = parseFloat(modal.querySelector('#rate').value) / 100;
                        const t = parseFloat(modal.querySelector('#time').value);
                        const n = parseFloat(modal.querySelector('#compound').value);
                        
                        if (P > 0 && r >= 0 && t > 0) {
                            const A = P * Math.pow((1 + r / n), n * t);
                            const interest = A - P;
                            
                            modal.querySelector('#resultValue').textContent = A.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                            modal.querySelector('#resultInterpretation').textContent = 
                                `Principal: ${P.toLocaleString('en-US', { style: 'currency', currency: 'USD' })} | Interest Earned: ${interest.toLocaleString('en-US', { style: 'currency', currency: 'USD' })}`;
                        } else {
                            modal.querySelector('#resultValue').textContent = '$0.00';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter valid values.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    form.addEventListener('change', calculate);
                    calculate();
                }
            },
            'simple-interest': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="principal">Principal Amount ($)</label>
                            <input type="number" id="principal" value="10000" placeholder="e.g., 10000">
                        </div>
                        <div class="form-group">
                            <label for="rate">Annual Interest Rate (%)</label>
                            <input type="number" id="rate" value="5" step="0.1" placeholder="e.g., 5">
                        </div>
                        <div class="form-group">
                            <label for="time">Time Period (years)</label>
                            <input type="number" id="time" value="5" placeholder="e.g., 5">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Simple Interest</p>
                            <p class="result-value" id="resultValue">$0.00</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const P = parseFloat(modal.querySelector('#principal').value);
                        const r = parseFloat(modal.querySelector('#rate').value) / 100;
                        const t = parseFloat(modal.querySelector('#time').value);
                        
                        if (P > 0 && r >= 0 && t > 0) {
                            const SI = P * r * t;
                            const total = P + SI;
                            
                            modal.querySelector('#resultValue').textContent = SI.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                            modal.querySelector('#resultInterpretation').textContent = 
                                `Total Amount: ${total.toLocaleString('en-US', { style: 'currency', currency: 'USD' })} (Principal + Interest)`;
                        } else {
                            modal.querySelector('#resultValue').textContent = '$0.00';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter valid values.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    calculate();
                }
            },
            'emi-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="loanAmount">Loan Amount ($)</label>
                            <input type="number" id="loanAmount" value="500000" placeholder="e.g., 500000">
                        </div>
                        <div class="form-group">
                            <label for="interestRate">Annual Interest Rate (%)</label>
                            <input type="number" id="interestRate" value="8.5" step="0.01" placeholder="e.g., 8.5">
                        </div>
                        <div class="form-group">
                            <label for="tenure">Loan Tenure (months)</label>
                            <input type="number" id="tenure" value="60" placeholder="e.g., 60">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Monthly EMI</p>
                            <p class="result-value" id="resultValue">$0.00</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const P = parseFloat(modal.querySelector('#loanAmount').value);
                        const r = parseFloat(modal.querySelector('#interestRate').value) / 100 / 12;
                        const n = parseFloat(modal.querySelector('#tenure').value);
                        
                        if (P > 0 && r > 0 && n > 0) {
                            const EMI = P * r * Math.pow(1 + r, n) / (Math.pow(1 + r, n) - 1);
                            const totalAmount = EMI * n;
                            const totalInterest = totalAmount - P;
                            
                            modal.querySelector('#resultValue').textContent = EMI.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                            modal.querySelector('#resultInterpretation').textContent = 
                                `Total Payment: ${totalAmount.toLocaleString('en-US', { style: 'currency', currency: 'USD' })} | Total Interest: ${totalInterest.toLocaleString('en-US', { style: 'currency', currency: 'USD' })}`;
                        } else {
                            modal.querySelector('#resultValue').textContent = '$0.00';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter valid values.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    calculate();
                }
            },
            'sip-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="monthlyInvestment">Monthly Investment ($)</label>
                            <input type="number" id="monthlyInvestment" value="5000" placeholder="e.g., 5000">
                        </div>
                        <div class="form-group">
                            <label for="expectedReturn">Expected Annual Return (%)</label>
                            <input type="number" id="expectedReturn" value="12" step="0.1" placeholder="e.g., 12">
                        </div>
                        <div class="form-group">
                            <label for="timePeriod">Time Period (years)</label>
                            <input type="number" id="timePeriod" value="10" placeholder="e.g., 10">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Future Value</p>
                            <p class="result-value" id="resultValue">$0.00</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const P = parseFloat(modal.querySelector('#monthlyInvestment').value);
                        const r = parseFloat(modal.querySelector('#expectedReturn').value) / 100 / 12;
                        const n = parseFloat(modal.querySelector('#timePeriod').value) * 12;
                        
                        if (P > 0 && r >= 0 && n > 0) {
                            const FV = P * ((Math.pow(1 + r, n) - 1) / r) * (1 + r);
                            const invested = P * n;
                            const returns = FV - invested;
                            
                            modal.querySelector('#resultValue').textContent = FV.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                            modal.querySelector('#resultInterpretation').textContent = 
                                `Invested: ${invested.toLocaleString('en-US', { style: 'currency', currency: 'USD' })} | Returns: ${returns.toLocaleString('en-US', { style: 'currency', currency: 'USD' })}`;
                        } else {
                            modal.querySelector('#resultValue').textContent = '$0.00';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter valid values.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    calculate();
                }
            },
            'bmr-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="gender">Gender</label>
                            <select id="gender">
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="age">Age (years)</label>
                            <input type="number" id="age" value="30" placeholder="e.g., 30">
                        </div>
                        <div class="form-group">
                            <label for="weight">Weight (kg)</label>
                            <input type="number" id="weight" value="70" placeholder="e.g., 70">
                        </div>
                        <div class="form-group">
                            <label for="height">Height (cm)</label>
                            <input type="number" id="height" value="170" placeholder="e.g., 170">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Basal Metabolic Rate (BMR)</p>
                            <p class="result-value" id="resultValue">-- kcal/day</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const gender = modal.querySelector('#gender').value;
                        const age = parseFloat(modal.querySelector('#age').value);
                        const weight = parseFloat(modal.querySelector('#weight').value);
                        const height = parseFloat(modal.querySelector('#height').value);
                        
                        if (age > 0 && weight > 0 && height > 0) {
                            let bmr;
                            // Mifflin-St Jeor Equation
                            if (gender === 'male') {
                                bmr = (10 * weight) + (6.25 * height) - (5 * age) + 5;
                            } else {
                                bmr = (10 * weight) + (6.25 * height) - (5 * age) - 161;
                            }
                            
                            modal.querySelector('#resultValue').textContent = `${Math.round(bmr)} kcal/day`;
                            modal.querySelector('#resultInterpretation').textContent = 
                                'This is the number of calories your body burns at rest. Multiply by activity level for total daily needs.';
                        } else {
                            modal.querySelector('#resultValue').textContent = '-- kcal/day';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter valid details.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    form.addEventListener('change', calculate);
                    calculate();
                }
            },
            'savings-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="initialDeposit">Initial Deposit ($)</label>
                            <input type="number" id="initialDeposit" value="1000" placeholder="e.g., 1000">
                        </div>
                        <div class="form-group">
                            <label for="monthlyContribution">Monthly Contribution ($)</label>
                            <input type="number" id="monthlyContribution" value="200" placeholder="e.g., 200">
                        </div>
                        <div class="form-group">
                            <label for="interestRate">Annual Interest Rate (%)</label>
                            <input type="number" id="interestRate" value="5" step="0.1" placeholder="e.g., 5">
                        </div>
                        <div class="form-group">
                            <label for="years">Time Period (years)</label>
                            <input type="number" id="years" value="10" placeholder="e.g., 10">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Future Savings</p>
                            <p class="result-value" id="resultValue">$0.00</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const P = parseFloat(modal.querySelector('#initialDeposit').value);
                        const PMT = parseFloat(modal.querySelector('#monthlyContribution').value);
                        const r = parseFloat(modal.querySelector('#interestRate').value) / 100 / 12;
                        const n = parseFloat(modal.querySelector('#years').value) * 12;
                        
                        if (P >= 0 && PMT >= 0 && r >= 0 && n > 0) {
                            // Future value of initial deposit
                            const FV_initial = P * Math.pow(1 + r, n);
                            // Future value of monthly contributions
                            const FV_contributions = PMT * ((Math.pow(1 + r, n) - 1) / r);
                            const totalSavings = FV_initial + FV_contributions;
                            const totalDeposited = P + (PMT * n);
                            const interestEarned = totalSavings - totalDeposited;
                            
                            modal.querySelector('#resultValue').textContent = totalSavings.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                            modal.querySelector('#resultInterpretation').textContent = 
                                `Deposited: ${totalDeposited.toLocaleString('en-US', { style: 'currency', currency: 'USD' })} | Interest: ${interestEarned.toLocaleString('en-US', { style: 'currency', currency: 'USD' })}`;
                        } else {
                            modal.querySelector('#resultValue').textContent = '$0.00';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter valid values.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    calculate();
                }
            },
            'date-difference-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="startDate">Start Date</label>
                            <input type="date" id="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="endDate">End Date</label>
                            <input type="date" id="endDate" required>
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Time Difference</p>
                            <p class="result-value" id="resultValue">--</p>
                            <p class="result-interpretation" id="resultInterpretation">Select both dates to calculate difference.</p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const startInput = modal.querySelector('#startDate');
                    const endInput = modal.querySelector('#endDate');
                    
                    // Set default dates (today and 30 days from now)
                    const today = new Date();
                    const futureDate = new Date(today.getFullYear(), today.getMonth(), today.getDate() + 30);
                    startInput.value = today.toISOString().split('T')[0];
                    endInput.value = futureDate.toISOString().split('T')[0];
                    
                    const calculate = () => {
                        if (!startInput.value || !endInput.value) {
                            modal.querySelector('#resultValue').textContent = '--';
                            modal.querySelector('#resultInterpretation').textContent = 'Please select both dates.';
                            return;
                        }

                        const start = new Date(startInput.value);
                        const end = new Date(endInput.value);
                        
                        const diffTime = Math.abs(end - start);
                        const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                        const diffWeeks = Math.floor(diffDays / 7);
                        const diffMonths = Math.floor(diffDays / 30.44); // Average days in month
                        const diffYears = Math.floor(diffDays / 365.25);
                        
                        let result = `${diffDays} days`;
                        let interpretation = `${diffWeeks} weeks | ${diffMonths} months | ${diffYears} years`;
                        
                        if (end < start) {
                            interpretation = 'End date is before start date. ' + interpretation;
                        }
                        
                        modal.querySelector('#resultValue').textContent = result;
                        modal.querySelector('#resultInterpretation').textContent = interpretation;
                    };
                    
                    form.addEventListener('input', calculate);
                    calculate();
                }
            },
            'discount-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="originalPrice">Original Price ($)</label>
                            <input type="number" id="originalPrice" value="100" step="0.01" placeholder="e.g., 100">
                        </div>
                        <div class="form-group">
                            <label for="discountPercent">Discount Percentage (%)</label>
                            <input type="number" id="discountPercent" value="20" step="0.1" placeholder="e.g., 20">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Final Price</p>
                            <p class="result-value" id="resultValue">$0.00</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const original = parseFloat(modal.querySelector('#originalPrice').value);
                        const discount = parseFloat(modal.querySelector('#discountPercent').value);
                        
                        if (original > 0 && discount >= 0 && discount <= 100) {
                            const discountAmount = (original * discount) / 100;
                            const finalPrice = original - discountAmount;
                            
                            modal.querySelector('#resultValue').textContent = finalPrice.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                            modal.querySelector('#resultInterpretation').textContent = 
                                `You save ${discountAmount.toLocaleString('en-US', { style: 'currency', currency: 'USD' })} (${discount}% off)`;
                        } else {
                            modal.querySelector('#resultValue').textContent = '$0.00';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter valid values.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    calculate();
                }
            },
            'currency-converter': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="amount">Amount</label>
                            <input type="number" id="amount" value="100" step="0.01" placeholder="e.g., 100">
                        </div>
                        <div class="form-group">
                            <label for="fromCurrency">From Currency</label>
                            <select id="fromCurrency">
                                <option value="1">USD - US Dollar</option>
                                <option value="0.85">EUR - Euro</option>
                                <option value="0.73">GBP - British Pound</option>
                                <option value="110">JPY - Japanese Yen</option>
                                <option value="83">INR - Indian Rupee</option>
                                <option value="1.35">CAD - Canadian Dollar</option>
                                <option value="1.52">AUD - Australian Dollar</option>
                                <option value="7.25">CNY - Chinese Yuan</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="toCurrency">To Currency</label>
                            <select id="toCurrency">
                                <option value="0.85">EUR - Euro</option>
                                <option value="1" selected>USD - US Dollar</option>
                                <option value="0.73">GBP - British Pound</option>
                                <option value="110">JPY - Japanese Yen</option>
                                <option value="83">INR - Indian Rupee</option>
                                <option value="1.35">CAD - Canadian Dollar</option>
                                <option value="1.52">AUD - Australian Dollar</option>
                                <option value="7.25">CNY - Chinese Yuan</option>
                            </select>
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Converted Amount</p>
                            <p class="result-value" id="resultValue">--</p>
                            <p class="result-interpretation" id="resultInterpretation">Note: Exchange rates are approximate</p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const amount = parseFloat(modal.querySelector('#amount').value);
                        const fromRate = parseFloat(modal.querySelector('#fromCurrency').value);
                        const toRate = parseFloat(modal.querySelector('#toCurrency').value);
                        
                        if (amount > 0) {
                            // Convert to USD first, then to target currency
                            const inUSD = amount / fromRate;
                            const result = inUSD * toRate;
                            
                            const fromText = modal.querySelector('#fromCurrency').selectedOptions[0].text.split(' - ')[0];
                            const toText = modal.querySelector('#toCurrency').selectedOptions[0].text.split(' - ')[0];
                            
                            modal.querySelector('#resultValue').textContent = result.toFixed(2);
                            modal.querySelector('#resultInterpretation').textContent = 
                                `${amount.toFixed(2)} ${fromText} = ${result.toFixed(2)} ${toText} (Approx.)`;
                        } else {
                            modal.querySelector('#resultValue').textContent = '--';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter a valid amount.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    form.addEventListener('change', calculate);
                    calculate();
                }
            },
            'unit-converter': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="unitType">Conversion Type</label>
                            <select id="unitType">
                                <option value="length">Length</option>
                                <option value="weight">Weight</option>
                                <option value="temperature">Temperature</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="value">Value</label>
                            <input type="number" id="value" value="100" step="0.01" placeholder="e.g., 100">
                        </div>
                        <div class="form-group">
                            <label for="fromUnit">From</label>
                            <select id="fromUnit"></select>
                        </div>
                        <div class="form-group">
                            <label for="toUnit">To</label>
                            <select id="toUnit"></select>
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Result</p>
                            <p class="result-value" id="resultValue">--</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const typeSelect = modal.querySelector('#unitType');
                    const fromSelect = modal.querySelector('#fromUnit');
                    const toSelect = modal.querySelector('#toUnit');
                    
                    const units = {
                        length: {
                            'Meters': 1,
                            'Kilometers': 0.001,
                            'Centimeters': 100,
                            'Millimeters': 1000,
                            'Miles': 0.000621371,
                            'Yards': 1.09361,
                            'Feet': 3.28084,
                            'Inches': 39.3701
                        },
                        weight: {
                            'Kilograms': 1,
                            'Grams': 1000,
                            'Milligrams': 1000000,
                            'Pounds': 2.20462,
                            'Ounces': 35.274,
                            'Tons': 0.001
                        },
                        temperature: {
                            'Celsius': 'C',
                            'Fahrenheit': 'F',
                            'Kelvin': 'K'
                        }
                    };
                    
                    const updateUnits = () => {
                        const type = typeSelect.value;
                        const unitList = Object.keys(units[type]);
                        
                        fromSelect.innerHTML = unitList.map(u => `<option value="${u}">${u}</option>`).join('');
                        toSelect.innerHTML = unitList.map(u => `<option value="${u}">${u}</option>`).join('');
                        toSelect.selectedIndex = Math.min(1, unitList.length - 1);
                    };
                    
                    const calculate = () => {
                        const value = parseFloat(modal.querySelector('#value').value);
                        const type = typeSelect.value;
                        const fromUnit = fromSelect.value;
                        const toUnit = toSelect.value;
                        
                        if (!isNaN(value)) {
                            let result;
                            
                            if (type === 'temperature') {
                                // Temperature conversion logic
                                let celsius = value;
                                if (fromUnit === 'Fahrenheit') celsius = (value - 32) * 5 / 9;
                                else if (fromUnit === 'Kelvin') celsius = value - 273.15;
                                
                                if (toUnit === 'Celsius') result = celsius;
                                else if (toUnit === 'Fahrenheit') result = (celsius * 9 / 5) + 32;
                                else if (toUnit === 'Kelvin') result = celsius + 273.15;
                            } else {
                                // Length and weight conversion
                                const baseValue = value / units[type][fromUnit];
                                result = baseValue * units[type][toUnit];
                            }
                            
                            modal.querySelector('#resultValue').textContent = result.toFixed(4);
                            modal.querySelector('#resultInterpretation').textContent = 
                                `${value} ${fromUnit} = ${result.toFixed(4)} ${toUnit}`;
                        } else {
                            modal.querySelector('#resultValue').textContent = '--';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter a valid value.';
                        }
                    };
                    
                    typeSelect.addEventListener('change', () => {
                        updateUnits();
                        calculate();
                    });
                    form.addEventListener('input', calculate);
                    form.addEventListener('change', calculate);
                    
                    updateUnits();
                    calculate();
                }
            },
            'profit-margin-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="costPrice">Cost Price ($)</label>
                            <input type="number" id="costPrice" value="50" step="0.01" placeholder="e.g., 50">
                        </div>
                        <div class="form-group">
                            <label for="sellingPrice">Selling Price ($)</label>
                            <input type="number" id="sellingPrice" value="75" step="0.01" placeholder="e.g., 75">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Profit Margin</p>
                            <p class="result-value" id="resultValue">--%</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const cost = parseFloat(modal.querySelector('#costPrice').value);
                        const selling = parseFloat(modal.querySelector('#sellingPrice').value);
                        
                        if (cost > 0 && selling > 0) {
                            const profit = selling - cost;
                            const profitMargin = (profit / selling) * 100;
                            const markup = (profit / cost) * 100;
                            
                            modal.querySelector('#resultValue').textContent = `${profitMargin.toFixed(2)}%`;
                            modal.querySelector('#resultInterpretation').textContent = 
                                `Profit: ${profit.toLocaleString('en-US', { style: 'currency', currency: 'USD' })} | Markup: ${markup.toFixed(2)}%`;
                        } else {
                            modal.querySelector('#resultValue').textContent = '--%';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter valid prices.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    calculate();
                }
            },
            'investment-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="initialInvestment">Initial Investment ($)</label>
                            <input type="number" id="initialInvestment" value="10000" placeholder="e.g., 10000">
                        </div>
                        <div class="form-group">
                            <label for="annualReturn">Expected Annual Return (%)</label>
                            <input type="number" id="annualReturn" value="8" step="0.1" placeholder="e.g., 8">
                        </div>
                        <div class="form-group">
                            <label for="investmentYears">Investment Period (years)</label>
                            <input type="number" id="investmentYears" value="20" placeholder="e.g., 20">
                        </div>
                        <div class="form-group">
                            <label for="additionalContribution">Additional Monthly Contribution ($)</label>
                            <input type="number" id="additionalContribution" value="500" placeholder="e.g., 500">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Future Investment Value</p>
                            <p class="result-value" id="resultValue">$0.00</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const initial = parseFloat(modal.querySelector('#initialInvestment').value);
                        const rate = parseFloat(modal.querySelector('#annualReturn').value) / 100 / 12;
                        const years = parseFloat(modal.querySelector('#investmentYears').value);
                        const monthly = parseFloat(modal.querySelector('#additionalContribution').value);
                        
                        if (initial >= 0 && years > 0 && rate >= 0) {
                            const months = years * 12;
                            const futureValue = initial * Math.pow(1 + rate, months);
                            const futureValueContributions = monthly * ((Math.pow(1 + rate, months) - 1) / rate);
                            const total = futureValue + futureValueContributions;
                            const totalInvested = initial + (monthly * months);
                            const totalReturn = total - totalInvested;
                            
                            modal.querySelector('#resultValue').textContent = total.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                            modal.querySelector('#resultInterpretation').textContent = 
                                `Invested: ${totalInvested.toLocaleString('en-US', { style: 'currency', currency: 'USD' })} | Returns: ${totalReturn.toLocaleString('en-US', { style: 'currency', currency: 'USD' })}`;
                            
                            Analytics.trackCalculation('investment-calculator');
                        } else {
                            modal.querySelector('#resultValue').textContent = '$0.00';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter valid values.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    calculate();
                }
            },
            'retirement-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="currentAge">Current Age</label>
                            <input type="number" id="currentAge" value="30" placeholder="e.g., 30">
                        </div>
                        <div class="form-group">
                            <label for="retirementAge">Retirement Age</label>
                            <input type="number" id="retirementAge" value="65" placeholder="e.g., 65">
                        </div>
                        <div class="form-group">
                            <label for="currentSavings">Current Retirement Savings ($)</label>
                            <input type="number" id="currentSavings" value="50000" placeholder="e.g., 50000">
                        </div>
                        <div class="form-group">
                            <label for="monthlySavings">Monthly Savings ($)</label>
                            <input type="number" id="monthlySavings" value="1000" placeholder="e.g., 1000">
                        </div>
                        <div class="form-group">
                            <label for="returnRate">Expected Annual Return (%)</label>
                            <input type="number" id="returnRate" value="7" step="0.1" placeholder="e.g., 7">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Retirement Savings</p>
                            <p class="result-value" id="resultValue">$0.00</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const currentAge = parseFloat(modal.querySelector('#currentAge').value);
                        const retirementAge = parseFloat(modal.querySelector('#retirementAge').value);
                        const currentSavings = parseFloat(modal.querySelector('#currentSavings').value);
                        const monthly = parseFloat(modal.querySelector('#monthlySavings').value);
                        const rate = parseFloat(modal.querySelector('#returnRate').value) / 100 / 12;
                        
                        if (retirementAge > currentAge && currentAge > 0) {
                            const years = retirementAge - currentAge;
                            const months = years * 12;
                            
                            const futureValueCurrent = currentSavings * Math.pow(1 + rate, months);
                            const futureValueContributions = monthly * ((Math.pow(1 + rate, months) - 1) / rate);
                            const total = futureValueCurrent + futureValueContributions;
                            const totalContributed = currentSavings + (monthly * months);
                            
                            modal.querySelector('.result-title').textContent = `Retirement Savings at ${retirementAge}`;
                            modal.querySelector('#resultValue').textContent = total.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                            modal.querySelector('#resultInterpretation').textContent = 
                                `Total Contributed: ${totalContributed.toLocaleString('en-US', { style: 'currency', currency: 'USD' })} | Years: ${years}`;
                            
                            Analytics.trackCalculation('retirement-calculator');
                        } else {
                            modal.querySelector('#resultValue').textContent = '$0.00';
                            modal.querySelector('#resultInterpretation').textContent = 'Retirement age must be greater than current age.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    calculate();
                }
            },
            'tax-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="annualIncome">Annual Income ($)</label>
                            <input type="number" id="annualIncome" value="75000" placeholder="e.g., 75000">
                        </div>
                        <div class="form-group">
                            <label for="filingStatus">Filing Status</label>
                            <select id="filingStatus">
                                <option value="single">Single</option>
                                <option value="married">Married Filing Jointly</option>
                                <option value="head">Head of Household</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="deductions">Total Deductions ($)</label>
                            <input type="number" id="deductions" value="13850" placeholder="Standard deduction">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Estimated Tax</p>
                            <p class="result-value" id="resultValue">$0.00</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const income = parseFloat(modal.querySelector('#annualIncome').value);
                        const status = modal.querySelector('#filingStatus').value;
                        const deductions = parseFloat(modal.querySelector('#deductions').value);
                        
                        if (income > 0) {
                            const taxableIncome = Math.max(0, income - deductions);
                            let tax = 0;
                            
                            // US tax brackets 2024 - Single
                            if (status === 'single') {
                                if (taxableIncome <= 11000) tax = taxableIncome * 0.10;
                                else if (taxableIncome <= 44725) tax = 1100 + (taxableIncome - 11000) * 0.12;
                                else if (taxableIncome <= 95375) tax = 5147 + (taxableIncome - 44725) * 0.22;
                                else if (taxableIncome <= 182100) tax = 16290 + (taxableIncome - 95375) * 0.24;
                                else if (taxableIncome <= 231250) tax = 37104 + (taxableIncome - 182100) * 0.32;
                                else if (taxableIncome <= 578125) tax = 52832 + (taxableIncome - 231250) * 0.35;
                                else tax = 174238 + (taxableIncome - 578125) * 0.37;
                            } else if (status === 'married') {
                                if (taxableIncome <= 22000) tax = taxableIncome * 0.10;
                                else if (taxableIncome <= 89075) tax = 2200 + (taxableIncome - 22000) * 0.12;
                                else if (taxableIncome <= 190750) tax = 10294 + (taxableIncome - 89075) * 0.22;
                                else tax = 32580 + (taxableIncome - 190750) * 0.24;
                            } else {
                                tax = taxableIncome * 0.15;
                            }
                            
                            const effectiveRate = (tax / income) * 100;
                            modal.querySelector('#resultValue').textContent = tax.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                            modal.querySelector('#resultInterpretation').textContent = 
                                `Rate: ${effectiveRate.toFixed(1)}% | After-Tax: ${(income - tax).toLocaleString('en-US', { style: 'currency', currency: 'USD' })}`;
                            
                            Analytics.trackCalculation('tax-calculator');
                        } else {
                            modal.querySelector('#resultValue').textContent = '$0.00';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter valid income.';
                        }
                    };
                    form.addEventListener('input', calculate);
                    form.addEventListener('change', calculate);
                    calculate();
                }
            },
            'body-fat-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="gender">Gender</label>
                            <select id="gender">
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="weight">Weight (kg)</label>
                            <input type="number" id="weight" value="75" step="0.1" placeholder="e.g., 75">
                        </div>
                        <div class="form-group">
                            <label for="waist">Waist (cm)</label>
                            <input type="number" id="waist" value="85" step="0.1" placeholder="e.g., 85">
                        </div>
                        <div class="form-group">
                            <label for="neck">Neck (cm)</label>
                            <input type="number" id="neck" value="38" step="0.1" placeholder="e.g., 38">
                        </div>
                        <div class="form-group" id="hipGroup">
                            <label for="hip">Hip (cm)</label>
                            <input type="number" id="hip" value="95" step="0.1" placeholder="e.g., 95">
                        </div>
                        <div class="form-group">
                            <label for="height">Height (cm)</label>
                            <input type="number" id="height" value="175" step="0.1" placeholder="e.g., 175">
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Body Fat Percentage</p>
                            <p class="result-value" id="resultValue">0%</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const genderSelect = modal.querySelector('#gender');
                    const hipGroup = modal.querySelector('#hipGroup');
                    
                    genderSelect.addEventListener('change', () => {
                        hipGroup.style.display = genderSelect.value === 'female' ? 'block' : 'none';
                    });
                    
                    const calculate = () => {
                        const gender = modal.querySelector('#gender').value;
                        const weight = parseFloat(modal.querySelector('#weight').value);
                        const waist = parseFloat(modal.querySelector('#waist').value);
                        const neck = parseFloat(modal.querySelector('#neck').value);
                        const height = parseFloat(modal.querySelector('#height').value);
                        
                        if (weight > 0 && waist > 0 && neck > 0 && height > 0) {
                            let bodyFat;
                            
                            if (gender === 'male') {
                                bodyFat = 495 / (1.0324 - 0.19077 * Math.log10(waist - neck) + 0.15456 * Math.log10(height)) - 450;
                            } else {
                                const hip = parseFloat(modal.querySelector('#hip').value);
                                if (hip > 0) {
                                    bodyFat = 495 / (1.29579 - 0.35004 * Math.log10(waist + hip - neck) + 0.22100 * Math.log10(height)) - 450;
                                } else {
                                    modal.querySelector('#resultValue').textContent = '0%';
                                    modal.querySelector('#resultInterpretation').textContent = 'Please enter hip measurement.';
                                    return;
                                }
                            }
                            
                            let category = '';
                            if (gender === 'male') {
                                if (bodyFat < 6) category = 'Essential Fat';
                                else if (bodyFat < 14) category = 'Athletes';
                                else if (bodyFat < 18) category = 'Fitness';
                                else if (bodyFat < 25) category = 'Average';
                                else category = 'Obese';
                            } else {
                                if (bodyFat < 14) category = 'Essential Fat';
                                else if (bodyFat < 21) category = 'Athletes';
                                else if (bodyFat < 25) category = 'Fitness';
                                else if (bodyFat < 32) category = 'Average';
                                else category = 'Obese';
                            }
                            
                            modal.querySelector('#resultValue').textContent = bodyFat.toFixed(1) + '%';
                            modal.querySelector('#resultInterpretation').textContent = `Category: ${category}`;
                            
                            Analytics.trackCalculation('body-fat-calculator');
                        } else {
                            modal.querySelector('#resultValue').textContent = '0%';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter all measurements.';
                        }
                    };
                    
                    form.addEventListener('input', calculate);
                    form.addEventListener('change', calculate);
                    calculate();
                }
            },
            'ideal-weight-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="gender">Gender</label>
                            <select id="gender">
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="height">Height (cm)</label>
                            <input type="number" id="height" value="175" step="0.1" placeholder="e.g., 175">
                        </div>
                        <div class="form-group">
                            <label for="frame">Body Frame</label>
                            <select id="frame">
                                <option value="small">Small</option>
                                <option value="medium" selected>Medium</option>
                                <option value="large">Large</option>
                            </select>
                        </div>
                        <div class="calculator-result-area">
                            <p class="result-title">Ideal Body Weight</p>
                            <p class="result-value" id="resultValue">0 kg</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const calculate = () => {
                        const gender = modal.querySelector('#gender').value;
                        const height = parseFloat(modal.querySelector('#height').value);
                        const frame = modal.querySelector('#frame').value;
                        
                        if (height > 0) {
                            // Devine Formula
                            let idealWeight;
                            if (gender === 'male') {
                                idealWeight = 50 + 2.3 * ((height / 2.54) - 60);
                            } else {
                                idealWeight = 45.5 + 2.3 * ((height / 2.54) - 60);
                            }
                            
                            // Adjust for frame
                            if (frame === 'small') idealWeight *= 0.90;
                            else if (frame === 'large') idealWeight *= 1.10;
                            
                            const range = idealWeight * 0.1;
                            modal.querySelector('#resultValue').textContent = idealWeight.toFixed(1) + ' kg';
                            modal.querySelector('#resultInterpretation').textContent = 
                                `Healthy Range: ${(idealWeight - range).toFixed(1)} - ${(idealWeight + range).toFixed(1)} kg`;
                            
                            Analytics.trackCalculation('ideal-weight-calculator');
                        } else {
                            modal.querySelector('#resultValue').textContent = '0 kg';
                            modal.querySelector('#resultInterpretation').textContent = 'Please enter valid height.';
                        }
                    };
                    
                    form.addEventListener('input', calculate);
                    form.addEventListener('change', calculate);
                    calculate();
                }
            },
            'scientific-calculator': {
                getHTML: () => `
                    <form class="calculator-form" style="max-width: 400px; margin: 0 auto;">
                        <div class="form-group">
                            <input type="text" id="display" value="0" readonly style="text-align: right; font-size: 1.5rem; padding: 15px;">
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px;">
                            <button type="button" class="calc-btn" data-action="clear">C</button>
                            <button type="button" class="calc-btn" data-action="backspace">â†</button>
                            <button type="button" class="calc-btn" data-action="percent">%</button>
                            <button type="button" class="calc-btn" data-action="divide">Ã·</button>
                            <button type="button" class="calc-btn" data-action="sqrt">âˆš</button>
                            
                            <button type="button" class="calc-btn" data-value="7">7</button>
                            <button type="button" class="calc-btn" data-value="8">8</button>
                            <button type="button" class="calc-btn" data-value="9">9</button>
                            <button type="button" class="calc-btn" data-action="multiply">Ã—</button>
                            <button type="button" class="calc-btn" data-action="power">xÂ²</button>
                            
                            <button type="button" class="calc-btn" data-value="4">4</button>
                            <button type="button" class="calc-btn" data-value="5">5</button>
                            <button type="button" class="calc-btn" data-value="6">6</button>
                            <button type="button" class="calc-btn" data-action="subtract">âˆ’</button>
                            <button type="button" class="calc-btn" data-action="sin">sin</button>
                            
                            <button type="button" class="calc-btn" data-value="1">1</button>
                            <button type="button" class="calc-btn" data-value="2">2</button>
                            <button type="button" class="calc-btn" data-value="3">3</button>
                            <button type="button" class="calc-btn" data-action="add">+</button>
                            <button type="button" class="calc-btn" data-action="cos">cos</button>
                            
                            <button type="button" class="calc-btn" data-value="0" style="grid-column: span 2;">0</button>
                            <button type="button" class="calc-btn" data-value=".">.</button>
                            <button type="button" class="calc-btn" data-action="equals" style="grid-column: span 2; background: #4CAF50; color: white;">=</button>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    let currentValue = '0';
                    let operator = null;
                    let previousValue = null;
                    const display = modal.querySelector('#display');
                    
                    const buttons = modal.querySelectorAll('.calc-btn');
                    buttons.forEach(btn => {
                        btn.addEventListener('click', () => {
                            const value = btn.dataset.value;
                            const action = btn.dataset.action;
                            
                            if (value !== undefined) {
                                currentValue = currentValue === '0' ? value : currentValue + value;
                                display.value = currentValue;
                            } else if (action) {
                                switch (action) {
                                    case 'clear':
                                        currentValue = '0';
                                        operator = null;
                                        previousValue = null;
                                        break;
                                    case 'backspace':
                                        currentValue = currentValue.length > 1 ? currentValue.slice(0, -1) : '0';
                                        break;
                                    case 'sqrt':
                                        currentValue = Math.sqrt(parseFloat(currentValue)).toString();
                                        break;
                                    case 'power':
                                        currentValue = Math.pow(parseFloat(currentValue), 2).toString();
                                        break;
                                    case 'sin':
                                        currentValue = Math.sin(parseFloat(currentValue) * Math.PI / 180).toFixed(8).toString();
                                        break;
                                    case 'cos':
                                        currentValue = Math.cos(parseFloat(currentValue) * Math.PI / 180).toFixed(8).toString();
                                        break;
                                    case 'percent':
                                        currentValue = (parseFloat(currentValue) / 100).toString();
                                        break;
                                    case 'add':
                                    case 'subtract':
                                    case 'multiply':
                                    case 'divide':
                                        operator = action;
                                        previousValue = currentValue;
                                        currentValue = '0';
                                        break;
                                    case 'equals':
                                        if (operator && previousValue) {
                                            const prev = parseFloat(previousValue);
                                            const curr = parseFloat(currentValue);
                                            switch (operator) {
                                                case 'add': currentValue = (prev + curr).toString(); break;
                                                case 'subtract': currentValue = (prev - curr).toString(); break;
                                                case 'multiply': currentValue = (prev * curr).toString(); break;
                                                case 'divide': currentValue = (prev / curr).toString(); break;
                                            }
                                            operator = null;
                                            previousValue = null;
                                        }
                                        Analytics.trackCalculation('scientific-calculator');
                                        break;
                                }
                                display.value = currentValue;
                            }
                        });
                    });
                }
            },
            'area-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="shape">Shape</label>
                            <select id="shape">
                                <option value="square">Square</option>
                                <option value="rectangle">Rectangle</option>
                                <option value="circle">Circle</option>
                                <option value="triangle">Triangle</option>
                                <option value="parallelogram">Parallelogram</option>
                                <option value="trapezoid">Trapezoid</option>
                            </select>
                        </div>
                        <div id="inputFields"></div>
                        <div class="calculator-result-area">
                            <p class="result-title">Area</p>
                            <p class="result-value" id="resultValue">0 mÂ²</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const shapeSelect = modal.querySelector('#shape');
                    const inputFields = modal.querySelector('#inputFields');
                    
                    const updateFields = () => {
                        const shape = shapeSelect.value;
                        let html = '';
                        
                        switch (shape) {
                            case 'square':
                                html = '<div class="form-group"><label for="side">Side (m)</label><input type="number" id="side" value="5" step="0.1"></div>';
                                break;
                            case 'rectangle':
                                html = '<div class="form-group"><label for="length">Length (m)</label><input type="number" id="length" value="8" step="0.1"></div>' +
                                       '<div class="form-group"><label for="width">Width (m)</label><input type="number" id="width" value="5" step="0.1"></div>';
                                break;
                            case 'circle':
                                html = '<div class="form-group"><label for="radius">Radius (m)</label><input type="number" id="radius" value="5" step="0.1"></div>';
                                break;
                            case 'triangle':
                                html = '<div class="form-group"><label for="base">Base (m)</label><input type="number" id="base" value="6" step="0.1"></div>' +
                                       '<div class="form-group"><label for="height">Height (m)</label><input type="number" id="height" value="4" step="0.1"></div>';
                                break;
                            case 'parallelogram':
                                html = '<div class="form-group"><label for="base">Base (m)</label><input type="number" id="base" value="7" step="0.1"></div>' +
                                       '<div class="form-group"><label for="height">Height (m)</label><input type="number" id="height" value="5" step="0.1"></div>';
                                break;
                            case 'trapezoid':
                                html = '<div class="form-group"><label for="base1">Base 1 (m)</label><input type="number" id="base1" value="8" step="0.1"></div>' +
                                       '<div class="form-group"><label for="base2">Base 2 (m)</label><input type="number" id="base2" value="5" step="0.1"></div>' +
                                       '<div class="form-group"><label for="height">Height (m)</label><input type="number" id="height" value="4" step="0.1"></div>';
                                break;
                        }
                        
                        inputFields.innerHTML = html;
                        calculate();
                    };
                    
                    const calculate = () => {
                        const shape = shapeSelect.value;
                        let area = 0;
                        
                        switch (shape) {
                            case 'square':
                                const side = parseFloat(modal.querySelector('#side')?.value || 0);
                                area = side * side;
                                break;
                            case 'rectangle':
                                const length = parseFloat(modal.querySelector('#length')?.value || 0);
                                const width = parseFloat(modal.querySelector('#width')?.value || 0);
                                area = length * width;
                                break;
                            case 'circle':
                                const radius = parseFloat(modal.querySelector('#radius')?.value || 0);
                                area = Math.PI * radius * radius;
                                break;
                            case 'triangle':
                            case 'parallelogram':
                                const base = parseFloat(modal.querySelector('#base')?.value || 0);
                                const height = parseFloat(modal.querySelector('#height')?.value || 0);
                                area = shape === 'triangle' ? (base * height) / 2 : base * height;
                                break;
                            case 'trapezoid':
                                const base1 = parseFloat(modal.querySelector('#base1')?.value || 0);
                                const base2 = parseFloat(modal.querySelector('#base2')?.value || 0);
                                const trapHeight = parseFloat(modal.querySelector('#height')?.value || 0);
                                area = ((base1 + base2) / 2) * trapHeight;
                                break;
                        }
                        
                        modal.querySelector('#resultValue').textContent = area.toFixed(2) + ' mÂ²';
                        modal.querySelector('#resultInterpretation').textContent = 
                            `Shape: ${shape.charAt(0).toUpperCase() + shape.slice(1)}`;
                        
                        Analytics.trackCalculation('area-calculator');
                    };
                    
                    shapeSelect.addEventListener('change', updateFields);
                    inputFields.addEventListener('input', calculate);
                    updateFields();
                }
            },
            'volume-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="shape">3D Shape</label>
                            <select id="shape">
                                <option value="cube">Cube</option>
                                <option value="cuboid">Cuboid</option>
                                <option value="sphere">Sphere</option>
                                <option value="cylinder">Cylinder</option>
                                <option value="cone">Cone</option>
                                <option value="pyramid">Pyramid</option>
                            </select>
                        </div>
                        <div id="inputFields"></div>
                        <div class="calculator-result-area">
                            <p class="result-title">Volume</p>
                            <p class="result-value" id="resultValue">0 mÂ³</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const shapeSelect = modal.querySelector('#shape');
                    const inputFields = modal.querySelector('#inputFields');
                    
                    const updateFields = () => {
                        const shape = shapeSelect.value;
                        let html = '';
                        
                        switch (shape) {
                            case 'cube':
                                html = '<div class="form-group"><label for="side">Side (m)</label><input type="number" id="side" value="5" step="0.1"></div>';
                                break;
                            case 'cuboid':
                                html = '<div class="form-group"><label for="length">Length (m)</label><input type="number" id="length" value="8" step="0.1"></div>' +
                                       '<div class="form-group"><label for="width">Width (m)</label><input type="number" id="width" value="5" step="0.1"></div>' +
                                       '<div class="form-group"><label for="height">Height (m)</label><input type="number" id="height" value="4" step="0.1"></div>';
                                break;
                            case 'sphere':
                                html = '<div class="form-group"><label for="radius">Radius (m)</label><input type="number" id="radius" value="5" step="0.1"></div>';
                                break;
                            case 'cylinder':
                                html = '<div class="form-group"><label for="radius">Radius (m)</label><input type="number" id="radius" value="4" step="0.1"></div>' +
                                       '<div class="form-group"><label for="height">Height (m)</label><input type="number" id="height" value="10" step="0.1"></div>';
                                break;
                            case 'cone':
                                html = '<div class="form-group"><label for="radius">Radius (m)</label><input type="number" id="radius" value="3" step="0.1"></div>' +
                                       '<div class="form-group"><label for="height">Height (m)</label><input type="number" id="height" value="9" step="0.1"></div>';
                                break;
                            case 'pyramid':
                                html = '<div class="form-group"><label for="base">Base (m)</label><input type="number" id="base" value="6" step="0.1"></div>' +
                                       '<div class="form-group"><label for="height">Height (m)</label><input type="number" id="height" value="8" step="0.1"></div>';
                                break;
                        }
                        
                        inputFields.innerHTML = html;
                        calculate();
                    };
                    
                    const calculate = () => {
                        const shape = shapeSelect.value;
                        let volume = 0;
                        
                        switch (shape) {
                            case 'cube':
                                const side = parseFloat(modal.querySelector('#side')?.value || 0);
                                volume = Math.pow(side, 3);
                                break;
                            case 'cuboid':
                                const length = parseFloat(modal.querySelector('#length')?.value || 0);
                                const width = parseFloat(modal.querySelector('#width')?.value || 0);
                                const height = parseFloat(modal.querySelector('#height')?.value || 0);
                                volume = length * width * height;
                                break;
                            case 'sphere':
                                const radius = parseFloat(modal.querySelector('#radius')?.value || 0);
                                volume = (4/3) * Math.PI * Math.pow(radius, 3);
                                break;
                            case 'cylinder':
                                const cylRadius = parseFloat(modal.querySelector('#radius')?.value || 0);
                                const cylHeight = parseFloat(modal.querySelector('#height')?.value || 0);
                                volume = Math.PI * Math.pow(cylRadius, 2) * cylHeight;
                                break;
                            case 'cone':
                                const coneRadius = parseFloat(modal.querySelector('#radius')?.value || 0);
                                const coneHeight = parseFloat(modal.querySelector('#height')?.value || 0);
                                volume = (1/3) * Math.PI * Math.pow(coneRadius, 2) * coneHeight;
                                break;
                            case 'pyramid':
                                const base = parseFloat(modal.querySelector('#base')?.value || 0);
                                const pyrHeight = parseFloat(modal.querySelector('#height')?.value || 0);
                                volume = (1/3) * Math.pow(base, 2) * pyrHeight;
                                break;
                        }
                        
                        modal.querySelector('#resultValue').textContent = volume.toFixed(2) + ' mÂ³';
                        modal.querySelector('#resultInterpretation').textContent = 
                            `Shape: ${shape.charAt(0).toUpperCase() + shape.slice(1)}`;
                        
                        Analytics.trackCalculation('volume-calculator');
                    };
                    
                    shapeSelect.addEventListener('change', updateFields);
                    inputFields.addEventListener('input', calculate);
                    updateFields();
                }
            },
            'distance-calculator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="calcType">Calculation Type</label>
                            <select id="calcType">
                                <option value="2d">2D Distance</option>
                                <option value="3d">3D Distance</option>
                                <option value="speed">Speed/Distance/Time</option>
                            </select>
                        </div>
                        <div id="inputFields"></div>
                        <div class="calculator-result-area">
                            <p class="result-title">Result</p>
                            <p class="result-value" id="resultValue">0</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const typeSelect = modal.querySelector('#calcType');
                    const inputFields = modal.querySelector('#inputFields');
                    
                    const updateFields = () => {
                        const type = typeSelect.value;
                        let html = '';
                        
                        switch (type) {
                            case '2d':
                                html = '<div class="form-group"><label for="x1">Xâ‚</label><input type="number" id="x1" value="0" step="0.1"></div>' +
                                       '<div class="form-group"><label for="y1">Yâ‚</label><input type="number" id="y1" value="0" step="0.1"></div>' +
                                       '<div class="form-group"><label for="x2">Xâ‚‚</label><input type="number" id="x2" value="3" step="0.1"></div>' +
                                       '<div class="form-group"><label for="y2">Yâ‚‚</label><input type="number" id="y2" value="4" step="0.1"></div>';
                                break;
                            case '3d':
                                html = '<div class="form-group"><label for="x1">Xâ‚</label><input type="number" id="x1" value="0" step="0.1"></div>' +
                                       '<div class="form-group"><label for="y1">Yâ‚</label><input type="number" id="y1" value="0" step="0.1"></div>' +
                                       '<div class="form-group"><label for="z1">Zâ‚</label><input type="number" id="z1" value="0" step="0.1"></div>' +
                                       '<div class="form-group"><label for="x2">Xâ‚‚</label><input type="number" id="x2" value="3" step="0.1"></div>' +
                                       '<div class="form-group"><label for="y2">Yâ‚‚</label><input type="number" id="y2" value="4" step="0.1"></div>' +
                                       '<div class="form-group"><label for="z2">Zâ‚‚</label><input type="number" id="z2" value="5" step="0.1"></div>';
                                break;
                            case 'speed':
                                html = '<div class="form-group"><label for="distance">Distance (km)</label><input type="number" id="distance" value="100" step="0.1"></div>' +
                                       '<div class="form-group"><label for="time">Time (hours)</label><input type="number" id="time" value="2" step="0.1"></div>';
                                break;
                        }
                        
                        inputFields.innerHTML = html;
                        calculate();
                    };
                    
                    const calculate = () => {
                        const type = typeSelect.value;
                        let result = 0;
                        let interpretation = '';
                        let unit = '';
                        
                        switch (type) {
                            case '2d':
                                const x1 = parseFloat(modal.querySelector('#x1')?.value || 0);
                                const y1 = parseFloat(modal.querySelector('#y1')?.value || 0);
                                const x2 = parseFloat(modal.querySelector('#x2')?.value || 0);
                                const y2 = parseFloat(modal.querySelector('#y2')?.value || 0);
                                result = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
                                unit = 'units';
                                interpretation = 'Distance between two points';
                                break;
                            case '3d':
                                const x1_3d = parseFloat(modal.querySelector('#x1')?.value || 0);
                                const y1_3d = parseFloat(modal.querySelector('#y1')?.value || 0);
                                const z1 = parseFloat(modal.querySelector('#z1')?.value || 0);
                                const x2_3d = parseFloat(modal.querySelector('#x2')?.value || 0);
                                const y2_3d = parseFloat(modal.querySelector('#y2')?.value || 0);
                                const z2 = parseFloat(modal.querySelector('#z2')?.value || 0);
                                result = Math.sqrt(Math.pow(x2_3d - x1_3d, 2) + Math.pow(y2_3d - y1_3d, 2) + Math.pow(z2 - z1, 2));
                                unit = 'units';
                                interpretation = '3D distance';
                                break;
                            case 'speed':
                                const distance = parseFloat(modal.querySelector('#distance')?.value || 0);
                                const time = parseFloat(modal.querySelector('#time')?.value || 0);
                                result = time > 0 ? distance / time : 0;
                                unit = 'km/h';
                                interpretation = `Speed = ${result.toFixed(2)} km/h`;
                                break;
                        }
                        
                        modal.querySelector('#resultValue').textContent = result.toFixed(2) + ' ' + unit;
                        modal.querySelector('#resultInterpretation').textContent = interpretation;
                        
                        Analytics.trackCalculation('distance-calculator');
                    };
                    
                    typeSelect.addEventListener('change', updateFields);
                    inputFields.addEventListener('input', calculate);
                    updateFields();
                }
            },
            'password-generator': {
                getHTML: () => `
                    <form class="calculator-form">
                        <div class="form-group">
                            <label for="length">Password Length (8-64)</label>
                            <input type="number" id="length" value="16" min="8" max="64">
                        </div>
                        <div class="form-group">
                            <label><input type="checkbox" id="uppercase" checked> Uppercase (A-Z)</label>
                        </div>
                        <div class="form-group">
                            <label><input type="checkbox" id="lowercase" checked> Lowercase (a-z)</label>
                        </div>
                        <div class="form-group">
                            <label><input type="checkbox" id="numbers" checked> Numbers (0-9)</label>
                        </div>
                        <div class="form-group">
                            <label><input type="checkbox" id="symbols" checked> Symbols (!@#$%^&*)</label>
                        </div>
                        <button type="button" id="generateBtn" style="width: 100%; padding: 12px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 1rem; margin: 10px 0;">Generate Password</button>
                        <div class="calculator-result-area">
                            <p class="result-title">Generated Password</p>
                            <p class="result-value" id="resultValue" style="word-break: break-all; font-size: 1.2rem;">-</p>
                            <p class="result-interpretation" id="resultInterpretation"></p>
                        </div>
                    </form>
                `,
                attachEventListeners: (modal) => {
                    const form = modal.querySelector('form');
                    const generateBtn = modal.querySelector('#generateBtn');
                    
                    const generate = () => {
                        const length = parseInt(modal.querySelector('#length').value);
                        const useUppercase = modal.querySelector('#uppercase').checked;
                        const useLowercase = modal.querySelector('#lowercase').checked;
                        const useNumbers = modal.querySelector('#numbers').checked;
                        const useSymbols = modal.querySelector('#symbols').checked;
                        
                        let charset = '';
                        if (useUppercase) charset += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
                        if (useLowercase) charset += 'abcdefghijklmnopqrstuvwxyz';
                        if (useNumbers) charset += '0123456789';
                        if (useSymbols) charset += '!@#$%^&*()_+-=[]{}|;:,.<>?';
                        
                        if (charset.length === 0) {
                            modal.querySelector('#resultValue').textContent = 'Select at least one option';
                            modal.querySelector('#resultInterpretation').textContent = '';
                            return;
                        }
                        
                        let password = '';
                        for (let i = 0; i < length; i++) {
                            password += charset.charAt(Math.floor(Math.random() * charset.length));
                        }
                        
                        // Calculate strength
                        let strength = 'Weak';
                        let strengthScore = 0;
                        if (useUppercase) strengthScore++;
                        if (useLowercase) strengthScore++;
                        if (useNumbers) strengthScore++;
                        if (useSymbols) strengthScore++;
                        if (length >= 12) strengthScore++;
                        if (length >= 16) strengthScore++;
                        
                        if (strengthScore >= 5) strength = 'Very Strong';
                        else if (strengthScore >= 4) strength = 'Strong';
                        else if (strengthScore >= 3) strength = 'Medium';
                        
                        modal.querySelector('#resultValue').textContent = password;
                        modal.querySelector('#resultInterpretation').textContent = 
                            `Strength: ${strength} | Length: ${length} | Charset: ${charset.length}`;
                        
                        Analytics.trackCalculation('password-generator');
                    };
                    
                    generateBtn.addEventListener('click', generate);
                    generate();
                }
            }
        };


        // --- Analytics System ---
        const Analytics = {
            // Initialize analytics
            init() {
                if (!localStorage.getItem('calculator-analytics')) {
                    localStorage.setItem('calculator-analytics', JSON.stringify({
                        totalVisits: 0,
                        calculatorUsage: {},
                        categoryViews: {},
                        searchQueries: [],
                        failedSearches: [],
                        themeChanges: 0,
                        totalCalculations: 0,
                        sessionStart: Date.now(),
                        lastVisit: Date.now()
                    }));
                }
                this.incrementVisits();
            },
            
            // Get analytics data
            getData() {
                return JSON.parse(localStorage.getItem('calculator-analytics') || '{}');
            },
            
            // Save analytics data
            saveData(data) {
                localStorage.setItem('calculator-analytics', JSON.stringify(data));
            },
            
            // Track calculator open
            trackCalculatorOpen(calculatorId, calculatorName) {
                const data = this.getData();
                if (!data.calculatorUsage[calculatorId]) {
                    data.calculatorUsage[calculatorId] = {
                        name: calculatorName,
                        opens: 0,
                        calculations: 0,
                        lastUsed: null
                    };
                }
                data.calculatorUsage[calculatorId].opens++;
                data.calculatorUsage[calculatorId].lastUsed = Date.now();
                this.saveData(data);
                dbg(`ðŸ“Š Analytics: Calculator opened - ${calculatorName}`);
            },
            
            // Track calculation performed
            trackCalculation(calculatorId) {
                const data = this.getData();
                if (data.calculatorUsage[calculatorId]) {
                    data.calculatorUsage[calculatorId].calculations++;
                    data.totalCalculations++;
                    this.saveData(data);
                }
            },
            
            // Track category view
            trackCategoryView(category) {
                const data = this.getData();
                if (!data.categoryViews[category]) {
                    data.categoryViews[category] = 0;
                }
                data.categoryViews[category]++;
                this.saveData(data);
                dbg(`ðŸ“Š Analytics: Category viewed - ${category}`);
            },
            
            // Track search query
            trackSearch(query, resultsCount) {
                const data = this.getData();
                data.searchQueries.push({
                    query: query,
                    results: resultsCount,
                    timestamp: Date.now()
                });
                
                // Keep only last 100 searches
                if (data.searchQueries.length > 100) {
                    data.searchQueries = data.searchQueries.slice(-100);
                }
                
                // Track failed search
                if (resultsCount === 0) {
                    data.failedSearches.push({
                        query: query,
                        timestamp: Date.now()
                    });
                    if (data.failedSearches.length > 50) {
                        data.failedSearches = data.failedSearches.slice(-50);
                    }
                }
                
                this.saveData(data);
                dbg(`ðŸ” Analytics: Search - "${query}" (${resultsCount} results)`);
            },
            
            // Track theme change
            trackThemeChange(newTheme) {
                const data = this.getData();
                data.themeChanges++;
                data.currentTheme = newTheme;
                this.saveData(data);
                dbg(`ðŸŽ¨ Analytics: Theme changed to ${newTheme}`);
            },
            
            // Increment total visits
            incrementVisits() {
                const data = this.getData();
                data.totalVisits++;
                data.lastVisit = Date.now();
                this.saveData(data);
            },
            
            // Get popular calculators
            getPopularCalculators(limit = 10) {
                const data = this.getData();
                return Object.entries(data.calculatorUsage)
                    .sort((a, b) => b[1].opens - a[1].opens)
                    .slice(0, limit)
                    .map(([id, info]) => ({
                        id,
                        name: info.name,
                        opens: info.opens,
                        calculations: info.calculations
                    }));
            },
            
            // Get analytics summary
            getSummary() {
                const data = this.getData();
                const sessionDuration = Math.floor((Date.now() - data.sessionStart) / 1000 / 60);
                
                return {
                    totalVisits: data.totalVisits,
                    totalCalculations: data.totalCalculations,
                    themeChanges: data.themeChanges,
                    searchesPerformed: data.searchQueries.length,
                    failedSearches: data.failedSearches.length,
                    sessionDuration: sessionDuration,
                    mostUsedCategory: this.getMostUsedCategory(),
                    popularCalculators: this.getPopularCalculators(5)
                };
            },
            
            // Get most used category
            getMostUsedCategory() {
                const data = this.getData();
                const entries = Object.entries(data.categoryViews);
                if (entries.length === 0) return 'all';
                return entries.sort((a, b) => b[1] - a[1])[0][0];
            },
            
            // Log analytics summary to console
            logSummary() {
                const summary = this.getSummary();
                console.log('ðŸ“Š ========== ANALYTICS SUMMARY ==========');
                console.log(`ðŸ‘¥ Total Visits: ${summary.totalVisits}`);
                console.log(`ðŸ”¢ Total Calculations: ${summary.totalCalculations}`);
                console.log(`ðŸ” Searches Performed: ${summary.searchesPerformed}`);
                console.log(`âŒ Failed Searches: ${summary.failedSearches}`);
                console.log(`ðŸŽ¨ Theme Changes: ${summary.themeChanges}`);
                console.log(`â±ï¸ Session Duration: ${summary.sessionDuration} minutes`);
                console.log(`â­ Most Used Category: ${summary.mostUsedCategory}`);
                console.log('ðŸ† Top Calculators:');
                summary.popularCalculators.forEach((calc, i) => {
                    console.log(`   ${i + 1}. ${calc.name} - ${calc.opens} opens, ${calc.calculations} calculations`);
                });
                console.log('========================================');
            },
            
            // Clear all analytics data
            clear() {
                localStorage.removeItem('calculator-analytics');
                this.init();
                console.log('ðŸ—‘ï¸ Analytics data cleared');
            }
        };

        // --- Core Application Logic (Mostly Unchanged, with additions for Modal) ---
        let currentTheme = 'light';
        let currentCategory = 'all';
        let searchQuery = '';

        // DOM Elements
        const themeToggle = document.getElementById('themeToggle');
        const searchInput = document.getElementById('searchInput');
        const searchClear = document.getElementById('searchClear');
        const searchSuggestions = document.getElementById('searchSuggestions');
        const categoryTabs = document.getElementById('categoryTabs');
  // Preserve original parent so we can restore the tabs after moving them for mobile
  const categoryOriginalParent = categoryTabs.parentElement;
        const toolsGrid = document.getElementById('toolsGrid');
        const mobileMenuToggle = document.getElementById('mobileMenuToggle');
        const navMenu = document.getElementById('navMenu');
        
        // NEW: Modal DOM Elements
        const calculatorModal = document.getElementById('calculatorModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalBody = document.getElementById('modalBody');
        const modalCloseBtn = document.getElementById('modalCloseBtn');
    // Login modal elements
    const loginModal = document.getElementById('loginModal');
    const loginModalClose = document.getElementById('loginModalClose');
    const loginForm = document.getElementById('loginForm');
    const loginBtn = document.getElementById('loginBtn');
    const mobileLoginBtn = document.getElementById('mobileLoginBtn');
        
        // Analytics modal elements
        const analyticsModal = document.getElementById('analyticsModal');
        const analyticsModalClose = document.getElementById('analyticsModalClose');
        const analyticsModalBody = document.getElementById('analyticsModalBody');

        document.addEventListener('DOMContentLoaded', function() {
          // Initialize analytics
          Analytics.init();
          
          initializeTheme();
                    initializeEventListeners();
                    updateLoginState();
          renderTools();
          createScrollToTopButton();
          renderRecentCalculators(); // Add recent section
          
          // Render popular calculators with retry
          setTimeout(() => {
            console.log('ðŸ“Š Attempting to render popular calculators...');
            renderPopularCalculators();
          }, 100);
          
          // Initialize mobile bottom nav
          if (window.innerWidth <= 768) {
            updateMobileBottomNavActiveState('home');
          }
          
          // Mobile Explore Button - Opens category menu
          const mobileExploreBtn = document.getElementById('mobileExploreBtn');
          const mobileMenuToggle = document.getElementById('mobileMenuToggle');
          
          console.log('ï¿½ MOBILE DEBUG INFO:', {
            windowWidth: window.innerWidth,
            isMobile: window.innerWidth <= 768,
            mobileExploreBtn: !!mobileExploreBtn,
            mobileMenuToggle: !!mobileMenuToggle,
            popularGrid: !!document.getElementById('popularGrid'),
            hero: !!document.querySelector('.hero'),
            mobileCTASection: !!document.querySelector('.mobile-cta-section')
          });
          
          if (mobileExploreBtn) {
            console.log('âœ… Mobile Explore button found! Adding event listener...');
            mobileExploreBtn.addEventListener('click', function(e) {
              e.preventDefault();
              e.stopPropagation();
              console.log('ðŸš€ Mobile Explore button clicked!');
              
              // Trigger mobile menu toggle
              if (mobileMenuToggle) {
                mobileMenuToggle.click();
              } else {
                // Fallback: directly toggle menu
                const mobileCategoriesMenu = document.getElementById('mobileCategoriesMenu');
                if (mobileCategoriesMenu) {
                  mobileCategoriesMenu.classList.add('active');
                  document.body.style.overflow = 'hidden';
                }
              }
            });
          } else {
            console.warn('âš ï¸ Mobile Explore button not found!');
          }
          
          // Log analytics summary after 3 seconds
          setTimeout(() => {
            Analytics.logSummary();
          }, 3000);
          
          // Expose analytics to console for testing
          window.Analytics = Analytics;
          if (DEBUG) {
              console.log('ðŸ’¡ Tip: Type "Analytics.logSummary()" in console to see analytics');
          }
        });

        function initializeTheme() {
          const savedTheme = localStorage.getItem('calculator-hub-theme') || 'light';
          currentTheme = savedTheme;
          document.documentElement.setAttribute('data-theme', currentTheme);
          updateThemeIcon();
        }

        function toggleTheme() {
          currentTheme = currentTheme === 'light' ? 'dark' : 'light';
          document.documentElement.setAttribute('data-theme', currentTheme);
          localStorage.setItem('calculator-hub-theme', currentTheme);
          updateThemeIcon();
          
          // Track theme change
          Analytics.trackThemeChange(currentTheme);
          
          // Update ARIA attributes
          const isDark = currentTheme === 'dark';
          themeToggle.setAttribute('aria-pressed', isDark);
          themeToggle.setAttribute('aria-label', isDark ? 'Switch to light mode' : 'Switch to dark mode');
        }

        function updateThemeIcon() {
          const icon = themeToggle.querySelector('i');
          icon.className = currentTheme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
          
          // Update ARIA label on page load
          const isDark = currentTheme === 'dark';
          themeToggle.setAttribute('aria-pressed', isDark);
          themeToggle.setAttribute('aria-label', isDark ? 'Switch to light mode' : 'Switch to dark mode');
        }

        function initializeEventListeners() {
            themeToggle.addEventListener('click', toggleTheme);
            searchInput.addEventListener('input', handleSearch);
            searchInput.addEventListener('focus', showSearchSuggestions);
            document.body.addEventListener('click', (e) => {
                if (!e.target.closest('.floating-search')) {
                    hideSearchSuggestions();
                }
            });

            // === Enhanced Keyboard Navigation ===
            document.addEventListener('keydown', (e) => {
                // Ctrl+K or / to focus search
                if ((e.ctrlKey && e.key === 'k') || e.key === '/') {
                    e.preventDefault();
                    searchInput.focus();
                    searchInput.select();
                    searchInput.setAttribute('aria-expanded', 'true');
                }
                
                // Escape key handling
                if (e.key === 'Escape') {
                    // Close modal if open
                    if (calculatorModal.classList.contains('visible')) {
                        closeModal();
                    }
                    // Close login modal if open
                    else if (loginModal.classList.contains('visible')) {
                        closeLoginModal();
                    }
                    // Clear search if search is focused
                    else if (searchInput === document.activeElement) {
                        clearSearch();
                        searchInput.blur();
                    }
                }
                
                // Arrow key navigation in search suggestions
                if (searchSuggestions.children.length > 0 && searchInput === document.activeElement) {
                    const suggestions = Array.from(searchSuggestions.children);
                    const currentIndex = suggestions.findIndex(s => s.classList.contains('focused'));
                    
                    if (e.key === 'ArrowDown') {
                        e.preventDefault();
                        const nextIndex = currentIndex < suggestions.length - 1 ? currentIndex + 1 : 0;
                        suggestions.forEach((s, i) => {
                            s.classList.toggle('focused', i === nextIndex);
                            if (i === nextIndex) s.setAttribute('aria-selected', 'true');
                            else s.removeAttribute('aria-selected');
                        });
                    } else if (e.key === 'ArrowUp') {
                        e.preventDefault();
                        const prevIndex = currentIndex > 0 ? currentIndex - 1 : suggestions.length - 1;
                        suggestions.forEach((s, i) => {
                            s.classList.toggle('focused', i === prevIndex);
                            if (i === prevIndex) s.setAttribute('aria-selected', 'true');
                            else s.removeAttribute('aria-selected');
                        });
                    } else if (e.key === 'Enter' && currentIndex >= 0) {
                        e.preventDefault();
                        suggestions[currentIndex].click();
                    }
                }
            });

            // Mobile navigation back button
            const mobileNavBack = document.getElementById('mobileNavBack');
            mobileNavBack?.addEventListener('click', () => {
                toggleMobileMenu();
            });
            searchClear.addEventListener('click', clearSearch);
            
            // Navigation categories dropdown (desktop)
            const navCategoriesBtn = document.getElementById('navCategoriesBtn');
            const navCategoryDropdown = document.getElementById('navCategoryDropdown');
            navCategoriesBtn?.addEventListener('click', (ev) => {
                ev.stopPropagation();
                const open = navCategoryDropdown.classList.toggle('open');
                navCategoriesBtn.setAttribute('aria-expanded', open);
            });
            // Close dropdown when clicking outside
            document.addEventListener('click', () => {
                if (navCategoryDropdown) {
                    navCategoryDropdown.classList.remove('open');
                    navCategoriesBtn?.setAttribute('aria-expanded', 'false');
                }
            });
            // Handle selecting a category from the nav dropdown
            navCategoryDropdown?.addEventListener('click', (ev) => {
                const item = ev.target.closest('.dropdown-item');
                if (!item) return;
                ev.preventDefault();
                const cat = item.dataset.category;
                // Update active state for desktop & mobile tabs
                document.querySelectorAll('.tab-button.active').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll(`.tab-button[data-category="${cat}"]`).forEach(btn => btn.classList.add('active'));
                currentCategory = cat;
                renderTools();
                navCategoryDropdown.classList.remove('open');
                navCategoriesBtn?.setAttribute('aria-expanded', 'false');
                // If mobile view is open, close it to show results
                if (window.innerWidth <= 768) {
                    toggleMobileMenu();
                }
            });
            
            // Initialize both desktop and mobile category tabs
            const mobileCategoryTabs = document.getElementById('mobileCategoryTabs');
            if (mobileCategoryTabs) {
                // Copy category buttons to mobile menu
                mobileCategoryTabs.innerHTML = categoryTabs.innerHTML;
                mobileCategoryTabs.addEventListener('click', handleCategoryClick);
            }
            
            categoryTabs.addEventListener('click', handleCategoryClick);
            mobileMenuToggle.addEventListener('click', toggleMobileMenu);
            
            // Mobile Search Toggle
            const mobileSearchToggle = document.getElementById('mobileSearchToggle');
            const mobileSearchModal = document.getElementById('mobileSearchModal');
            const mobileSearchClose = document.getElementById('mobileSearchClose');
            const mobileSearchInput = document.getElementById('mobileSearchInput');
            const mobileSearchSuggestions = document.getElementById('mobileSearchSuggestions');
            const mobileSearchClearBtn = document.getElementById('mobileSearchClear');
            
            if (mobileSearchToggle) {
                console.log('Mobile search toggle found!');
                mobileSearchToggle.addEventListener('click', () => {
                    console.log('Mobile search clicked!');
                    mobileSearchModal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    setTimeout(() => mobileSearchInput?.focus(), 300);
                });
            } else {
                console.log('Mobile search toggle NOT found');
            }
            
            mobileSearchClose?.addEventListener('click', () => {
                mobileSearchModal.classList.remove('active');
                document.body.style.overflow = '';
                if (mobileSearchInput) mobileSearchInput.value = '';
                mobileSearchSuggestions.innerHTML = '';
            });
            
            // Initialize clear button display
            if (mobileSearchClearBtn) {
                mobileSearchClearBtn.style.display = 'none';
            }
            
            // Debounce function for search optimization
            function debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }
            
            // Mobile search input handling with debounce
            const performSearch = (e) => {
                const query = e.target.value.toLowerCase().trim();
                mobileSearchClearBtn.style.display = query ? 'flex' : 'none';
                
                if (query) {
                    // Collect all tools from toolsData (cached if possible)
                    if (!window.cachedAllTools) {
                        let allTools = [];
                        for (const [category, data] of Object.entries(toolsData)) {
                            if (data.subcategories) {
                                for (const subcategory of Object.values(data.subcategories)) {
                                    if (subcategory.calculators) {
                                        allTools = allTools.concat(subcategory.calculators);
                                    }
                                }
                            }
                        }
                        window.cachedAllTools = allTools;
                    }
                    
                    // Filter tools by search query (optimized)
                    const filtered = window.cachedAllTools.filter(tool => 
                        tool.title.toLowerCase().includes(query) ||
                        tool.description.toLowerCase().includes(query)
                    ).slice(0, 10);
                    
                    if (filtered.length > 0) {
                        mobileSearchSuggestions.innerHTML = filtered.map(tool => `
                            <div class="search-suggestion-item" onclick="handleToolClick('${tool.id}'); document.getElementById('mobileSearchModal').classList.remove('active'); document.body.style.overflow = '';">
                                <i class="${tool.icon}"></i>
                                <div>
                                    <div class="suggestion-title">${tool.title}</div>
                                    <div class="suggestion-category">${tool.description.substring(0, 50)}...</div>
                                </div>
                            </div>
                        `).join('');
                    } else {
                        mobileSearchSuggestions.innerHTML = `
                            <div class="no-results" style="padding: var(--space-xl); text-align: center; color: var(--text-secondary);">
                                <i class="fas fa-search" style="font-size: 2rem; opacity: 0.3; margin-bottom: 12px; display: block;"></i>
                                <p>No calculators found for "${query}"</p>
                            </div>
                        `;
                    }
                } else {
                    mobileSearchSuggestions.innerHTML = '';
                }
            };
            
            mobileSearchInput?.addEventListener('input', debounce(performSearch, 200));
            
            if (mobileSearchClearBtn) {
                mobileSearchClearBtn.addEventListener('click', () => {
                    if (mobileSearchInput) mobileSearchInput.value = '';
                    mobileSearchSuggestions.innerHTML = '';
                    mobileSearchClearBtn.style.display = 'none';
                    if (mobileSearchInput) mobileSearchInput.focus();
                });
            }
            
            // Mobile categories menu handlers
            const mobileCategoriesMenu = document.getElementById('mobileCategoriesMenu');
            const mobileCategoriesBack = document.getElementById('mobileCategoriesBack');
            
            // Show categories menu when clicking hamburger on mobile
            function showMobileCategoriesMenu() {
                if (window.innerWidth <= 768) {
                    mobileCategoriesMenu.classList.add('active');
                    mobileMenuOverlay.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    
                    // Update bottom nav active state
                    updateMobileBottomNavActiveState('categories');
                }
            }
            
            // Hide categories menu
            function hideMobileCategoriesMenu() {
                mobileCategoriesMenu.classList.remove('active');
                mobileMenuOverlay.classList.remove('active');
                document.body.style.overflow = '';
            }
            
            // Toggle categories menu instead of nav menu on mobile
            mobileMenuToggle.addEventListener('click', (e) => {
                e.stopPropagation();
                if (window.innerWidth <= 768) {
                    showMobileCategoriesMenu();
                }
            });
            
            // Back button to close menu
            mobileCategoriesBack?.addEventListener('click', hideMobileCategoriesMenu);
            
            // Legacy Mobile Search Functionality (keeping for compatibility)
            const mobileMenuContent = document.getElementById('mobileMenuContent');
            
            // Note: mobileSearchInput and mobileSearchClear already declared above
            if (mobileSearchInput) {
                mobileSearchInput.addEventListener('input', (e) => {
                const searchQuery = e.target.value.toLowerCase().trim();
                
                // Show/hide clear button
                mobileSearchClear.style.display = searchQuery ? 'block' : 'none';
                
                if (!searchQuery) {
                    // Show all categories
                    displayMobileCategories();
                    return;
                }
                
                // Search through all tools including subcategories
                let allTools = [];
                for (const [category, data] of Object.entries(toolsData)) {
                    if (data.subcategories) {
                        for (const subcategory of Object.values(data.subcategories)) {
                            allTools = allTools.concat(subcategory.calculators);
                        }
                    } else if (Array.isArray(data)) {
                        allTools = allTools.concat(data);
                    }
                }
                
                const filteredTools = allTools.filter(tool => 
                    tool.title.toLowerCase().includes(searchQuery) || 
                    tool.description.toLowerCase().includes(searchQuery)
                );
                
                if (filteredTools.length === 0) {
                    mobileMenuContent.innerHTML = `
                        <div style="padding: var(--space-lg); text-align: center; color: var(--text-secondary);">
                            <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 12px; display: block; opacity: 0.5;"></i>
                            <p>No tools found for "<strong>${e.target.value}</strong>"</p>
                            <button class="tool-action" style="margin-top: 16px;" onclick="document.getElementById('mobileSearchInput').value=''; document.getElementById('mobileSearchInput').dispatchEvent(new Event('input'));">
                                Clear Search
                            </button>
                        </div>
                    `;
                    return;
                }
                
                // Display search results
                const toolsHtml = filteredTools.map(tool => `
                    <div class="mobile-tool-item" onclick="handleToolClick('${tool.id}'); document.getElementById('mobileCategoriesMenu').classList.remove('active'); document.body.style.overflow = '';">
                        <div class="mobile-tool-icon">
                            <i class="${tool.icon}"></i>
                        </div>
                        <div class="mobile-tool-info">
                            <h4 class="mobile-tool-title">${tool.title}</h4>
                            <p class="mobile-tool-description">${tool.description}</p>
                        </div>
                        <i class="fas fa-chevron-right" style="color: var(--accent-blue); margin-left: auto;"></i>
                    </div>
                `).join('');
                
                mobileMenuContent.innerHTML = `
                    <div style="padding: var(--space-md); font-size: 0.9rem; color: var(--text-secondary); border-bottom: 1px solid var(--glass-border); display: flex; justify-content: space-between; align-items: center;">
                        <span>Found ${filteredTools.length} tool${filteredTools.length !== 1 ? 's' : ''}</span>
                        <button style="background: none; border: none; color: var(--accent-blue); cursor: pointer; font-weight: 600;" onclick="document.getElementById('mobileSearchInput').value=''; document.getElementById('mobileSearchInput').dispatchEvent(new Event('input'));">
                            Clear
                        </button>
                    </div>
                    <div class="mobile-tools-list">
                        ${toolsHtml}
                    </div>
                `;
                });
            }
            
            // Clear search (legacy)
            if (mobileSearchClearBtn) {
            mobileSearchClearBtn.addEventListener('click', () => {
                if (mobileSearchInput) {
                    mobileSearchInput.value = '';
                    mobileSearchInput.focus();
                }
                if (mobileSearchClear) {
                    mobileSearchClear.style.display = 'none';
                }
                displayMobileCategories();
            });
            }
            
            // Function to display categories
            function displayMobileCategories() {
                const categoriesHTML = `
                    <button class="mobile-category-btn" data-category="all">
                        <i class="fas fa-th-large"></i>
                        <span class="category-name">All Calculators</span>
                        <span class="category-badge">300+</span>
                        <i class="fas fa-chevron-right category-arrow"></i>
                    </button>
                    <button class="mobile-category-btn" data-category="financial">
                        <i class="fas fa-chart-line"></i>
                        <span class="category-name">Financial</span>
                        <span class="category-badge">50+</span>
                        <i class="fas fa-chevron-right category-arrow"></i>
                    </button>
                    <button class="mobile-category-btn" data-category="health">
                        <i class="fas fa-heartbeat"></i>
                        <span class="category-name">Health & Fitness</span>
                        <span class="category-badge">40+</span>
                        <i class="fas fa-chevron-right category-arrow"></i>
                    </button>
                    <button class="mobile-category-btn" data-category="math">
                        <i class="fas fa-calculator"></i>
                        <span class="category-name">Math & Numbers</span>
                        <span class="category-badge">60+</span>
                        <i class="fas fa-chevron-right category-arrow"></i>
                    </button>
                    <button class="mobile-category-btn" data-category="datetime">
                        <i class="fas fa-clock"></i>
                        <span class="category-name">Date & Time</span>
                        <span class="category-badge">20+</span>
                        <i class="fas fa-chevron-right category-arrow"></i>
                    </button>
                    <button class="mobile-category-btn" data-category="construction">
                        <i class="fas fa-hard-hat"></i>
                        <span class="category-name">Construction</span>
                        <span class="category-badge">15+</span>
                        <i class="fas fa-chevron-right category-arrow"></i>
                    </button>
                    
                    <button class="mobile-category-btn" data-category="business">
                        <i class="fas fa-briefcase"></i>
                        <span class="category-name">Business & Marketing</span>
                        <span class="category-badge">17+</span>
                        <i class="fas fa-chevron-right category-arrow"></i>
                    </button>

                    <button class="mobile-category-btn" data-category="everyday">
                        <i class="fas fa-home"></i>
                        <span class="category-name">Everyday Life</span>
                        <span class="category-badge">30+</span>
                        <i class="fas fa-chevron-right category-arrow"></i>
                    </button>
                    <button class="mobile-category-btn" data-category="education">
                        <i class="fas fa-graduation-cap"></i>
                        <span class="category-name">Education</span>
                        <span class="category-badge">20+</span>
                        <i class="fas fa-chevron-right category-arrow"></i>
                    </button>
                    <button class="mobile-category-btn" data-category="technology">
                        <i class="fas fa-laptop-code"></i>
                        <span class="category-name">Technology</span>
                        <span class="category-badge">15+</span>
                        <i class="fas fa-chevron-right category-arrow"></i>
                    </button>
                    <button class="mobile-category-btn" data-category="scientific">
                        <i class="fas fa-flask"></i>
                        <span class="category-name">Science</span>
                        <span class="category-badge">40+</span>
                        <i class="fas fa-chevron-right category-arrow"></i>
                    </button>
                `;
                
                if (!mobileMenuContent) {
                    dbgError('[Mobile Menu] ERROR: mobileMenuContent element not found!');
                    return;
                }
                
                mobileMenuContent.innerHTML = categoriesHTML;
                
                // Re-attach category click listeners - must happen after innerHTML is set
                const btns = document.querySelectorAll('.mobile-category-btn');
                dbg('[Mobile Menu] Found category buttons:', btns.length);
                
                if (btns.length === 0) {
                    dbgError('[Mobile Menu] ERROR: No category buttons found after innerHTML!');
                    return;
                }
                
                btns.forEach((btn, index) => {
                    dbg(`[Mobile Menu] Attaching listener to button ${index}:`, btn.dataset.category);
                    btn.addEventListener('click', (e) => {
                        dbg('[Mobile Menu] ===== BUTTON CLICKED! =====');
                        handleMobileCategoryClick(e);
                    });
                });
            }
            
            // Handle View All Popular button (now removed from mobile navigation)
            // Popular section is now on home screen, not in navigation
            
            // ========== Recent Calculators Functions ==========
            function saveRecentCalculator(calcId, calcTitle, calcIcon) {
                let recent = JSON.parse(localStorage.getItem('recentCalculators') || '[]');
                
                // Remove if already exists
                recent = recent.filter(item => item.id !== calcId);
                
                // Add to beginning
                recent.unshift({
                    id: calcId,
                    title: calcTitle,
                    icon: calcIcon,
                    timestamp: Date.now()
                });
                
                // Keep only last 5
                recent = recent.slice(0, 5);
                
                localStorage.setItem('recentCalculators', JSON.stringify(recent));
            }
            
            function getRecentCalculators() {
                const recent = JSON.parse(localStorage.getItem('recentCalculators') || '[]');
                const now = Date.now();
                
                return recent.map(item => {
                    const diff = now - item.timestamp;
                    const minutes = Math.floor(diff / 60000);
                    const hours = Math.floor(minutes / 60);
                    const days = Math.floor(hours / 24);
                    
                    let time;
                    if (minutes < 1) time = 'Just now';
                    else if (minutes < 60) time = `${minutes}m ago`;
                    else if (hours < 24) time = `${hours}h ago`;
                    else time = `${days}d ago`;
                    
                    return { ...item, time };
                });
            }
            
            // ========== Toggle Categories List (REMOVED - Categories now always visible) ==========
            // Browse Categories header removed, categories displayed directly
            
            // Override handleToolClick to save recent
            const originalHandleToolClick = window.handleToolClick;
            window.handleToolClick = function(toolId) {
                // Find calculator info
                let calcInfo = null;
                for (const [category, data] of Object.entries(toolsData)) {
                    if (data.subcategories) {
                        for (const subcategory of Object.values(data.subcategories)) {
                            const calc = subcategory.calculators.find(c => c.id === toolId);
                            if (calc) {
                                calcInfo = calc;
                                break;
                            }
                        }
                    }
                    if (calcInfo) break;
                }
                
                // Save to recent
                if (calcInfo) {
                    saveRecentCalculator(toolId, calcInfo.title, calcInfo.icon);
                    // Update recent section on home screen
                    renderRecentCalculators();
                }
                
                // Call original function
                if (originalHandleToolClick) {
                    originalHandleToolClick(toolId);
                }
            }
            
            // ========== Recent Calculators Section ==========
            function renderRecentCalculators() {
                const recentSection = document.getElementById('recent');
                const recentGrid = document.getElementById('recentGrid');
                
                if (!recentGrid || !recentSection) return;
                
                const recentCalcs = getRecentCalculators();
                
                if (recentCalcs.length === 0) {
                    recentSection.style.display = 'none';
                    return;
                }
                
                recentSection.style.display = 'block';
                
                recentGrid.innerHTML = recentCalcs.map(calc => `
                    <div class="recent-card" onclick="handleToolClick('${calc.id}')">
                        <div class="recent-card-icon">
                            <i class="${calc.icon}"></i>
                        </div>
                        <h3 class="recent-card-title">${calc.title}</h3>
                        <p class="recent-card-time">${calc.time}</p>
                    </div>
                `).join('');
            }
            
            // ========== Popular Calculators Section ==========
            function renderPopularCalculators() {
                const popularGrid = document.getElementById('popularGrid');
                console.log('ðŸŽ¯ Rendering popular calculators...', { popularGrid: !!popularGrid });
                if (!popularGrid) {
                    console.error('âŒ Popular grid not found!');
                    return;
                }
                
                const popularCalculators = [
                    { id: 'emi-calculator', icon: 'ðŸ’°', title: 'EMI Calculator', subtitle: 'Loan Payments', rank: '#1', gradient: 'linear-gradient(135deg, #667EEA, #764BA2)' },
                    { id: 'bmi-calculator', icon: 'âš–ï¸', title: 'BMI Calculator', subtitle: 'Body Mass', rank: '#2', gradient: 'linear-gradient(135deg, #FF6B6B, #FF8E53)' },
                    { id: 'age-calculator', icon: 'ðŸŽ‚', title: 'Age Calculator', subtitle: 'Calculate Age', rank: '#3', gradient: 'linear-gradient(135deg, #48C774, #7ED56F)' },
                    { id: 'percentage-calculator', icon: 'ðŸ“Š', title: 'Percentage', subtitle: '% Calculator', rank: '#4', gradient: 'linear-gradient(135deg, #00D4FF, #8B5CF6)' },
                    { id: 'gst-calculator', icon: 'ðŸ§¾', title: 'GST Calculator', subtitle: 'Tax Calculate', rank: '#5', gradient: 'linear-gradient(135deg, #FFD26F, #FF9A56)' },
                    { id: 'loan-calculator', icon: 'ðŸ¦', title: 'Loan Calculator', subtitle: 'Loan Details', rank: '#6', gradient: 'linear-gradient(135deg, #A29BFE, #6C5CE7)' }
                ];
                
                const html = popularCalculators.map((calc, index) => `
                    <div class="popular-card" onclick="handleToolClick('${calc.id}')" style="animation-delay: ${index * 0.1}s">
                        <div class="popular-card-icon" style="background: ${calc.gradient}">
                            ${calc.icon}
                        </div>
                        <h3 class="popular-card-title">${calc.title}</h3>
                        <p class="popular-card-subtitle">${calc.subtitle}</p>
                        <span class="popular-card-badge">${calc.rank}</span>
                    </div>
                `).join('');
                
                popularGrid.innerHTML = html;
                console.log('âœ… Popular calculators rendered!', popularCalculators.length, 'cards');
            }
            
            // ========== Mobile Search Functionality ==========
            let allCalculators = [];
            
            // Build searchable calculator list
            function buildCalculatorList() {
                allCalculators = [];
                for (const [category, data] of Object.entries(toolsData)) {
                    if (data.subcategories) {
                        for (const [subKey, subcategory] of Object.entries(data.subcategories)) {
                            subcategory.calculators.forEach(calc => {
                                allCalculators.push({
                                    ...calc,
                                    category: category,
                                    categoryName: category.charAt(0).toUpperCase() + category.slice(1),
                                    subcategoryName: subcategory.name
                                });
                            });
                        }
                    }
                }
            }
            
            // Initialize search on page load
            document.addEventListener('DOMContentLoaded', function() {
                buildCalculatorList();
                
                const searchInput = document.getElementById('mobileSearchMainInput');
                const searchClearBtn = document.getElementById('mobileSearchClearMain');
                const suggestionsDiv = document.getElementById('mobileSearchSuggestions');
                
                if (!searchInput) return;
                
                // Search input event
                searchInput.addEventListener('input', function(e) {
                    const query = e.target.value.trim().toLowerCase();
                    
                    // Show/hide clear button
                    if (query.length > 0) {
                        searchClearBtn.classList.add('show');
                    } else {
                        searchClearBtn.classList.remove('show');
                        suggestionsDiv.classList.remove('show');
                        return;
                    }
                    
                    // Search calculators
                    if (query.length >= 2) {
                        const results = allCalculators.filter(calc => {
                            return calc.title.toLowerCase().includes(query) ||
                                   calc.description.toLowerCase().includes(query) ||
                                   calc.categoryName.toLowerCase().includes(query);
                        }).slice(0, 6); // Show max 6 results
                        
                        displaySearchSuggestions(results, query);
                    } else {
                        suggestionsDiv.classList.remove('show');
                    }
                });
                
                // Clear button
                searchClearBtn.addEventListener('click', function() {
                    if (searchInput) {
                        searchInput.value = '';
                        searchInput.focus();
                    }
                    if (searchClearBtn) {
                        searchClearBtn.classList.remove('show');
                    }
                    if (suggestionsDiv) {
                        suggestionsDiv.classList.remove('show');
                    }
                });
                
                // Close suggestions when clicking outside
                document.addEventListener('click', function(e) {
                    if (!searchInput.contains(e.target) && !suggestionsDiv.contains(e.target)) {
                        suggestionsDiv.classList.remove('show');
                    }
                });
            });
            
            function displaySearchSuggestions(results, query) {
                const suggestionsDiv = document.getElementById('mobileSearchSuggestions');
                
                if (results.length === 0) {
                    suggestionsDiv.innerHTML = `
                        <div class="search-no-results">
                            <i class="fas fa-search-minus"></i>
                            <p>No calculators found for "${query}"</p>
                            <p style="margin-top: 8px; font-size: 0.8rem;">Try different keywords</p>
                        </div>
                    `;
                    suggestionsDiv.classList.add('show');
                    return;
                }
                
                const suggestionsHtml = results.map(calc => {
                    const iconClass = `search-suggestion-icon ${calc.category}`;
                    return `
                        <div class="search-suggestion-item" onclick="handleToolClick('${calc.id}')">
                            <div class="${iconClass}">
                                <i class="${calc.icon}"></i>
                            </div>
                            <div class="search-suggestion-info">
                                <h4 class="search-suggestion-title">${highlightMatch(calc.title, query)}</h4>
                                <p class="search-suggestion-desc">${calc.categoryName} â€¢ ${calc.description.substring(0, 40)}...</p>
                            </div>
                            <i class="fas fa-arrow-right search-suggestion-arrow"></i>
                        </div>
                    `;
                }).join('');
                
                suggestionsDiv.innerHTML = suggestionsHtml;
                suggestionsDiv.classList.add('show');
            }
            
            function highlightMatch(text, query) {
                const regex = new RegExp(`(${query})`, 'gi');
                return text.replace(regex, '<span style="color: var(--accent-blue); font-weight: 700;">$1</span>');
            }
            
            function handleMobileCategoryClick(e) {
                const btn = e.currentTarget;
                const cat = btn.dataset.category;
                
                dbg('======================');
                dbg('[Mobile Menu] Category clicked:', cat);
                dbg('[Mobile Menu] Button element:', btn);
                dbg('[Mobile Menu] toolsData exists?', !!toolsData);
                dbg('[Mobile Menu] toolsData[cat]:', toolsData[cat]);
                dbg('[Mobile Menu] Has subcategories?', !!toolsData[cat]?.subcategories);
                if (toolsData[cat]?.subcategories) {
                    dbg('[Mobile Menu] Subcategories:', Object.keys(toolsData[cat].subcategories));
                }
                dbg('======================');
                
                // Add visual feedback
                btn.style.opacity = '0.5';
                setTimeout(() => { btn.style.opacity = '1'; }, 200);
                
                // Get tools for this category
                let tools = [];
                if (cat === 'all') {
                    // Get all tools from all categories
                    for (const [category, data] of Object.entries(toolsData)) {
                        if (data.subcategories) {
                            for (const subcategory of Object.values(data.subcategories)) {
                                tools = tools.concat(subcategory.calculators);
                            }
                        } else if (Array.isArray(data)) {
                            tools = tools.concat(data);
                        }
                    }
                } else if (toolsData[cat]?.subcategories) {
                    // For categories with subcategories, show subcategories instead
                    dbg('[Mobile Menu] Calling showSubcategoriesInMobile for:', cat);
                    try {
                        showSubcategoriesInMobile(cat);
                        dbg('[Mobile Menu] Successfully called showSubcategoriesInMobile');
                    } catch (error) {
                        dbgError('[Mobile Menu] Error showing subcategories:', error);
                        dbgError('[Mobile Menu] Error stack:', error.stack);
                        showToast('Kuch galat hua. Dobara try karein.', 'error');
                    }
                    return;
                } else if (Array.isArray(toolsData[cat])) {
                    tools = toolsData[cat];
                } else {
                    tools = [];
                }
                
                // Clear search (safely check if elements exist)
                if (mobileSearchInput) {
                    mobileSearchInput.value = '';
                }
                if (mobileSearchClear) {
                    mobileSearchClear.style.display = 'none';
                }
                
                // Show tools list
                const toolsHtml = tools.map(tool => `
                    <div class="mobile-tool-item" onclick="handleToolClick('${tool.id}')">
                        <div class="mobile-tool-icon">
                            <i class="${tool.icon}"></i>
                        </div>
                        <div class="mobile-tool-info">
                            <h4 class="mobile-tool-title">${tool.title}</h4>
                            <p class="mobile-tool-description">${tool.description}</p>
                        </div>
                        <i class="fas fa-chevron-right" style="color: var(--accent-blue); margin-left: auto;"></i>
                    </div>
                `).join('');
                
                mobileMenuContent.innerHTML = `
                    <div class="mobile-menu-tools-header">
                        <button class="mobile-menu-back-btn" id="mobileToolsBack">
                            <i class="fas fa-arrow-left"></i> Back to Categories
                        </button>
                    </div>
                    <div class="mobile-tools-list">
                        ${toolsHtml}
                    </div>
                `;
                
                // Handle back to categories
                document.getElementById('mobileToolsBack')?.addEventListener('click', displayMobileCategories);
            }
            
            function showSubcategoriesInMobile(category) {
                dbg('[Mobile Menu] showSubcategoriesInMobile called with:', category);
                dbg('[Mobile Menu] mobileMenuContent element:', mobileMenuContent);
                
                const subcategories = toolsData[category].subcategories;
                const categoryName = category.charAt(0).toUpperCase() + category.slice(1);
                
                dbg('[Mobile Menu] Showing subcategories for:', category);
                dbg('[Mobile Menu] Subcategories found:', Object.keys(subcategories));
                dbg('[Mobile Menu] Total subcategories:', Object.keys(subcategories).length);
                
                // Clear search (safely check if elements exist)
                if (mobileSearchInput) {
                    mobileSearchInput.value = '';
                }
                if (mobileSearchClear) {
                    mobileSearchClear.style.display = 'none';
                }
                
                // Create collapsible subcategory sections with tools
                const subcategoriesHtml = Object.entries(subcategories).map(([key, subcategory], index) => {
                    const tools = subcategory.calculators || [];
                    const toolsHtml = tools.map(tool => `
                        <div class="mobile-tool-item" onclick="handleToolClick('${tool.id}'); document.getElementById('mobileCategoriesMenu').classList.remove('active'); document.body.style.overflow = '';">
                            <div class="mobile-tool-icon">
                                <i class="${tool.icon}"></i>
                            </div>
                            <div class="mobile-tool-info">
                                <h4 class="mobile-tool-title">${tool.title}</h4>
                                <p class="mobile-tool-description">${tool.description}</p>
                            </div>
                            <i class="fas fa-chevron-right" style="color: var(--accent-blue); margin-left: auto;"></i>
                        </div>
                    `).join('');
                    
                    return `
                        <div class="mobile-subcategory-section">
                            <div class="mobile-subcategory-header ${index === 0 ? 'expanded' : ''}" 
                                 onclick="toggleMobileSubcategory(this)"
                                 role="button"
                                 tabindex="0"
                                 aria-expanded="${index === 0 ? 'true' : 'false'}"
                                 aria-controls="subcategory-${subcategory.name.replace(/\s+/g, '-').toLowerCase()}"
                                 onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();toggleMobileSubcategory(this);}">
                                <div class="mobile-subcategory-icon">
                                    <i class="${subcategory.icon}" aria-hidden="true"></i>
                                </div>
                                <div class="mobile-subcategory-info">
                                    <h4>${subcategory.name}</h4>
                                    <span class="mobile-subcategory-count">${tools.length} calculator${tools.length !== 1 ? 's' : ''}</span>
                                </div>
                                <i class="fas fa-chevron-down mobile-subcategory-toggle" aria-hidden="true"></i>
                            </div>
                            <div class="mobile-subcategory-tools ${index === 0 ? '' : 'collapsed'}"
                                 id="subcategory-${subcategory.name.replace(/\s+/g, '-').toLowerCase()}"
                                 role="region"
                                 aria-label="${subcategory.name} calculators">
                                ${toolsHtml}
                            </div>
                        </div>
                    `;
                }).join('');
                
                mobileMenuContent.innerHTML = `
                    <div class="mobile-menu-tools-header">
                        <button class="mobile-menu-back-btn" id="mobileSubcategoriesBack">
                            <i class="fas fa-arrow-left"></i> Back to Categories
                        </button>
                        <h3 style="color: var(--text-primary); margin: var(--space-md) 0; font-size: 1.1rem;">${categoryName} Calculators</h3>
                        <p style="color: var(--text-secondary); font-size: 0.85rem; margin: 0;">Tap a section to explore</p>
                    </div>
                    <div class="mobile-subcategories-container" data-category="${category}">
                        ${subcategoriesHtml}
                    </div>
                `;
                
                // Handle back button
                document.getElementById('mobileSubcategoriesBack')?.addEventListener('click', displayMobileCategories);
            }
            
            // Toggle mobile subcategory expand/collapse
            window.toggleMobileSubcategory = function(header) {
                const isExpanded = header.classList.contains('expanded');
                const toolsSection = header.nextElementSibling;
                
                if (isExpanded) {
                    header.classList.remove('expanded');
                    toolsSection.classList.add('collapsed');
                } else {
                    header.classList.add('expanded');
                    toolsSection.classList.remove('collapsed');
                }
            }
            
            window.showSubcategoryTools = function(category, subcategoryKey) {
                const subcategory = toolsData[category].subcategories[subcategoryKey];
                const tools = subcategory.calculators;
                const categoryName = category.charAt(0).toUpperCase() + category.slice(1);
                
                const toolsHtml = tools.map(tool => `
                    <div class="mobile-tool-item" onclick="handleToolClick('${tool.id}')">
                        <div class="mobile-tool-icon">
                            <i class="${tool.icon}"></i>
                        </div>
                        <div class="mobile-tool-info">
                            <h4 class="mobile-tool-title">${tool.title}</h4>
                            <p class="mobile-tool-description">${tool.description}</p>
                        </div>
                        <i class="fas fa-chevron-right" style="color: var(--accent-blue); margin-left: auto;"></i>
                    </div>
                `).join('');
                
                mobileMenuContent.innerHTML = `
                    <div class="mobile-menu-tools-header">
                        <button class="mobile-menu-back-btn" id="mobileToolsBackToSub">
                            <i class="fas fa-arrow-left"></i> Back to ${categoryName}
                        </button>
                        <h3 style="color: var(--text-primary); margin: var(--space-md) 0;">${subcategory.name}</h3>
                    </div>
                    <div class="mobile-tools-list">
                        ${toolsHtml}
                    </div>
                `;
                
                // Handle back button to subcategories
                document.getElementById('mobileToolsBackToSub')?.addEventListener('click', () => showSubcategoriesInMobile(category));
            }
            
            // Initialize categories on first load
            displayMobileCategories();
            
            // Close when clicking overlay
            mobileMenuOverlay.addEventListener('click', hideMobileCategoriesMenu);
            
            // Note: Event listeners are attached inside displayMobileCategories() function
            // No need to attach them here
            
            document.querySelectorAll('.nav-link, .hero-cta-button').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    const target = document.getElementById(targetId);
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth' });
                        if(navMenu.classList.contains('active')) {
                            toggleMobileMenu();
                        }
                    }
                });
            });
          
          // NEW: Modal Listeners
          modalCloseBtn.addEventListener('click', closeModal);
          calculatorModal.addEventListener('click', (e) => {
              if (e.target === calculatorModal) closeModal();
          });
          document.addEventListener('keydown', (e) => {
              if (e.key === "Escape" && calculatorModal.classList.contains('visible')) {
                  closeModal();
              }
          });
          // Login modal listeners (desktop + mobile)
          const handleLoginClick = (ev) => {
              ev.stopPropagation();
              const stored = localStorage.getItem('calculator-user-email');
              if (stored) {
                  // simple logout flow
                  if (confirm('Sign out from ' + stored + '?')) {
                      logout();
                  }
              } else {
                  showLoginModal();
              }
          };
          loginBtn?.addEventListener('click', handleLoginClick);
          mobileLoginBtn?.addEventListener('click', handleLoginClick);
          
          loginModalClose?.addEventListener('click', closeLoginModal);
          loginModal?.addEventListener('click', (e) => {
              if (e.target === loginModal) closeLoginModal();
          });
          loginForm?.addEventListener('submit', (e) => {
              e.preventDefault();
              handleLoginSubmit();
          });
          document.addEventListener('keydown', (e) => {
              if (e.key === 'Escape' && loginModal?.classList.contains('visible')) {
                  closeLoginModal();
              }
          });
          
          // Analytics modal listeners
          analyticsModalClose?.addEventListener('click', closeAnalyticsModal);
          analyticsModal?.addEventListener('click', (e) => {
              if (e.target === analyticsModal) closeAnalyticsModal();
          });
        }
        
        // Analytics Dashboard Functions
        window.showAnalyticsDashboard = function() {
            const summary = Analytics.getSummary();
            const popularCalcs = Analytics.getPopularCalculators(10);
            const data = Analytics.getData();
            
            analyticsModalBody.innerHTML = `
                <div style="padding: 16px;">
                    <!-- Summary Cards -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px; margin-bottom: 24px;">
                        <div style="background: var(--gradient-ai); padding: 16px; border-radius: 12px; text-align: center; color: white;">
                            <div style="font-size: 2rem; font-weight: 800;">${summary.totalVisits}</div>
                            <div style="font-size: 0.875rem; opacity: 0.9;">Total Visits</div>
                        </div>
                        <div style="background: var(--gradient-neon); padding: 16px; border-radius: 12px; text-align: center; color: white;">
                            <div style="font-size: 2rem; font-weight: 800;">${summary.totalCalculations}</div>
                            <div style="font-size: 0.875rem; opacity: 0.9;">Calculations</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #FF006E 0%, #8B5CF6 100%); padding: 16px; border-radius: 12px; text-align: center; color: white;">
                            <div style="font-size: 2rem; font-weight: 800;">${summary.searchesPerformed}</div>
                            <div style="font-size: 0.875rem; opacity: 0.9;">Searches</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #FFA500 0%, #FF006E 100%); padding: 16px; border-radius: 12px; text-align: center; color: white;">
                            <div style="font-size: 2rem; font-weight: 800;">${summary.themeChanges}</div>
                            <div style="font-size: 0.875rem; opacity: 0.9;">Theme Toggles</div>
                        </div>
                    </div>
                    
                    <!-- Most Used Category -->
                    <div style="background: var(--bg-tertiary); padding: 16px; border-radius: 12px; margin-bottom: 24px;">
                        <h3 style="margin: 0 0 12px 0; color: var(--text-primary); font-size: 1.1rem;">
                            â­ Most Used Category
                        </h3>
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--accent-blue); text-transform: capitalize;">
                            ${summary.mostUsedCategory}
                        </div>
                    </div>
                    
                    <!-- Popular Calculators -->
                    <div style="background: var(--bg-tertiary); padding: 16px; border-radius: 12px; margin-bottom: 16px;">
                        <h3 style="margin: 0 0 16px 0; color: var(--text-primary); font-size: 1.1rem;">
                            ðŸ† Top 10 Most Used Calculators
                        </h3>
                        <div style="display: flex; flex-direction: column; gap: 12px;">
                            ${popularCalcs.length > 0 ? popularCalcs.map((calc, i) => `
                                <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--bg-secondary); border-radius: 8px;">
                                    <div style="font-size: 1.5rem; font-weight: 800; color: ${i < 3 ? 'var(--accent-blue)' : 'var(--text-secondary)'}; min-width: 30px;">
                                        ${i + 1}
                                    </div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600; color: var(--text-primary);">${calc.name}</div>
                                        <div style="font-size: 0.875rem; color: var(--text-secondary);">
                                            ${calc.opens} opens â€¢ ${calc.calculations} calculations
                                        </div>
                                    </div>
                                </div>
                            `).join('') : '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">No calculator usage data yet. Start using calculators!</p>'}
                        </div>
                    </div>
                    
                    <!-- Failed Searches -->
                    ${data.failedSearches.length > 0 ? `
                        <div style="background: var(--bg-tertiary); padding: 16px; border-radius: 12px; margin-bottom: 16px;">
                            <h3 style="margin: 0 0 12px 0; color: var(--text-primary); font-size: 1.1rem;">
                                âŒ Recent Failed Searches
                            </h3>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                ${data.failedSearches.slice(-10).reverse().map(s => `
                                    <span style="background: var(--bg-secondary); padding: 6px 12px; border-radius: 6px; font-size: 0.875rem; color: var(--text-secondary);">
                                        "${s.query}"
                                    </span>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                    
                    <!-- Actions -->
                    <div style="display: flex; gap: 12px; justify-content: center; margin-top: 24px; flex-wrap: wrap;">
                        <button onclick="Analytics.logSummary()" class="tool-action" style="background: var(--gradient-ai);">
                            ðŸ“‹ Log to Console
                        </button>
                        <button onclick="if(confirm('Clear all analytics data?')) { Analytics.clear(); showAnalyticsDashboard(); }" class="tool-action" style="background: var(--accent-pink);">
                            ðŸ—‘ï¸ Clear Data
                        </button>
                    </div>
                </div>
            `;
            
            analyticsModal.classList.add('visible');
            analyticsModal.setAttribute('aria-hidden', 'false');
            document.body.style.overflow = 'hidden';
        }
        
        window.closeAnalyticsModal = function() {
            analyticsModal.classList.remove('visible');
            analyticsModal.setAttribute('aria-hidden', 'true');
            document.body.style.overflow = '';
        }
        
        // --- MODIFIED & NEW FUNCTIONS for Modal ---
        function handleToolClick(toolId) {
            // Search for tool in all categories including subcategories
            let tool = null;
            
            for (const [category, data] of Object.entries(toolsData)) {
                if (data.subcategories) {
                    // Search in subcategories
                    for (const subcategory of Object.values(data.subcategories)) {
                        tool = subcategory.calculators.find(t => t.id === toolId);
                        if (tool) break;
                    }
                } else if (Array.isArray(data)) {
                    // Search in simple array
                    tool = data.find(t => t.id === toolId);
                }
                if (tool) break;
            }
            
            if (!tool) {
                console.error('Tool not found:', toolId);
                showToast('Calculator nahi mila. Koi aur try karein.', 'warning');
                return;
            }
            
            // If tool has a URL (separate HTML file), navigate to it
            if (tool.url) {
                window.location.href = tool.url;
                return;
            }
            
            // If tool has modal implementation, show modal
            const implementation = calculatorImplementations[toolId];
            if (implementation) {
                showCalculatorModal(toolId);
            } else {
                // Better fallback message
                showToast(`"${tool.title}" jald aa raha hai! ðŸš€ Hum is calculator pe kaam kar rahe hain.`, 'info', 5000);
            }
        }
        
        function showCalculatorModal(toolId) {
            // Find tool in all categories including subcategories
            let tool = null;
            for (const [category, data] of Object.entries(toolsData)) {
                if (data.subcategories) {
                    for (const subcategory of Object.values(data.subcategories)) {
                        tool = subcategory.calculators.find(t => t.id === toolId);
                        if (tool) break;
                    }
                } else if (Array.isArray(data)) {
                    tool = data.find(t => t.id === toolId);
                }
                if (tool) break;
            }
            
            const implementation = calculatorImplementations[toolId];
            
            // Track calculator open
            Analytics.trackCalculatorOpen(toolId, tool.title);
            
            // Show modal with skeleton loading state
            modalTitle.textContent = tool.title;
            modalBody.innerHTML = `
                <div class="skeleton-loading-container">
                    <div class="skeleton-loader"></div>
                    <div class="skeleton-loader input"></div>
                    <div class="skeleton-loader"></div>
                    <div class="skeleton-loader input"></div>
                    <div class="skeleton-loader"></div>
                    <div class="skeleton-loader input"></div>
                    <div class="skeleton-loader result"></div>
                </div>
            `;
            calculatorModal.classList.add('visible');
            calculatorModal.setAttribute('aria-hidden', 'false');
            document.body.style.overflow = 'hidden';
            
            // Store the last focused element to return focus on close
            window.lastFocusedElement = document.activeElement;
            
            // Focus modal for screen readers
            setTimeout(() => {
                modalCloseBtn.focus();
            }, 100);
            
            // Load calculator content after a brief delay for smooth UX
            setTimeout(() => {
                modalBody.style.opacity = '0';
                setTimeout(() => {
                    modalBody.innerHTML = implementation.getHTML();
                    implementation.attachEventListeners(calculatorModal);
                    modalBody.style.transition = 'opacity 0.3s ease-out';
                    modalBody.style.opacity = '1';
                    
                    // Focus first input in calculator
                    const firstInput = modalBody.querySelector('input, select');
                    if (firstInput) {
                        setTimeout(() => firstInput.focus(), 100);
                    }
                    
                    // Setup focus trap
                    setupFocusTrap(calculatorModal);
                }, 150);
            }, 400);
        }
        
        // Focus trap for modal accessibility
        function setupFocusTrap(modal) {
            const focusableElements = modal.querySelectorAll(
                'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
            );
            const firstElement = focusableElements[0];
            const lastElement = focusableElements[focusableElements.length - 1];
            
            const handleTabKey = (e) => {
                if (e.key !== 'Tab') return;
                
                if (e.shiftKey) {
                    if (document.activeElement === firstElement) {
                        e.preventDefault();
                        lastElement.focus();
                    }
                } else {
                    if (document.activeElement === lastElement) {
                        e.preventDefault();
                        firstElement.focus();
                    }
                }
            };
            
            modal.addEventListener('keydown', handleTabKey);
            modal._removeFocusTrap = () => modal.removeEventListener('keydown', handleTabKey);
        }

        function closeModal() {
            calculatorModal.classList.remove('visible');
            calculatorModal.setAttribute('aria-hidden', 'true');
            document.body.style.overflow = '';
            
            // Remove focus trap
            if (calculatorModal._removeFocusTrap) {
                calculatorModal._removeFocusTrap();
            }
            
            // Return focus to the element that opened the modal
            if (window.lastFocusedElement) {
                window.lastFocusedElement.focus();
            }
            
            setTimeout(() => {
                modalBody.innerHTML = ''; // Clear content after animation
            }, 300);
        }
        
        // Helper function to show calculating state
        function showCalculatingState(resultElement) {
            if (!resultElement) return;
            
            const originalValue = resultElement.textContent;
            resultElement.classList.add('loading');
            resultElement.innerHTML = '<span class="calculating-spinner">Calculating</span>';
            
            return {
                hide: () => {
                    resultElement.classList.remove('loading');
                },
                setValue: (value) => {
                    resultElement.classList.remove('loading');
                    resultElement.textContent = value;
                }
            };
        }
        
        // Add smooth transition when switching categories
        function switchCategoryWithTransition(newCategory) {
            toolsGrid.style.opacity = '0';
            toolsGrid.style.transform = 'translateY(10px)';
            
            setTimeout(() => {
                currentCategory = newCategory;
                renderTools();
                
                setTimeout(() => {
                    toolsGrid.style.transition = 'opacity 0.3s ease-out, transform 0.3s ease-out';
                    toolsGrid.style.opacity = '1';
                    toolsGrid.style.transform = 'translateY(0)';
                }, 50);
            }, 150);
        }
        
        // --- Login modal helpers ---
        function showLoginModal() {
            loginModal.classList.add('visible');
            document.body.style.overflow = 'hidden';
            // focus email after small timeout so modal is fully visible
            setTimeout(() => document.getElementById('loginEmail')?.focus(), 120);
        }

        function closeLoginModal() {
            loginModal.classList.remove('visible');
            document.body.style.overflow = '';
            // clear form
            loginForm?.reset();
        }

        function handleLoginSubmit() {
            const email = (document.getElementById('loginEmail') || {}).value || '';
            // Basic client-side validation
            if (!email || !email.includes('@')) {
                showToast('Kripya valid email enter karein.', 'warning');
                return;
            }
            // Persist a simple logged-in flag (for demo purposes only)
            localStorage.setItem('calculator-user-email', email);
            updateLoginState();
            closeLoginModal();
            showToast('Successfully signed in as ' + email, 'success');
        }

        function updateLoginState() {
            const email = localStorage.getItem('calculator-user-email');
            const mobileBottomNavLabel = document.getElementById('mobileBottomNavLabel');
            const accountNavItem = document.querySelector('.mobile-nav-item[data-section="account"]');
            
            if (email) {
                const short = email.split('@')[0];
                if (loginBtn) {
                    loginBtn.innerHTML = `<i class="fas fa-user-check"></i> ${short}`;
                    loginBtn.dataset.logged = 'true';
                }
                if (mobileLoginBtn) {
                    mobileLoginBtn.innerHTML = `<i class="fas fa-user-check"></i><span>${short}</span>`;
                    mobileLoginBtn.dataset.logged = 'true';
                }
                if (mobileBottomNavLabel) {
                    mobileBottomNavLabel.textContent = short;
                }
                if (accountNavItem) {
                    accountNavItem.dataset.logged = 'true';
                    accountNavItem.querySelector('i').className = 'fas fa-user-check';
                }
            } else {
                if (loginBtn) {
                    loginBtn.innerHTML = '<i class="fas fa-user"></i> Login';
                    delete loginBtn.dataset.logged;
                }
                if (mobileLoginBtn) {
                    mobileLoginBtn.innerHTML = '<i class="fas fa-user"></i><span>Login</span>';
                    delete mobileLoginBtn.dataset.logged;
                }
                if (mobileBottomNavLabel) {
                    mobileBottomNavLabel.textContent = 'Login';
                }
                if (accountNavItem) {
                    delete accountNavItem.dataset.logged;
                    accountNavItem.querySelector('i').className = 'fas fa-user';
                }
            }
        }

        function logout() {
            localStorage.removeItem('calculator-user-email');
            updateLoginState();
            // Show success message
            showToast('Logged out successfully! ðŸ‘‹', 'success');
        }
        
        // --- UNCHANGED FUNCTIONS ---
        function handleSearch(e) {
          searchQuery = e.target.value.toLowerCase();
          searchClear.classList.toggle('visible', searchQuery.length > 0);
          
          // Track search if query is meaningful (3+ chars)
          if (searchQuery.length >= 3) {
            const filteredTools = getFilteredTools();
            Analytics.trackSearch(searchQuery, filteredTools.length);
          }
          
          showSearchSuggestions();
          renderTools();
        }
        function clearSearch() {
          if (searchInput) {
              searchInput.value = '';
          }
          searchQuery = '';
          if (searchClear) {
              searchClear.classList.remove('visible');
          }
          hideSearchSuggestions();
          renderTools();
        }
        function showSearchSuggestions() {
          if (searchQuery.length === 0) { 
            hideSearchSuggestions(); 
            return; 
          }
          
          if (searchQuery.length < 2) {
            // Show hint for typing more
            searchSuggestions.innerHTML = `
              <div style="padding: var(--space-md); color: var(--text-secondary); font-size: 0.9rem; text-align: center;">
                <i class="fas fa-keyboard" style="margin-right: 8px;"></i>
                Type at least 2 characters...
              </div>
            `;
            searchSuggestions.classList.add('visible');
            return;
          }
          
          const suggestions = generateSearchSuggestions();
          if (suggestions.length > 0) {
            renderSearchSuggestions(suggestions);
            searchSuggestions.classList.add('visible');
          } else {
            // Show "no results" message
            searchSuggestions.innerHTML = `
              <div style="padding: var(--space-md); color: var(--text-secondary); font-size: 0.9rem; text-align: center;">
                <i class="fas fa-search" style="margin-right: 8px; opacity: 0.5;"></i>
                No calculators found
              </div>
            `;
            searchSuggestions.classList.add('visible');
          }
        }
        function hideSearchSuggestions() { searchSuggestions.classList.remove('visible'); }
        function generateSearchSuggestions() {
          const allTools = [];
          
          // Extract tools from all categories including subcategories
          for (const [category, data] of Object.entries(toolsData)) {
            if (data.subcategories) {
              // Category has subcategories
              for (const subcategory of Object.values(data.subcategories)) {
                allTools.push(...subcategory.calculators);
              }
            } else if (Array.isArray(data)) {
              // Simple array category
              allTools.push(...data);
            }
          }
          
          return allTools.filter(tool => 
            tool.title.toLowerCase().includes(searchQuery) || 
            tool.description.toLowerCase().includes(searchQuery)
          ).slice(0, 5);
        }
        function renderSearchSuggestions(suggestions) {
          searchSuggestions.innerHTML = suggestions.map(tool => `
              <div class="suggestion-item" data-id="${tool.id}" onclick="selectTool('${tool.id}')">
                <i class="${tool.icon}"></i>
                <span>${tool.title}</span>
              </div>`).join('');
        }
        function selectTool(toolId) {
          // Find tool in all categories including subcategories
          let tool = null;
          
          for (const [category, data] of Object.entries(toolsData)) {
            if (data.subcategories) {
              for (const subcategory of Object.values(data.subcategories)) {
                tool = subcategory.calculators.find(t => t.id === toolId);
                if (tool) break;
              }
            } else if (Array.isArray(data)) {
              tool = data.find(t => t.id === toolId);
            }
            if (tool) break;
          }
          
          if (tool) {
            // Directly open the calculator instead of just searching
            hideSearchSuggestions();
            handleToolClick(toolId);
            if (searchInput) {
                searchInput.value = ''; // Clear search after selecting
            }
            searchQuery = '';
            if (searchClear) {
                searchClear.classList.remove('visible');
            }
          }
        }
        function handleCategoryClick(e) {
            const button = e.target.closest('.tab-button');
            if (!button) return;
            
            const newCategory = button.dataset.category;
            
            // Don't animate if clicking the same category
            if (newCategory === currentCategory) return;
            
            // Update active state for both desktop and mobile tabs
            document.querySelectorAll('.tab-button.active').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll(`.tab-button[data-category="${newCategory}"]`).forEach(btn => btn.classList.add('active'));
            
            // Smooth transition effect
            toolsGrid.style.opacity = '0';
            toolsGrid.style.transform = 'translateY(10px)';
            
            setTimeout(() => {
                currentCategory = newCategory;
                
                // Track category view
                Analytics.trackCategoryView(newCategory);
                
                if (window.innerWidth <= 768) {
                    // On mobile, render tools in the mobile menu
                    const tools = getFilteredTools();
                    const mobileToolsContainer = document.getElementById('mobileMenuTools');
                    
                    mobileToolsContainer.innerHTML = tools.map(tool => `
                        <div class="tool-card" data-category="${currentCategory}" onclick="handleToolClick('${tool.id}')">
                            <div class="tool-header">
                                <div class="tool-icon"><i class="${tool.icon}"></i></div>
                                <div class="tool-content">
                                    <h3 class="tool-title">${tool.title}</h3>
                                    <p class="tool-description">${tool.description}</p>
                                </div>
                            </div>
                        </div>
                    `).join('');
                    
                    mobileToolsContainer.classList.add('visible');
                }
                
                // Always render in main content for both mobile and desktop
                renderTools();
                
                // Fade back in
                setTimeout(() => {
                    toolsGrid.style.transition = 'opacity 0.4s ease-out, transform 0.4s ease-out';
                    toolsGrid.style.opacity = '1';
                    toolsGrid.style.transform = 'translateY(0)';
                }, 50);
            }, 200);
        }
        function renderTools() {
          const filteredTools = getFilteredTools();
          
          // Check if current category has subcategories AND no search is active
          if (toolsData[currentCategory]?.subcategories && !searchQuery) {
            renderCategoryWithSubcategories(currentCategory, filteredTools);
            return;
          }
          
          if (filteredTools.length === 0) {
            toolsGrid.innerHTML = `<div class="no-results"><i class="fas fa-search"></i><h3>No calculators found</h3><p>Try adjusting your search or category filter.</p></div>`;
            return;
          }
          toolsGrid.innerHTML = filteredTools.map(tool => createToolCard(tool)).join('');
          observeToolCards();
        }
        
        function renderCategoryWithSubcategories(category, filteredTools) {
          const subcategories = toolsData[category].subcategories;
          let html = '';
          
          for (const [key, subcategory] of Object.entries(subcategories)) {
            const calculators = subcategory.calculators.filter(calc => {
              if (!searchQuery) return true;
              return calc.title.toLowerCase().includes(searchQuery) || 
                     calc.description.toLowerCase().includes(searchQuery);
            });
            
            if (calculators.length === 0 && searchQuery) continue;
            
            html += `
              <div class="subcategory-section">
                <div class="subcategory-header" 
                     onclick="toggleSubcategory('${category}-${key}')"
                     role="button"
                     tabindex="0"
                     aria-expanded="false"
                     aria-controls="subcategory-${category}-${key}"
                     onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();toggleSubcategory('${category}-${key}');}">
                  <div class="subcategory-icon">
                    <i class="${subcategory.icon}" aria-hidden="true"></i>
                  </div>
                  <h3 class="subcategory-title">${subcategory.name}</h3>
                  <i class="fas fa-chevron-down subcategory-toggle" aria-hidden="true"></i>
                </div>
                <div class="subcategory-calculators collapsed" 
                     id="subcategory-${category}-${key}"
                     role="region"
                     aria-label="${subcategory.name} calculators">
                  ${calculators.map(tool => createToolCard(tool)).join('')}
                </div>
              </div>
            `;
          }
          
          if (html === '') {
            toolsGrid.innerHTML = `<div class="no-results"><i class="fas fa-search"></i><h3>No calculators found</h3><p>Try adjusting your search or category filter.</p></div>`;
          } else {
            toolsGrid.innerHTML = html;
            observeToolCards();
          }
        }
        
        window.toggleSubcategory = function(key) {
          const header = event.currentTarget;
          const calculators = document.getElementById(`subcategory-${key}`);
          
          if (!calculators) return;
          
          // Toggle classes
          const isExpanded = header.classList.contains('expanded');
          header.classList.toggle('expanded');
          calculators.classList.toggle('collapsed');
          
          // Update ARIA attributes
          const isNowExpanded = header.classList.contains('expanded');
          header.setAttribute('aria-expanded', isNowExpanded);
          
          // Track analytics
          if (isNowExpanded) {
            const subcategoryName = header.querySelector('.subcategory-title')?.textContent || 'Unknown';
            Analytics.trackEvent('subcategory_expanded', { 
              subcategory: subcategoryName,
              view: 'desktop' 
            });
          }
          
          // Smooth scroll if expanded
          if (isNowExpanded) {
            setTimeout(() => {
              header.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 300);
          }
        }
        
        function getFilteredTools() {
          let tools = [];
          
          if (currentCategory === 'all') {
            // Get all tools from all categories
            for (const [category, data] of Object.entries(toolsData)) {
              if (data.subcategories) {
                // Handle subcategorized data
                for (const subcategory of Object.values(data.subcategories)) {
                  tools = tools.concat(subcategory.calculators);
                }
              } else if (Array.isArray(data)) {
                // Handle regular array data
                tools = tools.concat(data);
              }
            }
          } else if (toolsData[currentCategory]?.subcategories) {
            // Category has subcategories - get all calculators from all subcategories
            for (const subcategory of Object.values(toolsData[currentCategory].subcategories)) {
              tools = tools.concat(subcategory.calculators);
            }
          } else if (Array.isArray(toolsData[currentCategory])) {
            // Regular array category
            tools = toolsData[currentCategory];
          } else {
            // Fallback
            tools = [];
          }
          
          if (searchQuery) {
            tools = tools.filter(tool => 
              tool.title.toLowerCase().includes(searchQuery) || 
              tool.description.toLowerCase().includes(searchQuery)
            );
          }
          return tools;
        }
        function createToolCard(tool) {
          const categoryName = getCategoryName(tool);
          return `
            <div class="tool-card" 
                 data-category="${categoryName.toLowerCase()}" 
                 onclick="handleToolClick('${tool.id}')"
                 onkeydown="if(event.key === 'Enter' || event.key === ' ') { event.preventDefault(); handleToolClick('${tool.id}'); }"
                 tabindex="0"
                 role="button"
                 aria-label="Open ${tool.title} calculator">
              <div class="tool-header">
                <div class="tool-icon" aria-hidden="true"><i class="${tool.icon}"></i></div>
                <h3 class="tool-title">${tool.title}</h3>
              </div>
              <div class="tool-content"><p class="tool-description">${tool.description}</p></div>
              <button class="tool-action" tabindex="-1" aria-hidden="true">${tool.action}</button>
            </div>`;
        }
        function getCategoryName(tool) {
          for (const [category, data] of Object.entries(toolsData)) {
            if (data.subcategories) {
              // Check in subcategories
              for (const subcategory of Object.values(data.subcategories)) {
                if (subcategory.calculators.some(t => t.id === tool.id)) {
                  return category.charAt(0).toUpperCase() + category.slice(1);
                }
              }
            } else if (Array.isArray(data)) {
              // Check in regular array
              if (data.some(t => t.id === tool.id)) {
                return category.charAt(0).toUpperCase() + category.slice(1);
              }
            }
          }
          return 'Tool';
        }
        function toggleMobileMenu() {
            const isActive = navMenu.classList.toggle('active');
            mobileMenuToggle.classList.toggle('active');
            document.getElementById('mobileCategoryTabs')?.classList.toggle('mobile-active');
            mobileMenuOverlay.classList.toggle('active');
            document.body.style.overflow = document.getElementById('mobileCategoryTabs')?.classList.contains('mobile-active') ? 'hidden' : '';
            
            // Update ARIA attributes
            mobileMenuToggle.setAttribute('aria-expanded', isActive);
            mobileMenuToggle.setAttribute('aria-label', isActive ? 'Close mobile menu' : 'Open mobile menu');
            
            // Show/hide back button
            const mobileNavBack = document.getElementById('mobileNavBack');
            if (document.getElementById('mobileCategoryTabs')?.classList.contains('mobile-active')) {
                mobileNavBack?.classList.add('visible');
            } else {
                mobileNavBack?.classList.remove('visible');
                document.getElementById('mobileMenuTools')?.classList.remove('visible');
            }

            // When opening menu, trigger click on currently active category
            if (document.getElementById('mobileCategoryTabs')?.classList.contains('mobile-active')) {
                const activeCategory = currentCategory || 'all';
                const activeButton = document.querySelector(`#mobileCategoryTabs .tab-button[data-category="${activeCategory}"]`);
                if (activeButton) {
                    activeButton.click();
                }
            }
        }

        // Close mobile menu when clicking overlay or close button
        mobileMenuOverlay.addEventListener('click', () => {
          if (categoryTabs.classList.contains('mobile-active')) {
            toggleMobileMenu();
          }
        });

        document.getElementById('mobileMenuClose').addEventListener('click', () => {
          if (categoryTabs.classList.contains('mobile-active')) {
            toggleMobileMenu();
          }
        });

        // Handle search button click
        document.getElementById('searchAction').addEventListener('click', () => {
          const query = searchInput.value.trim();
          if (query) {
            handleSearch({ target: searchInput }); // Reuse existing search handler
          }
        });
        function createScrollToTopButton() {
            if(document.getElementById('scrollToTop')) return;
            const button = document.createElement('button');
            button.id = 'scrollToTop';
            button.className = 'scroll-to-top';
            button.innerHTML = '<i class="fas fa-arrow-up"></i>';
            button.style.display = 'none';
            button.onclick = () => window.scrollTo({ top: 0, behavior: 'smooth' });
            document.body.appendChild(button);
            window.addEventListener('scroll', () => {
                button.style.display = (window.pageYOffset > 300) ? 'flex' : 'none';
                updateMobileBottomNavActiveState();
            });
        }
        
        // Scroll to section function
        window.scrollToSection = function(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                // Haptic feedback for mobile devices
                if (navigator.vibrate) {
                    navigator.vibrate(10);
                }
                
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
                updateMobileBottomNavActiveState(sectionId);
            }
        };
        
        // Update mobile bottom nav active state
        function updateMobileBottomNavActiveState(activeSection) {
            const navItems = document.querySelectorAll('.mobile-bottom-nav .mobile-nav-item');
            
            // If activeSection is provided, set it directly
            if (activeSection) {
                navItems.forEach(item => {
                    if (item.dataset.section === activeSection) {
                        item.classList.add('active');
                    } else {
                        item.classList.remove('active');
                    }
                });
                return;
            }
            
            // Otherwise, determine active section based on scroll position
            const sections = ['home', 'calculators'];
            let currentSection = 'home';
            
            for (const sectionId of sections) {
                const section = document.getElementById(sectionId);
                if (section) {
                    const rect = section.getBoundingClientRect();
                    if (rect.top <= 100 && rect.bottom >= 100) {
                        currentSection = sectionId;
                        break;
                    }
                }
            }
            
            navItems.forEach(item => {
                if (item.dataset.section === currentSection) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        }
        function observeToolCards() {
          const observer = new IntersectionObserver((entries, obs) => {
            entries.forEach(entry => {
              if (entry.isIntersecting) {
                entry.target.classList.add('visible');
                obs.unobserve(entry.target);
              }
            });
          }, { threshold: 0.1 });
          document.querySelectorAll('.tool-card:not(.visible)').forEach(card => {
            observer.observe(card);
          });
        }

        // Mobile Subcategory Toggle Function
        function toggleMobileSubcategory(headerElement) {
            // Get the tools container (next sibling)
            const toolsContainer = headerElement.nextElementSibling;
            
            if (!toolsContainer) return;
            
            // Toggle expanded state on header
            const isExpanded = headerElement.classList.contains('expanded');
            headerElement.classList.toggle('expanded');
            
            // Toggle collapsed state on tools container
            toolsContainer.classList.toggle('collapsed');
            
            // Update ARIA attributes for accessibility
            const isNowExpanded = headerElement.classList.contains('expanded');
            headerElement.setAttribute('aria-expanded', isNowExpanded);
            
            // Track analytics
            if (isNowExpanded) {
                const subcategoryName = headerElement.querySelector('.mobile-subcategory-info h4')?.textContent || 'Unknown';
                Analytics.trackEvent('subcategory_expanded', { subcategory: subcategoryName });
            }
            
            // Smooth scroll to keep the header visible
            if (isNowExpanded) {
                setTimeout(() => {
                    headerElement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }, 300);
            }
        }

        // --- PWA Features ---
        
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // Register inline service worker
                const swCode = `
                    const CACHE_NAME = 'calculator-loop-v1';
                    const urlsToCache = [
                        '/',
                        '/ui.html'
                    ];

                    // Install event - cache resources
                    self.addEventListener('install', (event) => {
                        event.waitUntil(
                            caches.open(CACHE_NAME)
                                .then((cache) => cache.addAll(urlsToCache))
                                .then(() => self.skipWaiting())
                        );
                    });

                    // Activate event - clean old caches
                    self.addEventListener('activate', (event) => {
                        event.waitUntil(
                            caches.keys().then((cacheNames) => {
                                return Promise.all(
                                    cacheNames.map((cacheName) => {
                                        if (cacheName !== CACHE_NAME) {
                                            return caches.delete(cacheName);
                                        }
                                    })
                                );
                            }).then(() => self.clients.claim())
                        );
                    });

                    // Fetch event - serve from cache, fallback to network
                    self.addEventListener('fetch', (event) => {
                        event.respondWith(
                            caches.match(event.request)
                                .then((response) => {
                                    // Cache hit - return response
                                    if (response) {
                                        return response;
                                    }
                                    // Clone request for fetching
                                    return fetch(event.request.clone()).then((response) => {
                                        // Check if valid response
                                        if (!response || response.status !== 200 || response.type !== 'basic') {
                                            return response;
                                        }
                                        // Clone response for caching
                                        const responseToCache = response.clone();
                                        caches.open(CACHE_NAME).then((cache) => {
                                            cache.put(event.request, responseToCache);
                                        });
                                        return response;
                                    });
                                })
                                .catch(() => {
                                    // Return offline fallback
                                    return new Response(
                                        '<html><body style="font-family:Arial;text-align:center;padding:50px;"><h1>ðŸ“± Offline Mode</h1><p>Calculator Loop is available offline. Your recent calculations are still accessible.</p></body></html>',
                                        { headers: { 'Content-Type': 'text/html' } }
                                    );
                                })
                        );
                    });
                `;
                
                const blob = new Blob([swCode], { type: 'application/javascript' });
                const swUrl = URL.createObjectURL(blob);
                
                navigator.serviceWorker.register(swUrl)
                    .then((registration) => {
                        dbg('âœ… Service Worker registered:', registration.scope);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    dbg('ðŸ”„ New version available! Please refresh.');
                                    showToast('New version available! Please refresh.', 'info');
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        dbgError('âŒ Service Worker registration failed:', error);
                    });
            });
        }

        // PWA Install Prompt
        let deferredPrompt;
        let installButton;

        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent the mini-infobar from appearing on mobile
            e.preventDefault();
            // Stash the event so it can be triggered later
            deferredPrompt = e;
            // Show install button
            showInstallPromotion();
        });

        function showInstallPromotion() {
            // Create install button if it doesn't exist
            if (!installButton) {
                installButton = document.createElement('button');
                installButton.id = 'pwa-install-btn';
                installButton.innerHTML = '<i class="fas fa-download"></i> Install App';
                installButton.style.cssText = `
                    position: fixed;
                    bottom: 80px;
                    right: 20px;
                    z-index: 1001;
                    background: linear-gradient(135deg, #00D4FF, #8B5CF6);
                    color: white;
                    border: none;
                    padding: 14px 24px;
                    border-radius: 50px;
                    font-family: var(--font-secondary);
                    font-weight: 700;
                    font-size: 0.95rem;
                    cursor: pointer;
                    box-shadow: 0 8px 24px rgba(0, 212, 255, 0.4);
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    animation: slideInUp 0.5s ease-out, pulse 2s infinite;
                    transition: all 0.3s ease;
                `;
                
                installButton.addEventListener('click', async () => {
                    if (!deferredPrompt) return;
                    
                    // Show install prompt
                    deferredPrompt.prompt();
                    
                    // Wait for user response
                    const { outcome } = await deferredPrompt.userChoice;
                    dbg(`User response: ${outcome}`);
                    
                    // Track analytics
                    Analytics.trackEvent('pwa_install_prompt', { outcome });
                    
                    if (outcome === 'accepted') {
                        dbg('âœ… User accepted the install prompt');
                        showToast('App installing...', 'success');
                    } else {
                        dbg('âŒ User dismissed the install prompt');
                    }
                    
                    // Clear the deferred prompt
                    deferredPrompt = null;
                    
                    // Hide button
                    installButton.style.display = 'none';
                });
                
                // Add hover effect
                installButton.addEventListener('mouseenter', () => {
                    installButton.style.transform = 'translateY(-4px) scale(1.05)';
                    installButton.style.boxShadow = '0 12px 32px rgba(0, 212, 255, 0.5)';
                });
                
                installButton.addEventListener('mouseleave', () => {
                    installButton.style.transform = 'translateY(0) scale(1)';
                    installButton.style.boxShadow = '0 8px 24px rgba(0, 212, 255, 0.4)';
                });
                
                document.body.appendChild(installButton);
            }
            
            installButton.style.display = 'flex';
        }

        // Handle successful installation
        window.addEventListener('appinstalled', () => {
            dbg('âœ… Calculator Loop has been installed');
            Analytics.trackEvent('pwa_installed');
            showToast('âœ… App installed successfully!', 'success');
            
            // Hide install button
            if (installButton) {
                installButton.style.display = 'none';
            }
            
            // Clear the deferred prompt
            deferredPrompt = null;
            
            // Show success message
            const successMsg = document.createElement('div');
            successMsg.innerHTML = 'âœ… App installed successfully!';
            successMsg.style.cssText = `
                position: fixed;
                top: 80px;
                left: 50%;
                transform: translateX(-50%);
                z-index: 2000;
                background: linear-gradient(135deg, #00FF88, #22D3EE);
                color: white;
                padding: 16px 32px;
                border-radius: 12px;
                font-family: var(--font-secondary);
                font-weight: 700;
                box-shadow: 0 8px 24px rgba(0, 255, 136, 0.4);
                animation: slideInDown 0.5s ease-out;
            `;
            document.body.appendChild(successMsg);
            
            setTimeout(() => {
                successMsg.style.animation = 'fadeOut 0.5s ease-out';
                setTimeout(() => successMsg.remove(), 500);
            }, 3000);
        });

        // Check if already installed
        if (window.matchMedia('(display-mode: standalone)').matches) {
            dbg('âœ… Running as installed PWA');
            Analytics.trackEvent('pwa_launched');
        }

        // ========== Navigation Categories Dropdown ==========
        function populateNavCategoriesDropdown() {
            const dropdown = document.getElementById('navCategoryDropdown');
            if (!dropdown) return;
            
            let html = '';
            
            // Add "All Calculators" first
            html += `<a href="#calculators" class="dropdown-item" data-category="all" onclick="handleNavCategoryClick('all'); return false;">
                <i class="fas fa-th-large"></i> All Calculators
            </a>`;
            
            // Iterate through all categories and add their subcategories
            const categoryInfo = {
                'financial': { name: 'Financial', icon: 'fas fa-chart-line' },
                'health': { name: 'Health & Fitness', icon: 'fas fa-heartbeat' },
                'math': { name: 'Math & Number', icon: 'fas fa-calculator' },
                'datetime': { name: 'Date & Time', icon: 'fas fa-clock' },
                'construction': { name: 'Construction & Engineering', icon: 'fas fa-hard-hat' },
                'business': { name: 'Business & Marketing', icon: 'fas fa-briefcase' },
                'everyday': { name: 'Everyday Life', icon: 'fas fa-home' },
                'education': { name: 'Education & Learning', icon: 'fas fa-graduation-cap' },
                'technology': { name: 'Technology & Computer', icon: 'fas fa-laptop-code' },
                'scientific': { name: 'Science (Physics, Chemistry & Astronomy)', icon: 'fas fa-flask' }
            };
            
            for (const [catKey, catData] of Object.entries(toolsData)) {
                const catInfo = categoryInfo[catKey];
                if (!catInfo) continue;
                
                // Add main category
                html += `<a href="#calculators" class="dropdown-item" data-category="${catKey}" onclick="handleNavCategoryClick('${catKey}'); return false;">
                    <i class="${catInfo.icon}"></i> ${catInfo.name} Calculators
                </a>`;
                
                // Add subcategories if they exist
                if (catData.subcategories) {
                    for (const [subKey, subData] of Object.entries(catData.subcategories)) {
                        const subName = subData.name.replace('ðŸ”¸ ', '');
                        const subIcon = subData.icon || 'fas fa-circle';
                        html += `<a href="#calculators" class="dropdown-item" data-category="${catKey}" data-subcategory="${subKey}" 
                            onclick="handleNavCategoryClick('${catKey}', '${subKey}'); return false;" 
                            style="padding-left: 40px; font-size: 0.9rem;">
                            <i class="${subIcon}"></i> ðŸ”¸ ${subName}
                        </a>`;
                    }
                }
            }
            
            dropdown.innerHTML = html;
        }
        
        function handleNavCategoryClick(category, subcategory = null) {
            // Close dropdown
            const dropdown = document.getElementById('navCategoryDropdown');
            if (dropdown) {
                dropdown.classList.remove('open');
            }
            
            // Scroll to calculators section
            document.getElementById('calculators')?.scrollIntoView({ behavior: 'smooth' });
            
            // Filter by category
            currentCategory = category;
            
            // Update active tab
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.category === category);
            });
            
            // Render filtered tools
            renderTools();
        }
        
        // Toggle dropdown on button click
        const navCategoriesBtn = document.getElementById('navCategoriesBtn');
        const navCategoryDropdown = document.getElementById('navCategoryDropdown');
        
        if (navCategoriesBtn && navCategoryDropdown) {
            navCategoriesBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                const isOpen = navCategoryDropdown.classList.toggle('open');
                navCategoriesBtn.setAttribute('aria-expanded', isOpen);
            });
            
            // Close dropdown when clicking outside
            document.addEventListener('click', (e) => {
                if (!navCategoriesBtn.contains(e.target) && !navCategoryDropdown.contains(e.target)) {
                    navCategoryDropdown.classList.remove('open');
                    navCategoriesBtn.setAttribute('aria-expanded', 'false');
                }
            });
            
            // Populate dropdown with all categories and subcategories
            populateNavCategoriesDropdown();
        }

        // Add keyframe animations for install button
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInUp {
                from {
                    opacity: 0;
                    transform: translateY(100px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            @keyframes slideInDown {
                from {
                    opacity: 0;
                    transform: translate(-50%, -50px);
                }
                to {
                    opacity: 1;
                    transform: translate(-50%, 0);
                }
            }
            
            @keyframes fadeOut {
                from {
                    opacity: 1;
                }
                to {
                    opacity: 0;
                }
            }
            
            @keyframes pulse {
                0%, 100% {
                    box-shadow: 0 8px 24px rgba(0, 212, 255, 0.4);
                }
                50% {
                    box-shadow: 0 8px 32px rgba(0, 212, 255, 0.6);
                }
            }
            
            @media (max-width: 768px) {
                #pwa-install-btn {
                    bottom: 90px !important;
                    right: 15px !important;
                    padding: 12px 20px !important;
                    font-size: 0.85rem !important;
                }
            }
        `;
        document.head.appendChild(style);
        
        // Performance monitoring
        if (window.performance && window.performance.now) {
            window.addEventListener('load', () => {
                const perfData = window.performance.timing;
                const pageLoadTime = perfData.loadEventEnd - perfData.navigationStart;
                console.log(`âš¡ Page loaded in: ${pageLoadTime}ms`);
            });
        }
        
        // Intersection Observer for lazy animations
        if ('IntersectionObserver' in window) {
            const animateOnScroll = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, { threshold: 0.1, rootMargin: '50px' });
            
            document.querySelectorAll('.tool-card, .popular-card').forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                animateOnScroll.observe(el);
            });
        }
    </script>
</body>
</html>